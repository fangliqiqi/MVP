import{P as e}from"./ProTable.1672389691407.js";import{P as t}from"./index.16723896914072.js";import{B as a}from"./index.16723896914077.js";import{H as i,J as o,K as n}from"./header.1672389691407.js";import{e as d}from"./excel.1672389691407.js";import r from"./attachDetail.1672389691407.js";import s from"./addDegree.1672389691407.js";import{h as l,i as c,j as m,k as p,l as u}from"./attach.1672389691407.js";import{_ as h,M as f,N as g,E as y,f as b,h as _,a as I}from"./index.1672389691407.js";import{d as k,f as x,$ as D,a2 as S,j as C,c as v,W as j,P as L,u as N,a3 as W,o as w,a as O,U as T,V as R,ay as z,az as B}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./file.1672389691407.js";import"./staff.1672389691407.js";import"./attachUpload.1672389691407.js";const P=e=>(z("data-v-2ec24dc8"),e=e(),B(),e),U={"class":"system-dict-container"},Y={"class":"el-dropdown-link"},M=T(" 模板下载 "),$=P((()=>O("a",{href:"/template/员工学历模板.xls",download:""}," 批量导入模板",-1))),A=P((()=>O("a",{href:"/template/批量更新员工学历模板.xls",download:""}," 批量更新模板",-1))),q=k({name:"学历信息"});var E=h(Object.assign(q,{setup(h){const k=x(null),z=x(null),B=x(null),P=x(null),q=x(null),E=e=>{H.selectOptions=e,e.length>0?H.btn[4].disabled=!1:H.btn[4].disabled=!0},H=D({searchConfig:{labelWidth:110,option:{extBtn:"extBtns"}},columns:[{dataIndex:"empName",title:"员工姓名",minWidth:180},{dataIndex:"empIdcard",title:"身份证号",minWidth:200},{dataIndex:"school",title:"学校",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"collageSystem",title:"院系名称",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"major",title:"专业",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"educationName",title:"学历",hideInSearch:!0,minWidth:160,formatter:e=>f(H.dictConfig.educationList,e.educationName)||"--"},{dataIndex:"type",title:"学历类型",hideInSearch:!0,minWidth:160,formatter:e=>f(H.dictConfig.educationTypeList,e.type)||"--"},{dataIndex:"highIdentification",title:"最高学历",hideInSearch:!0,minWidth:160,scopedSlots:{customRender:"highIdentification"}},{dataIndex:"educationSystem\t",title:"学制类型",hideInSearch:!0,minWidth:160,formatter:e=>f(H.dictConfig.educationSystemList,e.educationSystem)||"--"},{dataIndex:"entryDate",title:"入学时间",hideInSearch:!0,minWidth:160,formatter:e=>e.entryDate?e.entryDate.substring(0,10):"--"},{dataIndex:"gradutionDate",title:"毕业时间",hideInSearch:!0,minWidth:160,formatter:e=>e.gradutionDate?e.gradutionDate.substring(0,10):"--"},{dataIndex:"createName",title:"创建人",minWidth:160},{dataIndex:"createTime",title:"创建时间",minWidth:180,searchIndex:"createTimes",valueType:"dateTimeRange"},{dataIndex:"option",title:"操作",key:"option",minWidth:200,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"新增",onClick:()=>{B.value.openDialog("",H.dictConfig)},permission:["archives_tempeducation_add"],icon:"icon-ic_edit_add"},{label:"批量导入",permission:["archives_education_importListAdd"],onClick:()=>{P.value&&P.value.openDialog()},type:"normal",icon:"icon-ic_edit_upload"},{label:"批量导出",permission:["archives_tempeducation_export"],onClick:()=>{if(H.selectOptions.length>0){const e=[];H.selectOptions.map((t=>{e.push(t.id)})),H.params={ids:e.join(",")}}else H.params=k.value.getParams(),delete H.params.size,delete H.params.current;H.btn.find((e=>"批量导出"==e.label)).loading=!0,c(H.params).then((e=>{200==e.code?(d(n,e.data.map((e=>({id:e.id,empName:e.empName,empIdcard:e.empIdcard,school:e.school||"",collageSystem:e.collageSystem||"",major:e.major||"",educationName:f(H.dictConfig.educationList,e.educationName)||"",type:f(H.dictConfig.educationTypeList,e.type)||"",highIdentification:1==e.highIdentification?"否":"是",educationSystem:f(H.dictConfig.educationSystemList,e.educationSystem)||"",entryDate:e.entryDate?e.entryDate.substring(0,10):"",gradutionDate:e.gradutionDate?e.gradutionDate.substring(0,10):"",certificationName:e.certificationName||"",remark:e.remark||""}))),`学历信息批量导出${_().format("YYYYMMDD")}`),y.success("导出成功")):y.error(e.msg)}))["catch"]((e=>{y.error("导出失败")}))["finally"]((()=>{H.btn.find((e=>"批量导出"==e.label)).loading=!1}))},type:"normal",icon:"icon-ic_edit_export"},{label:"批量更新",permission:["archives_education_importListUpdate"],onClick:()=>{q.value&&q.value.openDialog()},type:"normal",icon:"icon-ic_edit_refresh"},{label:"批量删除",permission:["archives_education_del_batch"],onClick:()=>{H.selectOptions.length>0&&I.confirm(`是否确定删除${H.selectOptions.length}条学历信息？`,"提示",{type:"warning"}).then((()=>{const e=[];H.selectOptions.map((t=>{e.push(t.id)})),m(e).then((e=>{200==e.code&&e.data?(y.success("删除成功"),k.value.refresh()):y.error(e.msg||"删除失败")}))}))},type:"normal",icon:"icon-ic_edit_delete",disabled:!0}],cellBtns:[{text:"详情",prop:"detail",permission:["archives_tempeducation_get"]},{text:"编辑",prop:"edit",permission:["archives_tempeducation_edit"]},{text:"删除",prop:"delete",permission:["archives_tempeducation_del"]}],detailConf:[{label:"员工姓名",key:"empName"},{label:"身份证号",key:"empIdcard"},{label:"学校",key:"school",tooltip:!0},{label:"院系名称",key:"collageSystem",tooltip:!0},{label:"专业",key:"major",tooltip:!0},{label:"学历",key:"educationName"},{label:"学历类型",key:"type"},{label:"最高学历",key:"highIdentification"},{label:"入学时间",key:"entryDate"},{label:"毕业时间",key:"gradutionDate"},{label:"学制类型",key:"educationSystem"},{label:"证书名称",key:"certificationName",tooltip:!0},{label:"创建人",key:"createName"},{label:"创建时间",key:"createTime"},{label:"备注",key:"remark",tooltip:"true",size:24},{label:"附件内容",key:"",file:"true",size:24}],dictConfig:{educationList:[],educationTypeList:[],educationSystemList:[]},selectOptions:[],params:{}}),{columns:J,cellBtns:K,btn:V,searchConfig:F}=S(H),G=async e=>{try{const t=await l(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records.map(((t,a)=>({...t,index:(e.current-1)*e.size+a+1})))}}catch(t){}return{current:1,total:0,data:[]}},Q=()=>{k.value.refresh()},X=async(e,t)=>{"delete"===e?I.confirm("是否确定删除？","提示",{type:"warning"}).then((async()=>{const e=await p(t.id);e&&200==e.code?(y.success("删除成功"),Q()):y.error(e.msg||"删除失败")}))["catch"]((()=>{})):"edit"===e?B.value.openDialog(t,H.dictConfig):"detail"===e&&u(t.id).then((e=>{if(200==e.code){const t=e.data;t.startDate=t.startDate?t.startDate.substring(0,10):"",t.endDate=t.endDate?t.endDate.substring(0,10):"",t.educationName=f(H.dictConfig.educationList,t.educationName)||"",t.type=f(H.dictConfig.educationTypeList,t.type)||"",t.highIdentification="1"==t.highIdentification?"否":"是",t.educationSystem=f(H.dictConfig.educationSystemList,t.educationSystem)||"",z.value.openDialog(t,H.detailConf,"学历信息详情",!0)}else y.error(e.msg||"获取学历信息详情失败")}))["catch"]((()=>{y.error("获取学历信息详情失败")}))};return C((()=>{g("education").then((e=>{e&&200==e.code&&e.data?H.dictConfig.educationList=e.data:y.error(e.msg||"获取学历字典失败")}))["catch"]((e=>{y.error(e.msg||"获取学历字典失败")})),g("education_type").then((e=>{e&&200==e.code&&e.data?H.dictConfig.educationTypeList=e.data:y.error(e.msg||"获取学历类型字典失败")}))["catch"]((e=>{y.error(e.msg||"获取学历类型字典失败")})),g("education_system").then((e=>{e&&200==e.code&&e.data?H.dictConfig.educationSystemList=e.data:y.error(e.msg||"获取学制类型字典失败")}))["catch"]((e=>{y.error(e.msg||"获取学制类型字典失败")}))})),(n,d)=>{const l=W("el-icon"),c=W("el-button"),m=W("el-dropdown-item"),p=W("el-dropdown-menu"),u=W("el-dropdown"),h=W("el-tag");return w(),v("div",U,[j(e,{ref_key:"proTableRef",ref:k,"row-key":"id",columns:N(J),request:G,btn:N(V),searchConfig:N(F),multi:!0,onSelectionChange:E},{extBtns:L((()=>[j(u,{"class":"arch-btn","popper-class":"module-download"},{dropdown:L((()=>[j(p,null,{"default":L((()=>[j(m,null,{"default":L((()=>[$])),_:1}),j(m,null,{"default":L((()=>[A])),_:1})])),_:1})])),"default":L((()=>[O("span",Y,[j(c,{size:"default"},{"default":L((()=>[M,j(l,{"class":"el-icon--right"},{"default":L((()=>[j(N(b))])),_:1})])),_:1})])])),_:1})])),highIdentification:L((e=>[j(h,{size:"small",type:1==e.highIdentification?"info":""},{"default":L((()=>[T(R(1==e.highIdentification?"否":"是"),1)])),_:2},1032,["type"])])),option:L((e=>[j(t,{array:N(K),model:e,onOnClick:X},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),j(r,{ref_key:"attachDetailRef",ref:z},null,512),j(s,{ref_key:"addDegreeRef",ref:B,onOk:Q},null,512),j(a,{ref_key:"batchImportDialogRef",ref:P,header:N(i),errName:"员工学历信息批量导入",download:!0,url:"/yifu-archives/method/tempeducation/importListAdd",onOk:Q},null,8,["header"]),j(a,{ref_key:"batchUpdateDialogRef",ref:q,header:N(o),title:"批量更新",errName:"员工学历信息批量更新",download:!0,url:"/yifu-archives/method/tempeducation/importListUpate",onOk:Q},null,8,["header"])])}}}),[["__scopeId","data-v-2ec24dc8"]]);export{E as default};