import{a as t,g as e,d as a}from"./addSql.1672389691407.js";import{P as n}from"./ProTable.1672389691407.js";import{P as o}from"./index.16723896914072.js";import{_ as r,a as i}from"./index.1672389691407.js";import{i as l,f as s,$ as d,a2 as c,c as u,W as m,P as p,a3 as f,o as x}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";const h={"class":"system-sql-container"};var b=r({name:"数据源",components:{ProTable:n,ProButtons:o,addSqlVue:t},setup(){var t;const n=null==(t=l())?void 0:t.appContext.config.globalProperties.$message,o=s(null),r=s(null),u=()=>{o.value&&o.value.refresh()},m=d({columns:[{dataIndex:"index",title:"序号",minWidth:80},{dataIndex:"name",title:"名称",minWidth:160},{dataIndex:"url",title:"jdbcUrl",minWidth:180,tooltip:!0},{dataIndex:"username",title:"用户名",minWidth:110},{dataIndex:"password",title:"密码",minWidth:180,tooltip:!0},{dataIndex:"createTime",title:"创建时间",minWidth:180},{dataIndex:"updateTime",title:"更新时间",minWidth:180},{dataIndex:"option",title:"操作",key:"option",width:200,scopedSlots:{customRender:"option"}}],btn:[{label:"新增",onClick:()=>{r.value&&r.value.openDialog()},icon:"icon-ic_edit_add"}],cellBtns:[{text:"编辑",prop:"edit"},{text:"删除",prop:"delete"}]});return{...c(m),request:async t=>{try{const a=await e(t);if(a&&200==a.code&&a.data)return{current:a.data.current,total:a.data.total,data:a.data.records.map(((e,a)=>({...e,index:(t.current-1)*t.size+a+1})))}}catch(a){}return{current:1,total:0,data:[]}},onCellClick:async(t,e)=>{"delete"===t?(t=>{i.confirm("是否确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const e=await a(t.id);e&&200===e.code?(n.success("数据源删除成功"),u()):n.error(e.msg||"数据源删除失败")}catch(e){n.error("数据源删除失败")}}))["catch"]((()=>{}))})(e):"edit"===t&&r.value&&r.value.openDialog(e)},addSqlDialog:r,proTableRef:o,refreshList:u}}},[["render",function(t,e,a,n,o,r){const i=f("pro-buttons"),l=f("pro-table"),s=f("add-sql-vue");return x(),u("div",h,[m(l,{ref:"proTableRef","row-key":"id",columns:t.columns,request:n.request,btn:t.btn,showHeader:!1},{option:p((e=>[m(i,{array:t.cellBtns,model:e,onOnClick:n.onCellClick},null,8,["array","model","onOnClick"])])),_:1},8,["columns","request","btn"]),m(s,{ref:"addSqlDialog",onOk:n.refreshList},null,8,["onOk"])])}],["__scopeId","data-v-15fbd64e"]]);export{b as default};