import{d as e,k as t,$ as a,j as n,c as s,W as i,P as r,aD as o,a3 as l,o as c,F as d,a5 as u,O as p,a as m,V as f,u as y,T as b,U as _,ay as h,az as I}from"./vue.1672389691407.js";import{Y as S,X as T}from"./header.1672389691407.js";import{P as g}from"./ProTable.1672389691407.js";import{_ as k,g as x,e as j,t as v}from"./index.1672389691407.js";import{k as W}from"./staff.1672389691407.js";import{m as C}from"./contract.1672389691407.js";import{S as D,a as w}from"./dicts.1672389691407.js";import{g as M,a as H}from"./log.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";const N={"class":"staff-project-container"},O=["innerHTML"],L={"class":"desc-content"},P={"class":"detail-tooltip-container"},q=["innerHTML"],E=["innerHTML"],Y={"class":"desc-content"},R={"class":"detail-tooltip-container"},$=["innerHTML"],U=(e=>(h("data-v-1443c907"),e=e(),I(),e))((()=>m("div",null,"暂无数据",-1))),V=["onClick"],z={"class":"diff-content",style:{"margin-left":"50px"}},F={style:{"font-weight":"bold"}},J=["innerHTML"],K={key:2,style:{"text-align":"center"}},X={key:3,style:{"text-align":"center"}},A=["innerHTML"],B={"class":"desc-content"},G=_(" yarn "),Q=e({name:"staffProject"});var Z=k(Object.assign(Q,{props:{info:Object},setup(e){const h=e,I=o(),k=t((()=>h.info&&"1"==h.info.projectStatus)),Q=a({span:6,DICTS:{collegeDict:{0:"是",1:"否"},fileStatusEnmu:{0:"草稿",1:"已审核"},salaryStatusOption:D,sexOption:w},activeInfo:"contract",dictKeys:["emp_natrue","EMP_SOURCE","work_type","contract_status","emp_married","emp_national","emp_political","emp_registype","education","commercial_satte","social_ecurity_state","fund_status","personnel_state","personnel_type","social_reduce_reason","project_emp_source","customer_business_parent","customer_business_type","customer_business_sub_type"],params:["empNo","empNatrue","unitName","deptName","deptNo","businessPrimaryType","contractType","workingHours","post","enjoinDate","tryPeriod","projectSource","projectStatus"],reduceParams:["leaveReason","leaveTime","leaveRemark"],searchConfig:{},config:[{name:"contract",label:"合同信息",columns:[{dataIndex:"contractParty",title:"合同甲方",minWidth:160,ellipsis:!0},{dataIndex:"contractNo",title:"合同编码",minWidth:100,ellipsis:!0},{dataIndex:"contractName",title:"合同类型",minWidth:100,ellipsis:!0},{dataIndex:"contractStart",title:"合同起始日期",minWidth:100,dateFormat:"YYYY-MM-DD"},{dataIndex:"合同截止日期",title:"合同截止日期",minWidth:120,dateFormat:"YYYY-MM-DD"},{dataIndex:"contractTerm",title:"合同年限",minWidth:120},{dataIndex:"inUse",title:"合同状态",minWidth:100},{dataIndex:"remark",title:"备注",minWidth:160,ellipsis:!0},{dataIndex:"option",title:"操作",key:"option",minWidth:80,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"contractOption"}}],request:async e=>{try{const t=await C(Object.assign({},e,{empIdcard:h.info&&h.info.empIdcard}));if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records}}catch(t){}return{current:1,total:0,data:[]}}},{name:"insurance",label:"商险信息",columns:[{dataIndex:"state",title:"商险状态",minWidth:80},{dataIndex:"company",title:"保险公司",minWidth:80},{dataIndex:"classify",title:"险种",minWidth:80},{dataIndex:"type",title:"购买类型",minWidth:80},{dataIndex:"standard",title:"购买标准",minWidth:80},{dataIndex:"premium",title:"实际保费",minWidth:80},{dataIndex:"disablity",title:"身故或残疾",minWidth:100},{dataIndex:"quota",title:"医疗额度",minWidth:80},{dataIndex:"invoice",title:"发票号",minWidth:80},{dataIndex:"policy",title:"保单号",minWidth:80},{dataIndex:"startTime",title:"保单开始日期",minWidth:80},{dataIndex:"endTime",title:"保单结束日期",minWidth:80},{dataIndex:"months",title:"购买月数",minWidth:80},{dataIndex:"effectiveTime",title:"保单生效时间",minWidth:80}],request:e=>(async(e,t)=>({current:1,total:0,data:[]}))()},{name:"social",label:"社保信息",params:["socialStatus",""]},{name:"fund",label:"公积金信息"},{name:"salary",label:"发薪信息",params:["salaryStatus","bankName","bankSubName","bankNo"]},{name:"logs",label:"操作日志",columns:[{dataIndex:"createName",title:"操作人",minWidth:80},{dataIndex:"updateTime",title:"操作时间",minWidth:140},{dataIndex:"differenceInfo",title:"操作内容",minWidth:160,tooltip:!0,formatter:e=>{if(e.differenceInfo)return e.differenceInfo.split(",").filter((e=>!S.includes(e))).map((e=>M(e,"subject"))).join(",")}}],request:async e=>{try{if(Q.logSource&&Q.logSource.length){const{current:t,size:a}=e,n=(t-1)*a,s=t*a;return Q.logSource.length>=n?{current:t,total:Q.logSource.length,data:Q.logSource.slice(n,s)}:{current:1,total:Q.logSource.length,data:Q.logSource.slice(0,a)}}const t=await W(Object.assign({},e,{projectId:h.info.id}));if(t&&200==t.code&&t.data){const a=t.data;return Q.logSource=a,{current:t.data.current,total:a.length,data:a.slice(0,e.size)}}}catch(t){}return{current:1,total:0,data:[]}}}],logSource:[]}),Z=e=>{const t=e.differenceInfo,a=JSON.parse(e.newInfo),n=JSON.parse(e.oldInfo);return t.split(",").filter((e=>!S.includes(e))).map((e=>{let t="<div class='diff-item'>";const s=M(e,"subject");let i="",r="";return i=H(e,n,Q.DICTS),""!=i&&null!=i&&null!=i||(i="[空值]"),r=H(e,a,Q.DICTS),""!=r&&null!=r&&null!=r||(r="[空值]"),t+=`<span>修改了</span><span style="font-weight:bold;">${s}</span>：<span style="color:var(\t--hro-color-text-disabeld);" class='old-value'>${i}</span>  ->  <span class='new-val'>${r}</span>`,t+="</div>",t})).join("")};n((()=>{ee()}));const ee=async()=>{try{const e=await x(Q.dictKeys);if(e){const t=Object.assign({},Q.DICTS,e);Q.DICTS=t,te(t)}}catch(e){}},te=e=>{Q.config.forEach((t=>{"contract"===t.name&&(t.columns=t.columns.map((t=>("inUse"===t.dataIndex&&(t.valueEnum=e.contract_status),t))))}))},ae=e=>{let t=null;switch(e){case"leaveTime":t="减项时间";break;case"leaveRemark":t="减项备注";break;case"leaveReason":t="减项原因";break;default:t=T[e]}return t},ne=e=>{let t=h.info[e];switch(e){case"empNatrue":t=v("emp_natrue",t,Q.DICTS);break;case"contractType":t=v("personnel_type",t,Q.DICTS);break;case"workingHours":t=v("work_type",t,Q.DICTS);break;case"projectSource":t=v("project_emp_source",t,Q.DICTS);break;case"businessPrimaryType":t=se(v("customer_business_parent",h.info.businessPrimaryType,Q.DICTS),v("customer_business_type",h.info.businessSecondType,Q.DICTS),v("customer_business_sub_type",h.info.businessThirdType,Q.DICTS));break;case"projectStatus":t=1==h.info.projectStatus?"已减项":0==h.info.projectStatus&&0==h.info.status?"草稿":0==h.info.projectStatus&&1==h.info.status?"已审核":j;break;case"salaryStatus":t=v("salaryStatusOption",t,Q.DICTS);break;case"leaveReason":t=v("social_reduce_reason",t,Q.DICTS);break;default:if(null==t||""==t)return j}return t},se=(...e)=>{const t=[];return e.forEach((e=>{e&&t.push(e)})),t.join("/")};return(e,t)=>{const a=l("el-tooltip"),n=l("el-col"),o=l("el-row"),h=l("el-tab-pane"),S=l("el-tabs");return c(),s("div",N,[i(o,null,{"default":r((()=>[(c(!0),s(d,null,u(Q.params,(e=>(c(),p(n,{key:`basicInfo_${e}`,"class":"basic-info-item",span:6},{"default":r((()=>[m("span",{"class":"desc-title",innerHTML:ae(e)},null,8,O),m("div",L,[i(a,{placement:"top-start",effect:"dark","popper-class":"detail-tooltip-popper"},{content:r((()=>[m("div",P,[m("span",{innerHTML:ne(e)},null,8,q)])])),"default":r((()=>[m("span",null,f(ne(e)),1)])),_:2},1024)])])),_:2},1032,["span"])))),128)),y(k)?(c(!0),s(d,{key:0},u(Q.reduceParams,(e=>(c(),p(n,{key:`basicInfo_${e}`,"class":"basic-info-item",span:6},{"default":r((()=>[m("span",{"class":"desc-title",innerHTML:ae(e)},null,8,E),m("div",Y,[i(a,{placement:"top-start",effect:"dark","popper-class":"detail-tooltip-popper"},{content:r((()=>[m("div",R,[m("span",{innerHTML:ne(e)},null,8,$)])])),"default":r((()=>[m("span",null,f(ne(e)),1)])),_:2},1024)])])),_:2},1032,["span"])))),128)):b("",!0)])),_:1}),i(S,{modelValue:Q.activeInfo,"onUpdate:modelValue":t[0]||(t[0]=e=>Q.activeInfo=e),type:"card","class":"attach-tabs",style:{"margin-top":"16px"}},{"default":r((()=>[(c(!0),s(d,null,u(Q.config,(e=>(c(),p(h,{key:`attach_tab_${e.name}`,label:e.label,name:e.name},{"default":r((()=>["contract"===e.name||"insurance"===e.name?(c(),p(g,{key:0,"row-key":"id",columns:e.columns,request:e.request,showHeader:!1,customEmpty:!0,searchConfig:Q.searchConfig},{empty:r((()=>[U])),contractOption:r((e=>[m("span",{style:{color:"var(--el-color-primary)",cursor:"pointer"},onClick:t=>(e=>{I.push({name:"contract-detail",query:{id:e.id,name:"search"}})})(e)},"详情",8,V)])),_:2},1032,["columns","request","searchConfig"])):"logs"===e.name?(c(),p(g,{key:1,ref_for:!0,ref:"proTableRef","row-key":"id",columns:e.columns,request:e.request,showHeader:!1,customEmpty:"",tableExpand:""},{expand:r((e=>[m("div",z,[m("div",null,[_(f(e.updateTime)+"由",1),m("span",F,f(e.createName),1)]),m("div",{innerHTML:Z(e)},null,8,J)])])),_:2},1032,["columns","request"])):"social"===e.name?(c(),s("div",K,"暂时还没设计，都空着~")):"fund"===e.name?(c(),s("div",X,"暂时还没设计，都空着~")):"salary"===e.name?(c(),p(o,{key:4},{"default":r((()=>[(c(!0),s(d,null,u(e.params,(e=>(c(),p(n,{key:`basicInfo_${e}`,"class":"basic-info-item",span:6},{"default":r((()=>[m("span",{"class":"desc-title",innerHTML:ae(e)},null,8,A),m("div",B,[i(a,{placement:"top-start",effect:"dark",content:ne(e)},{"default":r((()=>[m("span",null,f(ne(e)),1)])),_:2},1032,["content"])]),G])),_:2},1032,["span"])))),128))])),_:2},1024)):b("",!0)])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-1443c907"]]);export{Z as default};