import{_ as e,g as a,E as t,h as i}from"./index.1672389691407.js";import{P as n}from"./ProTable.1672389691407.js";import{P as l}from"./index.16723896914072.js";import{t as o}from"./index.16723896914075.js";import{j as d}from"./paysearch.1672389691407.js";import{e as r}from"./excel.1672389691407.js";import{ai as s}from"./header.1672389691407.js";import{d as c,f as u,$ as h,a2 as m,k as p,j as y,c as g,W as f,P as I,a3 as x,o as S,a as w,u as v,U as P}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./file.1672389691407.js";const b={"class":"pay-search-list"},j={"class":"dialog-footer"},T=P("取 消"),D=P("导 出"),k=c({name:"paySearch"});var N=e(Object.assign(k,{setup(e,{expose:c}){const P=u(null),k=u(null),N=()=>{L.salaryAccountList=[],L.accountTitle=[]},L=h({isShowDialog:!1,id:null,title:"工资条查询",searchConfig:{labelWidth:"80px",onSearch:(e,a)=>{const i=Object.assign({},a);if(delete i.current,delete i.size,delete i.mId,0===Object.keys(i).length)return t.warning("请至少填写一个查询条件"),!1;d(i).then((e=>{e&&200==e.code&&e.data?(L.salaryAccountList=e.data.salaryAccountList,L.accountTitle=e.data.accountTitle):t.warning(e.msg)}))["catch"]((e=>{t.error("查询失败")}))}},columns:[{title:"员工姓名",dataIndex:"empName",width:120},{title:"发放状态",dataIndex:"distributionFlag",width:120,hideInSearch:!0},{title:"工资发放方式",width:120,dataIndex:"salaryStyle",hideInSearch:!0,valueEnum:{0:"现金",1:"转账"}},{title:"身份证号",dataIndex:"empIdcard",width:180},{title:"银行卡号",dataIndex:"bankNo",width:180,hideInSearch:!0},{title:"开户行",dataIndex:"bankName",width:200,hideInSearch:!0},{title:"工资发放时间",dataIndex:"salaryGiveTime",width:120,hideInSearch:!0,valueEnum:{0:"立即发",1:"暂停发"}},{title:"社保扣缴月份",dataIndex:"deduSocialMonth",width:120,hideInSearch:!0},{title:"公积金扣缴月份",dataIndex:"deduProvidentMonth",width:120,hideInSearch:!0},{title:"社保优先级",dataIndex:"socialPriority",width:120,hideInSearch:!0,valueEnum:{0:"生成",1:"缴纳"}},{title:"公积金优先级",dataIndex:"fundPriority",width:120,hideInSearch:!0,valueEnum:{0:"生成",1:"缴纳"}},{title:"年终奖扣税方案",dataIndex:"annualBonusType",width:120,hideInSearch:!0,valueEnum:{0:"合并",1:"单独"}},{title:"是否扣除社保",dataIndex:"isDeductSocial",width:120,hideInSearch:!0,valueEnum:{0:"否",1:"是"}},{title:"是否扣除公积金",dataIndex:"isDeductFund",width:120,hideInSearch:!0,valueEnum:{0:"否",1:"是"}},{title:"工资月份",dataIndex:"salaryMonth",width:120,hideInSearch:!0},{title:"结算月份",dataIndex:"settlementMonth",width:120,valueType:"date",selectType:"month",format:"YYYYMM",valueFormat:"YYYYMM"},{title:"项目名称",dataIndex:"deptName",width:200},{title:"项目编码",dataIndex:"deptNo",width:120,hideInTable:!0},{dataIndex:"option",title:"操作",key:"option",minWidth:120,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],cellBtns:[{text:"详情",prop:"detail",permission:[]}],pagination:{currentPage:1},salaryAccountList:[],accountTitle:[],dictKeys:["distribution_flag"],dictValues:[],header:[]}),{columns:M,searchConfig:Y,cellBtns:_}=m(L),A=p((()=>{const e=L.salaryAccountList;if(e.length>0){const a=10*(L.pagination.currentPage-1),t=10*L.pagination.currentPage;return{records:e.slice(a,t)}}})),C=p((()=>L.salaryAccountList?L.salaryAccountList.length:0)),E=e=>{L.pagination.currentPage=e};y((()=>{(async()=>{try{const e=await a(L.dictKeys);e&&(L.dictValues=e,L.columns.map((a=>{"distributionFlag"===a.dataIndex&&(a.valueEnum=e.distribution_flag)})))}catch(e){}})()}));const F=async(e,a)=>{if("detail"===e){const e={},t=[];a.saiList.map(((a,i)=>{e[a.cnName]=a.textValue||a.salaryMoney,t.push({label:a.cnName,key:a.cnName})})),k.value&&k.value.openDialog(e,t,"详情")}},O=()=>{L.isShowDialog=!1,L.salaryAccountList=[],L.accountTitle=[],P.value&&P.value.doReset()},V=()=>{O()},B=u(!1),R={0:"否",1:"是"},z=()=>{if(L.salaryAccountList.length>0){L.header=JSON.parse(JSON.stringify(s));for(let a in L.accountTitle)L.header.push({header:a,key:L.accountTitle[a],width:15});B.value=!0;const e=JSON.parse(JSON.stringify(L.salaryAccountList));e.map((e=>{e.salaryStyle=0==e.salaryStyle?"现金":"转账",e.salaryGiveTime=0==e.salaryGiveTime?"立即发":"暂停发",e.socialPriority=0==e.socialPriority?"生成":"缴纳",e.fundPriority=0==e.fundPriority?"生成":"缴纳",e.annualBonusType=0==e.annualBonusType?"合并":"单独",e.isDeductSocial=R[e.isDeductSocial],e.isDeductFund=R[e.isDeductFund],e.fundPriority=0==e.fundPriority?"生成":"缴纳",e.distributionFlag=L.dictValues.distribution_flag[e.distributionFlag];for(let a in L.accountTitle)e[L.accountTitle[a]]="";e.saiList.map(((a,t)=>{e[a.javaFiedName]=a.textValue||a.salaryMoney}))})),r(L.header,e,`工资条查询导出${i().format("YYYYMMDD")}`),t.success("导出成功"),L.header=[],B.value=!1}else t.warning("请先查询数据")};return c({openDialog:async e=>{L.isShowDialog=!0}}),(e,a)=>{const t=x("el-pagination"),i=x("el-button"),d=x("el-dialog");return S(),g("div",b,[f(d,{title:L.title,modelValue:L.isShowDialog,"onUpdate:modelValue":a[1]||(a[1]=e=>L.isShowDialog=e),"close-on-click-modal":!1,width:"1200px",onClose:O},{footer:I((()=>[w("span",j,[f(i,{onClick:V,size:"default"},{"default":I((()=>[T])),_:1}),f(i,{type:"primary",loading:B.value,onClick:z,size:"default"},{"default":I((()=>[D])),_:1},8,["loading"])])])),"default":I((()=>[f(n,{ref_key:"payProtableRef",ref:P,"row-key":"id",columns:v(M),dataSource:v(A),searchConfig:v(Y),onOnReset:N},{option:I((e=>[f(l,{array:v(_),model:e,onOnClick:F},null,8,["array","model"])])),_:1},8,["columns","dataSource","searchConfig"]),f(t,{currentPage:L.pagination.currentPage,"onUpdate:currentPage":a[0]||(a[0]=e=>L.pagination.currentPage=e),"page-size":10,background:"",layout:"total, prev, pager, next, jumper",total:v(C),onCurrentChange:E,"hide-on-single-page":""},null,8,["currentPage","total"])])),_:1},8,["title","modelValue"]),f(o,{ref_key:"tableDetailRef",ref:k,labelWidth:"130px"},null,512)])}}}),[["__scopeId","data-v-7602c210"]]);export{N as default};