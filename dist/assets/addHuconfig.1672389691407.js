import{_ as e}from"./index.167238969140713.js";import{g as a,E as l}from"./index.1672389691407.js";import{i as r,j as t}from"./socialfundSet.1672389691407.js";import{P as o}from"./index.16723896914073.js";import{a as d}from"./contractPermission.16723896914072.js";import{d as n,f as s,$ as i,j as u,c as m,W as c,P as p,a3 as g,o as f,a as h,F as y,a5 as U,O as F,U as _}from"./vue.1672389691407.js";import"./city.1672389691407.js";const k={"class":"system-add-dic-container"},w={"class":"dialog-footer"},v=_("取 消"),b=_("确 定"),V=n({name:"addHuconfig"}),N=Object.assign(V,{emits:["ok"],setup(n,{expose:_,emit:V}){const N=s(null),x=s(null),O=i({isShowDialog:!1,loading:!1,id:null,title:"户新增",ruleForm:{type:"",name:"",province:"",city:"",town:"",organId:"",rmark:"",auditUser:"",handleUser:"",auditUserName:"",handleUserName:""},handleUserOptions:[],auditUserOptions:[],address:null,dictKeys:["nature_account","dept_config_type"],dictOptions:{nature_account:null,dept_config_type:null}}),j={type:[{required:!0,message:"请选择账户性质",trigger:"change"}],name:[{required:!0,message:"请输入户名",trigger:"blur"}],province:[{required:!0,message:"请选择缴纳地",trigger:"change"}],organId:[{required:!0,message:"请选择所属机构",trigger:"change"}],auditUser:[{required:!0,message:"请选择审核人",trigger:"change"}],handleUser:[{required:!0,message:"请选择办理人",trigger:"change"}]},D=(e,a)=>{O.ruleForm.province=e.pro,O.ruleForm.city=e.city,O.ruleForm.town=e.town,O.address=e.town||e.city||e.pro},S=e=>{O.ruleForm.province=null,O.ruleForm.city=null,O.ruleForm.town=null,O.address=null},q=async e=>{try{const a=await d(e);if(a&&200==a.code&&a.data)return{current:a.data.current,total:a.data.total,data:a.data.records};l.error(a.msg)}catch(a){}return{current:1,total:0,data:[]}},C=()=>{N.value&&N.value.clearValidate(),O.ruleForm={type:"",name:"",province:"",city:"",town:"",organId:"",rmark:""},O.address=null,O.isShowDialog=!1,O.loading=!1},I=()=>{C()},R=async e=>{try{const a=await d(e);if(a&&200==a.code&&a.data)return{current:a.data.current,total:a.data.total,data:a.data.records};l.error(a.msg)}catch(a){}return{current:1,total:0,data:[]}},z=e=>{O.ruleForm.auditUser=e.userId,O.ruleForm.auditUserName=e.nickname,O.ruleForm.auditUserDeptName=e.deptName},P=e=>{O.ruleForm.handleUser=e.userId,O.ruleForm.handleUserName=e.nickname,O.ruleForm.handleUserDeptName=e.deptName},K=()=>{N.value.validate((e=>{if(e){if(0==O.ruleForm.type&&!O.ruleForm.city)return void l.error("社保户请选择省以下缴纳地！");O.loading=!0,null!==O.id&&void 0!==O.id?r(O.ruleForm).then((e=>{e&&200==e.code?(l.success("编辑户配置成功"),V("ok"),C()):l.error(e.msg||"编辑户配置失败")}),(()=>{l.error("编辑户配置失败")}))["finally"]((()=>{O.loading=!1})):t(O.ruleForm).then((e=>{e&&200==e.code?(l.success("新增户配置成功"),V("ok"),C()):l.error(e.msg||"新增户配置失败")}),(e=>{const a=e&&e.msg||"新增户配置失败";l.error(a)}))["finally"]((()=>{O.loading=!1}))}}))};return u((()=>{(async()=>{try{const e=await a(O.dictKeys);e&&(O.dictOptions=e)}catch(e){}})()})),_({openDialog:async e=>{N.value&&N.value.clearValidate(),e&&e.id?(O.title="户编辑",O.id=e.id,O.ruleForm=e,O.address=e.town||e.city||e.province,O.address=O.address?Number(O.address):null,O.isShowDialog=!0,O.auditUserOptions=[{nickname:e.auditUserName}],O.handleUserOptions=[{nickname:e.handleUserName}]):(setTimeout((()=>{x.value.initParams()}),50),O.title="户新增",O.id=null,O.address=null,O.isShowDialog=!0)}}),(a,l)=>{const r=g("el-option"),t=g("el-select"),d=g("el-form-item"),n=g("el-col"),s=g("el-input"),i=g("el-row"),u=g("el-form"),_=g("el-button"),V=g("el-dialog");return f(),m("div",k,[c(V,{title:O.title,modelValue:O.isShowDialog,"onUpdate:modelValue":l[6]||(l[6]=e=>O.isShowDialog=e),"close-on-click-modal":!1,width:"816px",onClose:C},{footer:p((()=>[h("span",w,[c(_,{onClick:I,size:"default"},{"default":p((()=>[v])),_:1}),c(_,{type:"primary",onClick:K,loading:O.loading,size:"default"},{"default":p((()=>[b])),_:1},8,["loading"])])])),"default":p((()=>[c(u,{ref_key:"formRef",ref:N,model:O.ruleForm,rules:j,size:"default","label-width":"110px"},{"default":p((()=>[c(i,null,{"default":p((()=>[c(n,{span:12},{"default":p((()=>[c(d,{label:"账户性质",prop:"type"},{"default":p((()=>[c(t,{modelValue:O.ruleForm.type,"onUpdate:modelValue":l[0]||(l[0]=e=>O.ruleForm.type=e),style:{width:"100%"},disabled:!!O.id},{"default":p((()=>[(f(!0),m(y,null,U(O.dictOptions.nature_account,((e,a)=>(f(),F(r,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),c(n,{span:12},{"default":p((()=>[c(d,{label:"户名",prop:"name"},{"default":p((()=>[c(s,{modelValue:O.ruleForm.name,"onUpdate:modelValue":l[1]||(l[1]=e=>O.ruleForm.name=e),placeholder:"请输入户名",disabled:!!O.id,maxlength:"50"},null,8,["modelValue","disabled"])])),_:1})])),_:1}),c(n,{span:12},{"default":p((()=>[c(d,{label:"缴纳地",prop:"province"},{"default":p((()=>[c(e,{ref_key:"pageAreaRef",ref:x,address:O.address,onCurrentChange:D,onClear:S,disabled:!!O.id,style:{width:"100%"}},null,8,["address","disabled"])])),_:1})])),_:1}),c(n,{span:12},{"default":p((()=>[c(d,{label:"所属机构",prop:"organId"},{"default":p((()=>[c(t,{modelValue:O.ruleForm.organId,"onUpdate:modelValue":l[2]||(l[2]=e=>O.ruleForm.organId=e),style:{width:"100%"},placeholder:"请选择所属机构"},{"default":p((()=>[(f(!0),m(y,null,U(O.dictOptions.dept_config_type,((e,a)=>(f(),F(r,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),c(n,{span:12},{"default":p((()=>[c(d,{label:"审核人",prop:"auditUser"},{"default":p((()=>[c(o,{ref:"pageSelectRef",modelValue:O.ruleForm.auditUserName,"onUpdate:modelValue":l[3]||(l[3]=e=>O.ruleForm.auditUserName=e),request:R,"value-key":"nickname",title:"nickname",search:"nickname",placeholder:"请选择审核人",onChange:z,options:O.auditUserOptions},null,8,["modelValue","options"])])),_:1})])),_:1}),c(n,{span:12},{"default":p((()=>[c(d,{label:"办理人",prop:"handleUser"},{"default":p((()=>[c(o,{ref:"pageSelectRef",modelValue:O.ruleForm.handleUserName,"onUpdate:modelValue":l[4]||(l[4]=e=>O.ruleForm.handleUserName=e),request:q,"value-key":"nickname",title:"nickname",search:"nickname",placeholder:"请选择办理人",options:O.handleUserOptions,onChange:P},null,8,["modelValue","options"])])),_:1})])),_:1}),c(n,{md:24,lg:24,xl:24},{"default":p((()=>[c(d,{label:"备注",prop:"rmark"},{"default":p((()=>[c(s,{type:"textarea",modelValue:O.ruleForm.rmark,"onUpdate:modelValue":l[5]||(l[5]=e=>O.ruleForm.rmark=e),autosize:{minRows:2,maxRows:4},placeholder:"请输入备注","show-word-limit":"",maxlength:"200",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}});export{N as default};