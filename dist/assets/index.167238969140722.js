import{_ as t,Q as e,R as i,a,T as o}from"./index.1672389691407.js";import{P as n}from"./ProTable.1672389691407.js";import{P as r}from"./index.16723896914072.js";import d from"./addDic.1672389691407.js";import s from"./addDictItemDialog.1672389691407.js";import{i as l,f as c,$ as m,a2 as p,c as u,W as h,P as f,a3 as y,o as x}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./addDicItem.1672389691407.js";const I={"class":"system-dict-container"};var g=t({name:"字典管理",components:{ProTable:n,ProButtons:r,AddDicDialog:d,addDictItemDialogVue:s},setup(){var t;const n=null==(t=l())?void 0:t.appContext.config.globalProperties.$message,r=c(null),d=c(null),s=c(null),u=()=>{r.value&&r.value.refresh()},h=c(!1),f=t=>"0"===t.systemFlag,y=m({columns:[{dataIndex:"index",title:"序号",hideInSearch:!0,minWidth:80},{dataIndex:"description",title:"字典名称",minWidth:160,tooltip:!0},{dataIndex:"type",title:"字典编码",minWidth:160,tooltip:!0},{dataIndex:"systemFlag",title:"字典类型",valueEnum:{0:"系统类",1:"业务类"},minWidth:110},{dataIndex:"remark",title:"备注信息",hideInSearch:!0,minWidth:180,tooltip:!0},{dataIndex:"createTime",title:"创建时间",hideInSearch:!0,minWidth:180},{dataIndex:"createName",title:"创建人",hideInSearch:!0,minWidth:180},{dataIndex:"parentItemType",title:"上级字典",hideInSearch:!0,minWidth:180,tooltip:!0},{dataIndex:"option",title:"操作",key:"option",width:200,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"新增",onClick:()=>{d.value&&d.value.openDialog()},permission:["sys_dict_add"],icon:"icon-ic_edit_add"},{label:"清除缓存",onClick:async()=>{try{h.value=!0;const t=await i();t&&200===t.code?(n.success("字典缓存清除成功"),u()):n.error(t.msg||"字典缓存清除失败"),h.value=!1}catch(t){h.value=!1,n.error("字典缓存清除失败")}},loading:h,icon:"icon-ic_edit_refresh"}],cellBtns:[{text:"编辑",prop:"edit",permission:["sys_dict_edit"],tooltip:"当前字典不可编辑",isGray:f},{text:"删除",prop:"delete",permission:["sys_dict_del"],tooltip:"当前字典不可删除",isGray:f},{text:"字典项",prop:"dict",permission:["sys_dict_edit"]}]});return{...p(y),request:async t=>{try{const i=await e(t);if(i&&200==i.code&&i.data)return{current:i.data.current,total:i.data.total,data:i.data.records.map(((e,i)=>({...e,index:(t.current-1)*t.size+i+1})))}}catch(i){}return{current:1,total:0,data:[]}},onCellClick:async(t,e)=>{"delete"===t?(t=>{a.confirm("是否确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const e=await o(t.id);e&&200===e.code?(n.success("字典删除成功"),u()):n.error(e.msg||"字典删除失败")}catch(e){n.error("字典删除失败")}}))["catch"]((()=>{}))})(e):"edit"===t?d.value&&d.value.openDialog(e):"dict"===t&&s.value&&s.value.openDialog(e)},addDicDialog:d,proTableRef:r,refreshList:u,addDictItemRef:s}}},[["render",function(t,e,i,a,o,n){const r=y("pro-buttons"),d=y("pro-table"),s=y("add-dic-dialog"),l=y("add-dict-item-dialog-vue");return x(),u("div",I,[h(d,{ref:"proTableRef","row-key":"id",columns:t.columns,request:a.request,btn:t.btn},{option:f((e=>[h(r,{array:t.cellBtns,model:e,onOnClick:a.onCellClick},null,8,["array","model","onOnClick"])])),_:1},8,["columns","request","btn"]),h(s,{ref:"addDicDialog",onOk:a.refreshList},null,8,["onOk"]),h(l,{ref:"addDictItemRef"},null,512)])}]]);export{g as default};