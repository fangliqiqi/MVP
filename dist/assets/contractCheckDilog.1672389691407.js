import{g as e,E as a}from"./index.1672389691407.js";import{h as l}from"./contract.1672389691407.js";import t from"./showDeletes.1672389691407.js";import{d as r,f as o,$ as s,k as u,c as i,W as d,P as m,a3 as n,o as c,a as g,u as f,O as p,F as h,a5 as k,U as _,V as b,T as y}from"./vue.1672389691407.js";const F={"class":"system-add-dic-container"},S=_("通过"),V=_("不通过"),v={"class":"dialog-footer"},w=_("取 消"),R=_("确 定"),D=r({name:"contractCheckDilog"}),O=Object.assign(D,{emits:["ok"],setup(r,{expose:D,emit:O}){const C=o(null),x=o(null),j=s({isShowDialog:!1,loading:!1,title:"批量审核",ruleForm:{},refuseOptions:{},selectionChangeList:[],ids:[],dictKeys:["emp_natrue","situation_type","personnel_state","employee_contract_type","working_hours","contract_business_type","dispatch-audit-add-reason","check_type"]}),q=u((()=>"3"==j.ruleForm.auditStatus&&"其他"!=j.ruleForm.remark?(C.value.clearValidate(["auditRemark"]),{auditStatus:[{required:!0,message:"请选择审核意见",trigger:"blur"}],remark:[{required:!0,message:"请选择原因",trigger:"change"}]}):"其他"==j.ruleForm.remark?{auditStatus:[{required:!0,message:"请选择审核意见",trigger:"blur"}],auditRemark:[{required:!0,message:"请填写说明",trigger:"blur"}],remark:[{required:!0,message:"请选择原因",trigger:"change"}]}:{auditStatus:[{required:!0,message:"请选择审核意见",trigger:"blur"}]})),U=async()=>{try{const a=await e(j.dictKeys);a&&(j.refuseOptions=a["dispatch-audit-add-reason"])}catch(a){}},z=()=>{C.value&&C.value.clearValidate(),j.ruleForm={},j.isShowDialog=!1,j.loading=!1},L=()=>{z()},N=()=>{C.value&&C.value.clearValidate()},E=()=>{C.value&&C.value.validate((e=>{if(e){j.loading=!0;const e=j.ruleForm.auditRemark?":"+j.ruleForm.auditRemark:"",t={auditStatus:j.ruleForm.auditStatus,auditRemark:2==j.ruleForm.auditStatus?j.ruleForm.auditRemark:j.ruleForm.remark+e},r=[];j.selectionChangeList.forEach((e=>{r.push(e.id)}));const o=Object.assign({},t,{ids:r});l(o).then((e=>{200==e.code&&e.data&&e.data.length>0?(e.data=e.data.map((e=>(e.mainName=e.name,e.errorInfo=e.message,e.result="green"==e.color?1:2,e))),x.value.openDialog(e.data,"批量审核结果反馈")):200!=e.code||e.data?a.error("批量操作失败"):a.success("批量操作成功")}),(()=>{a.error("批量操作失败")}))["finally"]((()=>{O("ok"),z(),j.loading=!1}))}}))};return D({openDialog:async e=>{C.value&&C.value.clearValidate(),j.isShowDialog=!0,j.loading=!1,j.selectionChangeList=JSON.parse(JSON.stringify(e)),U()}}),(e,a)=>{const l=n("el-radio"),r=n("el-radio-group"),o=n("el-form-item"),s=n("el-col"),u=n("el-option"),D=n("el-select"),O=n("el-input"),U=n("el-row"),J=n("el-form"),K=n("el-button"),I=n("el-dialog");return c(),i("div",F,[d(I,{title:j.title,modelValue:j.isShowDialog,"onUpdate:modelValue":a[3]||(a[3]=e=>j.isShowDialog=e),"close-on-click-modal":!1,width:"576px",onClose:z},{footer:m((()=>[g("span",v,[d(K,{onClick:L,size:"default"},{"default":m((()=>[w])),_:1}),d(K,{type:"primary",onClick:E,loading:j.loading,size:"default"},{"default":m((()=>[R])),_:1},8,["loading"])])])),"default":m((()=>[d(J,{ref_key:"formRef",ref:C,model:j.ruleForm,rules:f(q),size:"default","label-width":"110px"},{"default":m((()=>[d(U,null,{"default":m((()=>[d(s,{"class":"mb20"},{"default":m((()=>[d(o,{label:"审核意见",prop:"auditStatus"},{"default":m((()=>[d(r,{modelValue:j.ruleForm.auditStatus,"onUpdate:modelValue":a[0]||(a[0]=e=>j.ruleForm.auditStatus=e),onChange:N},{"default":m((()=>[d(l,{label:"2"},{"default":m((()=>[S])),_:1}),d(l,{label:"3"},{"default":m((()=>[V])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),d(s,{"class":"mb20"},{"default":m((()=>["3"==j.ruleForm.auditStatus?(c(),p(o,{key:0,label:"原因",prop:"remark"},{"default":m((()=>[d(D,{modelValue:j.ruleForm.remark,"onUpdate:modelValue":a[1]||(a[1]=e=>j.ruleForm.remark=e),placeholder:"请选择",style:{width:"100%"},filterable:"",clearable:""},{"default":m((()=>[(c(!0),i(h,null,k(j.refuseOptions,((e,a)=>(c(),p(u,{label:e,key:a,value:e},{"default":m((()=>[_(b(e),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):y("",!0)])),_:1}),d(s,{"class":"mb20"},{"default":m((()=>[d(o,{label:"说明",prop:"auditRemark"},{"default":m((()=>[d(O,{type:"textarea",modelValue:j.ruleForm.auditRemark,"onUpdate:modelValue":a[2]||(a[2]=e=>j.ruleForm.auditRemark=e),placeholder:"请输入审核意见，不超过150字","show-word-limit":"",maxlength:"150"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"]),d(t,{ref_key:"showDeletesRef",ref:x,onOk:e.refresh},null,8,["onOk"])])}}});export{O as default};