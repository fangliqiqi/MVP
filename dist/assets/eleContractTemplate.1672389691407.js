import{P as e}from"./ProTable.1672389691407.js";import{e as t,j as a,k as r}from"./eleContract.16723896914072.js";import{P as n}from"./index.16723896914072.js";import o from"./editEleContractTemplate.1672389691407.js";import l from"./uploadTemplate.1672389691407.js";import{a as d,i}from"./city.1672389691407.js";import{E as s}from"./dicts.1672389691407.js";import{g as p,E as c}from"./index.1672389691407.js";import{d as m,f as u,j as f,$ as h,c as y,W as v,P as I,a3 as _,o as x,O as g}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";const j={"class":"contract-apply-container"},k=m({name:"电子合同模板"}),w=Object.assign(k,{setup(m){const k=u(null),w=u(null),T=u(null),b=u(null),S=()=>{D.params={}};f((()=>{C();const e=d();D.areaJson=e}));const C=async()=>{try{const e=await p(D.dictKeys);e&&(D.DICTS=e,D.columns=D.columns.map((t=>{const a={...t};if("type"===t.dataIndex)a.valueEnum=e.personnel_type;return a})),T.value&&T.value.refresh())}catch(e){}},W=async e=>{try{const a=Object.assign({},e,D.params);delete a.fileAddress;const r=await t(a);if(r&&200==r.code&&r.data)return{current:r.data.current,total:r.data.total,data:r.data.records}}catch(a){}return{current:1,total:0,data:[]}},E=()=>{T.value&&T.value.refresh()},R=async(e,t)=>{"edit"===e?k.value&&k.value.openDialog(t):"upload"===e?b.value&&b.value.openDialog(t):"preview"===e?a({id:t.id}).then((e=>{200===e.code?window.open(e.data):c.error(e.msg||"获取模板预览地址失败")}),(e=>{const t=e&&e.msg||"获取模板预览地址失败";c.error(t)})):"maintain"===e&&r({id:t.id}).then((e=>{200===e.code?window.open(e.data):c.error(e.msg||"获取模板维护地址失败")}),(e=>{const t=e&&e.msg||"获取模板维护地址失败";c.error(t)}))},O=(e,t)=>{const a=[e.id];t.parent&&0!=t.parent.level&&a.unshift(t.parent.data.id);let r=null,n=null;r=a[0]||null,a.length>1&&(n=a[1]||null),D.params.province=r,D.params.city=n},P=()=>{D.params.province=null,D.params.city=null},D=h({areaJson:null,areaProps:{label:"areaName"},dictKeys:["personnel_type"],params:{},btn:[{label:"新增",onClick:()=>{w.value&&w.value.openDialog()},permission:["demo_fddcontracttemplate_add"],icon:"icon-ic_edit_add"}],cellBtns:[{text:"编辑",prop:"edit",permission:["demo_fddcontracttemplate_edit"]},{text:"模板上传",prop:"upload",permission:["demo_fddcontracttemplate_preview"],tooltip:"当前状态不可操作",isGray:e=>!!e.fddTemplateId},{text:"模板预览",prop:"preview",permission:["demo_fddcontracttemplate_preview"],tooltip:"当前状态不可操作",isGray:e=>!(e.fddTemplateId&&1==e.modifyUploadStatus)},{text:"模板维护",prop:"maintain",permission:["demo_fddcontracttemplate_upkeep"],tooltip:"当前状态不可操作",isGray:e=>!e.fddTemplateId}],columns:[{dataIndex:"localName",title:"模板名称",minWidth:160,tooltip:!0},{dataIndex:"fileaddress",title:"地区",hideInSearch:!0,minWidth:180,ellipsis:!0,formatter:e=>i({province:e.province,city:e.city,town:e.town})},{dataIndex:"type",title:"合同类型",hideInSearch:!0,minWidth:160,ellipsis:!0},{dataIndex:"modifyUploadStatus",title:"合同定稿状态",minWidth:160,hideInSearch:!0,valueEnum:{1:"成功"}},{dataIndex:"overtimeWageFlag",title:"有无加班工资",minWidth:160,hideInSearch:!0,valueEnum:s},{dataIndex:"createName",title:"创建人",minWidth:160,hideInSearch:!0,ellipsis:!0},{dataIndex:"createTime",title:"创建时间",minWidth:160,hideInSearch:!0,ellipsis:!0},{dataIndex:"address",title:"地区",hideInTable:!0,valueType:"custom",minWidth:180,scopedSlots:{customRender:"address"}},{dataIndex:"option",title:"操作",key:"option",width:280,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}]});return(t,a)=>{const r=_("el-tree-select");return x(),y("div",j,[v(e,{ref_key:"proTableRef",ref:T,"row-key":"id",columns:D.columns,request:W,btn:D.btn,onOnReset:S,manualRequest:""},{option:I((e=>[v(n,{array:D.cellBtns,model:e,onOnClick:R},null,8,["array","model"])])),address:I((e=>[(x(),g(r,{modelValue:D.params.fileAddress,"onUpdate:modelValue":a[0]||(a[0]=e=>D.params.fileAddress=e),data:D.areaJson,key:"arch_search_props_"+e.dateIndex+"_",style:{width:"100%"},placeholder:"请选择",props:D.areaProps,onCurrentChange:O,onClear:P,"node-key":"id","check-strictly":"",clearable:""},null,8,["modelValue","data","props"]))])),_:1},8,["columns","btn"]),v(o,{type:"add",ref_key:"addEleContractTemplateRef",ref:w,onOk:E},null,512),v(o,{type:"edit",ref_key:"editEleContractTemplateRef",ref:k,onOk:E},null,512),v(l,{ref_key:"uploadTemplateRef",ref:b},null,512)])}}});export{w as default};