import{d as e,f as a,$ as s,j as t,c as r,W as o,P as n,ax as i,o as c}from"./vue.1672389691407.js";import{P as d}from"./ProTable.1672389691407.js";import{P as l}from"./index.16723896914072.js";import m from"./addFundPermission.1672389691407.js";import{g as u,h as p,E as h,a as f}from"./index.1672389691407.js";import{u as y}from"./header.1672389691407.js";import{g,a as x,d as b,b as j}from"./socialAndFundCheckPermission.1672389691407.js";import{e as C}from"./excel.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./contractPermission.16723896914072.js";import"./socialfundSet.1672389691407.js";const _={"class":"cardinal-config-container"},k=e({name:"公积金办理权限"}),w=Object.assign(k,{setup(e){const k=a(null),w=a(null);i();const v=()=>{k.value&&k.value.refresh()},P=a(!1),N=s({searchConfig:{labelWidth:120},columns:[{dataIndex:"userName",title:"办理人",minWidth:160},{dataIndex:"userDeptName",title:"办理人所在部门",minWidth:180},{dataIndex:"fundHousehold",title:"公积金户",minWidth:220},{dataIndex:"status",title:"授权状态",minWidth:160},{dataIndex:"option",title:"操作",key:"option",width:200,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],params:{},btn:[{label:"新增",onClick:()=>{w.value&&w.value.openDialog()},loading:P,permission:["social_tsocialfundhouseres_add"],icon:"icon-ic_edit_add"},{label:"批量导出",onClick:()=>{if(P.value=!0,N.selectionChangeList.length>0){const e=[];N.selectionChangeList.map((a=>{e.push(a.id)})),N.params.idList=e}else N.params=k.value.getParams(),N.params.flag=1,N.params.authType=1,N.params.houseNameType=1,delete N.params.size,delete N.params.current;x(N.params).then((e=>{200==e.code?(C(y,e.data.map((e=>({userName:e.userName,userDeptName:e.userDeptName,fundHousehold:e.fundHousehold,status:"1"==e.status?"禁用":"启用"}))),`公积金办理权限批量导出${p().format("YYYYMMDD-HHmmss")}`),h.success("导出成功")):h.error(e.msg)}))["catch"]((e=>{h.error(e||"导出失败")}))["finally"]((()=>{P.value=!1}))},loading:P,permission:[],type:"normal",icon:"icon-ic_edit_export"}],cellBtns:[{text:"删除",prop:"delete",permission:["social_tsocialfundhouseres_del"]},{text:"启用",prop:"enable",permission:[],isGray:e=>"0"==e.status},{text:"禁用",prop:"stop",permission:[],isGray:e=>"1"==e.status}],selectionChangeList:[],dictKeys:["permission_status"]}),I=e=>{N.selectionChangeList=e},D=async(e,a)=>{switch(e){case"delete":f.confirm("是否确定删除？","提示",{type:"warning"}).then((async()=>{try{const e=await j(a.id);e&&200===e.code?(h.success("删除成功"),v()):h.error(e.msg||"删除失败")}catch(e){h.error(e.sag||"删除失败")}}))["catch"]((()=>{}));break;case"enable":f.confirm("是否确定启用？","提示",{type:"warning"}).then((async()=>{try{const e=await b({id:a.id,status:0});e&&200===e.code?(h.success("启用成功"),v()):h.error(e.msg||"启用失败")}catch(e){h.error(e.sag||"启用失败")}}))["catch"]((()=>{}));break;case"stop":f.confirm("是否确定禁用？","提示",{type:"warning"}).then((async()=>{try{const e=await b({id:a.id,status:1});e&&200===e.code?(h.success("禁用成功"),v()):h.error(e.msg||"禁用失败")}catch(e){h.error(e.sag||"禁用失败")}}))["catch"]((()=>{}))}},T=async e=>{try{const a={...e,houseNameType:"1",authType:"1"},s=await g(a);if(s&&200==s.code&&s.data)return{current:s.data.current,total:s.data.total,data:s.data.records}}catch(a){}return{current:1,total:0,data:[]}};return t((()=>{(async()=>{try{const e=await u(N.dictKeys);e&&N.columns.map((a=>("status"===a.dataIndex&&(a.valueEnum=e.permission_status),a)))}catch(e){}})()})),(e,a)=>(c(),r("div",_,[o(d,{ref_key:"proTableRef",ref:k,"row-key":"id",columns:N.columns,request:T,btn:N.btn,searchConfig:N.searchConfig,onSelectionChange:I,multi:""},{option:n((e=>[o(l,{array:N.cellBtns,model:e,onOnClick:D},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),o(m,{ref_key:"addFundPermissionRef",ref:w,onOk:v},null,512)]))}});export{w as default};