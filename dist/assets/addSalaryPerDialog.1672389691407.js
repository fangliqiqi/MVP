import{P as e}from"./index.16723896914073.js";import{n as a,o as l,p as o}from"./settings.1672389691407.js";import{g as t}from"./fee.1672389691407.js";import{_ as r,E as d}from"./index.1672389691407.js";import{d as i,f as s,$ as u,h as n,c as m,W as c,P as p,a3 as f,o as g,a as h,U as F}from"./vue.1672389691407.js";const v={"class":"archives-add-electronic-container"},_=F("是"),b=F("否"),y={"class":"dialog-footer"},S=F("取 消"),V=F("确 定"),w=i({name:"addSalaryPerDialog"});var N=r(Object.assign(w,{props:{isModifyOrAddFlag:{type:Boolean,"default":!1}},emits:["ok"],setup(r,{expose:i,emit:F}){const w=r,N=s(null);s(null);const D=s(!1),k=u({isShowDialog:!1,id:null,title:"新增配置",ruleForm:{},fileList:[],literatureTypesDataSource:{},options:[],loading:!1}),j={id:[{required:!0,message:"请选择项目名称"}],deptNo:[{required:!0,message:"请输入项目编码"}],canSee:[{required:!0,message:"请选择是否允许查看工资"}]},x=e=>{k.ruleForm.id=e.id,k.ruleForm.deptName=e.departName,k.ruleForm.deptNo=e.departNo};n((()=>w.isModifyOrAddFlag),((e,a)=>{D.value=e}));const U=async e=>{try{const a=await t(Object.assign({},e,{flag:"1"}));if(a&&200==a.code&&a.data)return{current:a.data.current,total:a.data.total,data:a.data.records};d.error(a.msg)}catch(a){}return{current:1,total:0,data:[]}},q=async e=>{try{const l=await a(e);l&&200===l.code&&l.data?(k.options=[{id:l.data.id,departName:l.data.deptName}],k.ruleForm=l.data||{},k.ruleForm.canSee=l.data.canSee+"",k.isShowDialog=!0):(d.error(l.msg||"获取详情失败"),C())}catch(l){C(),d.error("获取详情失败")}},C=()=>{k.ruleForm={},k.isShowDialog=!1,N.value&&N.value.clearValidate()},O=()=>{C()},z=()=>{N.value&&N.value.validate((e=>{e&&(k.loading=!0,null!==k.id&&void 0!==k.id?l(k.ruleForm).then((e=>{e&&200==e.code?(d.success("编辑成功"),F("ok"),C()):d.error(e.msg||"编辑失败")}),(()=>{d.error("编辑电失败")}))["finally"]((e=>{k.loading=!1})):o(k.ruleForm).then((e=>{e&&200==e.code?(d.success("新增成功"),F("ok"),C()):d.error(e.msg||"新增失败")}),(()=>{d.error("新增失败")}))["finally"]((e=>{k.loading=!1})))}))};return i({openDialog:async e=>{e&&e.id?(k.title="编辑配置",k.id=e.id,await q(e.id)):(k.title="新增配置",k.id=null,k.ruleForm={id:null},setTimeout((()=>{N.value&&N.value.clearValidate()}),100)),k.isShowDialog=!0}}),(a,l)=>{const o=f("el-form-item"),t=f("el-col"),r=f("el-input"),d=f("el-option"),i=f("el-select"),s=f("el-row"),u=f("el-form"),n=f("el-button"),F=f("el-dialog");return g(),m("div",v,[c(F,{title:k.title,modelValue:k.isShowDialog,"onUpdate:modelValue":l[3]||(l[3]=e=>k.isShowDialog=e),"close-on-click-modal":!1,width:"576px",onClose:C},{footer:p((()=>[h("span",y,[c(n,{onClick:O,size:"default"},{"default":p((()=>[S])),_:1}),c(n,{type:"primary",onClick:z,size:"default",loading:k.loading},{"default":p((()=>[V])),_:1},8,["loading"])])])),"default":p((()=>[c(u,{ref_key:"formRef",ref:N,model:k.ruleForm,rules:j,size:"default","label-width":"140px"},{"default":p((()=>[c(s,null,{"default":p((()=>[c(t,{"class":"mb20"},{"default":p((()=>[c(o,{label:"项目名称",prop:"id"},{"default":p((()=>[c(e,{ref:"settleDomainRef",modelValue:k.ruleForm.id,"onUpdate:modelValue":l[0]||(l[0]=e=>k.ruleForm.id=e),request:U,"value-key":"id",title:"departName",search:"departName",placeholder:"请选择项目名称",onChange:x,options:k.options,manual:"",disabled:D.value},null,8,["modelValue","options","disabled"])])),_:1})])),_:1}),c(t,{"class":"mb20"},{"default":p((()=>[c(o,{label:"请输入项目编码",prop:"deptNo"},{"default":p((()=>[c(r,{modelValue:k.ruleForm.deptNo,"onUpdate:modelValue":l[1]||(l[1]=e=>k.ruleForm.deptNo=e),placeholder:"请输入项目编码",maxlength:"20",disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),c(t,{"class":"mb20"},{"default":p((()=>[c(o,{label:"是否允许查看工资",prop:"canSee"},{"default":p((()=>[c(i,{modelValue:k.ruleForm.canSee,"onUpdate:modelValue":l[2]||(l[2]=e=>k.ruleForm.canSee=e),modelModifiers:{trim:!0},style:{width:"100%"},placeholder:"请选择",filterable:""},{"default":p((()=>[c(d,{value:"0",label:"是"},{"default":p((()=>[_])),_:1}),c(d,{value:"1",label:"否"},{"default":p((()=>[b])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-609be366"]]);export{N as default};