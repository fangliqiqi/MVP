import{g as e}from"./file.1672389691407.js";import{_ as l}from"./index.16723896914078.js";import{E as a,g as t}from"./index.1672389691407.js";import{c as o,j as r}from"./contract.1672389691407.js";import{d as i,f as s,$ as d,c as u,W as n,P as m,a3 as f,o as c,a as p,U as _,V as g}from"./vue.1672389691407.js";const F={"class":"system-add-dic-container"},h={"class":"dialog-footer"},b=_("取 消"),y=_("确 定"),N=i({name:"editContractFile"}),w=Object.assign(N,{emits:["ok"],setup(i,{expose:N,emit:w}){const L=s(null),v=s(null),C=d({isShowDialog:!1,loading:!1,title:"合同归档",ruleForm:{id:"",contractNo:"",fileCabinetNo:"",attaList:""},fileList:[],dictKeys:["emp_natrue","check_type"],dicts:[]}),V={},j=e=>{C.fileList=e.value},k=e=>{C.fileList=e.value},x=async l=>{try{(async()=>{const e=await t(C.dictKeys);C.dicts=e})();const r=await o(l);if(r&&200===r.code){const e={...r.data};C.ruleForm=e,C.isShowDialog=!0}else a.error(r.msg||"获取合同详情失败");const i=await e(l);i&&200===i.code?C.fileList=i.data.map((e=>(e.name=e.attaName,e.uid=e.id,e.url=e.attaUrl,e))):(C.fileList=[],a.error(i.msg||"获取附件失败"))}catch(r){D()}},D=()=>{L.value.resetFields(),C.ruleForm={id:"",contractNo:"",fileCabinetNo:"",attaList:""},C.fileList=[],C.isShowDialog=!1},U=()=>{D()},S=()=>{L.value.validate((e=>{if(e){const e=[];if(C.fileList.forEach((l=>{e.push(l.uid)})),C.ruleForm.attaList=e,!C.ruleForm.contractNo&&!C.ruleForm.fileCabinetNo&&0==C.fileList.length)return void a.error("合同编码、档案柜号、附件不可同时为空！");C.loading=!0,C.ruleForm.id&&r(C.ruleForm).then((e=>{e&&200==e.code?(a.success("合同归档成功"),w("ok"),D()):a.error(e.msg||"合同归档失败")}))["catch"]((e=>{a.error("合同归档失败")}))["finally"]((()=>{C.loading=!1}))}}))};return N({openDialog:async e=>{e&&e.id&&await x(e.id)}}),(e,a)=>{const t=f("el-form-item"),o=f("el-col"),r=f("el-divider"),i=f("el-input"),s=f("el-row"),d=f("el-form"),N=f("el-button"),w=f("el-dialog");return c(),u("div",F,[n(w,{title:C.title,modelValue:C.isShowDialog,"onUpdate:modelValue":a[2]||(a[2]=e=>C.isShowDialog=e),"close-on-click-modal":!1,width:"816px",onClose:D},{footer:m((()=>[p("span",h,[n(N,{onClick:U,size:"default"},{"default":m((()=>[b])),_:1}),n(N,{type:"primary",onClick:S,loading:C.loading,size:"default"},{"default":m((()=>[y])),_:1},8,["loading"])])])),"default":m((()=>[n(d,{ref_key:"formRef",ref:L,model:C.ruleForm,rules:V,size:"default","label-width":"110px"},{"default":m((()=>[n(s,null,{"default":m((()=>[n(o,{span:12},{"default":m((()=>[n(t,{label:"申请编号",prop:"applyNo"},{"default":m((()=>[_(g(C.ruleForm.applyNo),1)])),_:1})])),_:1}),n(o,{span:12},{"default":m((()=>[n(t,{label:"员工姓名",prop:"empName"},{"default":m((()=>[_(g(C.ruleForm.empName),1)])),_:1})])),_:1}),n(o,{span:12},{"default":m((()=>[n(t,{label:"身份证号",prop:"empIdcard"},{"default":m((()=>[_(g(C.ruleForm.empIdcard),1)])),_:1})])),_:1}),n(o,{span:12},{"default":m((()=>[n(t,{label:"项目名称",prop:"subjectDepart"},{"default":m((()=>[_(g(C.ruleForm.subjectDepart),1)])),_:1})])),_:1}),n(o,{span:12},{"default":m((()=>[n(t,{label:"员工类型",prop:"empNatrue"},{"default":m((()=>[_(g(C.dicts.emp_natrue[C.ruleForm.empNatrue]),1)])),_:1})])),_:1}),n(o,{span:12},{"default":m((()=>[n(t,{label:"合同类型",prop:"contractName"},{"default":m((()=>[_(g(C.ruleForm.contractName),1)])),_:1})])),_:1}),n(o,{span:12},{"default":m((()=>[n(t,{label:"审核类型",prop:"type"},{"default":m((()=>[_(g(C.dicts.check_type[C.ruleForm.type]),1)])),_:1})])),_:1}),n(r),n(o,{span:12},{"default":m((()=>[n(t,{label:"合同编码"},{"default":m((()=>[n(i,{modelValue:C.ruleForm.contractNo,"onUpdate:modelValue":a[0]||(a[0]=e=>C.ruleForm.contractNo=e),placeholder:"请输入合同编码",maxlength:"50"},null,8,["modelValue"])])),_:1})])),_:1}),n(o,{span:12},{"default":m((()=>[n(t,{label:"档案柜号"},{"default":m((()=>[n(i,{modelValue:C.ruleForm.fileCabinetNo,"onUpdate:modelValue":a[1]||(a[1]=e=>C.ruleForm.fileCabinetNo=e),placeholder:"请输入档案柜号",maxlength:"50"},null,8,["modelValue"])])),_:1})])),_:1}),n(s,{md:24,lg:24,xl:24},{"default":m((()=>[n(t,{label:"附件"},{"default":m((()=>[n(l,{ref_key:"attachUploadRef",ref:v,"file-list":C.fileList,onRemovefile:k,onChangefile:j,type:4,filePath:"badnessFile",domain:C.ruleForm.id},null,8,["file-list","domain"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}});export{w as default};