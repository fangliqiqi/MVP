import{d as e,f as t,h as a,$ as r,E as o,j as d,c as i,W as n,P as s,u as l,aD as c,aA as u,A as m,a3 as p,o as h,a as f,U as x,ay as y,az as b,i as I}from"./vue.1672389691407.js";import{P as g}from"./ProTable.1672389691407.js";import{P as _}from"./index.16723896914072.js";import{g as v,r as w}from"./order.1672389691407.js";import{_ as S,g as T,f as N,a as H,E as k}from"./index.1672389691407.js";import{p as j,q as D,r as E}from"./header.1672389691407.js";import{o as W,a as C}from"./events.1672389691407.js";import{B as R}from"./index.16723896914077.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./excel.1672389691407.js";const B=e=>(y("data-v-c7614b9e"),e=e(),b(),e),Y={"class":"cardinal-config-container"},A={"class":"el-dropdown-link"},z=x(" 模板下载 "),M=B((()=>f("a",{href:"/template/socialfund/社保、公积金批量派增模板.xlsx",download:""}," 批量派增模板",-1))),P=B((()=>f("a",{href:"/template/socialfund/派单申请批量派减模板.xls",download:""}," 批量派减模板",-1))),K=B((()=>f("div",null,[
f("div",{style:{color:"red","font-size":"24px","text-align":"center",margin:"10px 0 25px"}},"批量导入失败！"),
f("span",null,[
x("存在不符合要求的数据，请修改后，重新导入！"),
f("br"),
x("已为您下载反馈结果！")])],-1))),O=B((()=>f("div",null,[
f("div",{style:{color:"red","font-size":"24px","text-align":"center",margin:"10px 0 25px"}},"批量导入失败！"),
f("span",null,[
x("存在不符合要求的数据，请修改后，重新导入！"),
f("br"),
x("已为您下载反馈结果！")])],-1))),U=e({name:"派单申请"});var q=S(Object.assign(U,{props:{orderNo:String},emits:["onActionUpdate"],setup(e,{emit:x}){const y=e,b=t(null),S=t(null),B=t(null),U=c(),q=u(),{proxy:L}=I(),F=()=>{b.value&&b.value.onSearch()},G=()=>{x("onActionUpdate"),F()};a((()=>y.orderNo),(e=>{F()}));const $=(e,t)=>{let a=null;return"socialfund-batch-dispath-add"!==e&&"socialfund-batch-dispath-reduce"!==e||(a=t.map((e=>{const t="red"===e.color?"是":"否";return{line:e.lineNum,isError:t,error:e.message}})).sort(((e,t)=>Number(e.line)-Number(t.line)))),a},J=async(e,t)=>{switch(e){case"detail":U.push({name:"oreder-manage-socialfund-detail",params:{id:t.id}});break;case"remove":Q(t)}},Q=e=>{H.confirm('<p style="font-size:16px;font-weight:600">是否确定删除?<br/>\n\t\t\t\t<span style="color:red;font-size:14px;font-weight:400">删除后，派单信息将从系统消失，请谨慎操作！</span></p>',{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((async()=>{try{const t=await w(e.id);t&&200===t.code?(k.success("派单信息删除成功"),G()):k.error(t.msg||"派单信息删除失败")}catch(t){k.error(t&&t.msg||"派单信息删除失败")}}))["catch"]((()=>{}))},V=r({searchConfig:{labelWidth:90,option:{extBtn:"extBtns"}},columns:[{dataIndex:"type",title:"派单类型",hideInSearch:!0,width:120},{dataIndex:"empName",title:"员工姓名",minWidth:120,ellipsis:!0},{dataIndex:"empIdcard",title:"身份证号",width:190,tooltip:!0},{dataIndex:"empType",title:"员工类型",hideInSearch:!0,width:100},{dataIndex:"socialHouseholdName",title:"社保户",minWidth:180,tooltip:!0,hideInSearch:!0},{dataIndex:"socialAddress",title:"社保缴纳地",hideInSearch:!0,minWidth:180,valueType:"addRess",params:{pro:"socialProvince",city:"socialCity",town:"socialTown"}},{dataIndex:"empNo",title:"员工编码",minWidth:150,hideInSearch:!0,ellipsis:!0},{dataIndex:"providentHouseholdName",title:"公积金户",minWidth:180,tooltip:!0,hideInSearch:!0},{dataIndex:"dispatchItem",title:"派单项",hideInSearch:!0,minWidth:180,tooltip:!0},{dataIndex:"createName",title:"申请人",minWidth:120,hideInSearch:!0},{dataIndex:"organName",title:"申请人所在部门",minWidth:160,hideInSearch:!0,tooltip:!0},{dataIndex:"createTime",title:"申请时间",valueType:"dateTimeRange",searchIndex:"createTime",startTime:"createTimeStart",endTime:"createTimeEnd",minWidth:160,valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD",selectType:"daterange"},{dataIndex:"status",title:"审核状态",hideInSearch:!0,width:100},{dataIndex:"socialHandleStatus",title:"社保办理状态",hideInSearch:!0,minWidth:120},{dataIndex:"fundHandleStatus",title:"公积金办理状态",minWidth:125,hideInSearch:!0},{dataIndex:"option",title:"操作",key:"option",width:120,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],params:{},btn:[{label:"批量派增",onClick:()=>{S.value&&S.value.openDialog()},permission:["demo_tdispatchinfo-batch-import"],icon:"icon-ic_edit_export",disabled:()=>m("disable")},{label:"批量派减",onClick:()=>{B.value&&B.value.openDialog()},type:"default",permission:["demo_tdispatchinfo-batch-reduce"],icon:"icon-ic_edit_export",disabled:()=>m("disable")}],cellBtns:[{text:"详情",prop:"detail",permission:["demo_tdispatchinfo_get"]},{text:"删除",prop:"remove",permission:["demo_tdispatchinfo_del"],isGray:e=>{if(m("disable"))return!0;if(3==e.status)return!1;if(4==e.status){let t=!0;return e.socialHouseholdName&&(t&=2==e.socialHandleStatus),e.providentHouseholdName&&(t&=2==e.fundHandleStatus),!t}return!0}}],dictKeys:["emp_natrue","send_order_type","social-conduct-status","fund-conduct-status","dispatch-audit-status"],DICTS:{}});o((()=>{W(L)})),d((()=>{C(L,q.path,(()=>{F()})),X()}));const X=async()=>{if(V.dictKeys&&V.dictKeys.length){const e=await T(V.dictKeys);e&&(V.DICTS=e,V.columns=V.columns.map((t=>{const a={...t};switch(t.dataIndex){case"empType":a.valueEnum=e.emp_natrue;break;case"type":a.valueEnum=e.send_order_type;break;case"socialHandleStatus":a.valueEnum=e["social-conduct-status"];break;case"fundHandleStatus":a.valueEnum=e["fund-conduct-status"];break;case"status":a.valueEnum=e["dispatch-audit-status"]}return a})))}},Z=async e=>{try{e.createTime&&(e.createTime=null),e.orderId=y.orderNo;const t=await v(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records}}catch(t){}return{current:1,total:0,data:[]}};return(e,t)=>{const a=p("el-icon"),r=p("el-button"),o=p("el-dropdown-item"),d=p("el-dropdown-menu"),c=p("el-dropdown");return h(),i("div",Y,[n(g,{ref_key:"proTableRef",ref:b,"row-key":"id",columns:V.columns,request:Z,btn:V.btn,searchConfig:V.searchConfig,manualRequest:!0},{extBtns:s((()=>[n(c,{"class":"arch-btn","popper-class":"module-download"},{dropdown:s((()=>[n(d,null,{"default":s((()=>[n(o,null,{"default":s((()=>[M])),_:1}),n(o,null,{"default":s((()=>[P])),_:1})])),_:1})])),"default":s((()=>[f("span",A,[n(r,{size:"default"},{"default":s((()=>[z,n(a,{"class":"el-icon--right"},{"default":s((()=>[n(l(N))])),_:1})])),_:1})])])),_:1})])),option:s((e=>[n(_,{array:V.cellBtns,model:e,onOnClick:J},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),n(R,{title:"批量派增",ref_key:"batchDispatchAddRef",ref:S,type:1,header:l(j),url:"/yifu-social/method/tdispatchinfo/importListAdd",onOk:G,batchName:"socialfund-batch-dispath-add",errorHeader:l(D),errorData:$,customError:"",customErrorContent:"",download:"",ext:{orderId:y.orderNo}},{error:s((()=>[K])),_:1},8,["header","errorHeader","ext"]),n(R,{title:"批量派减",ref_key:"batchDispatchReduceRef",ref:B,type:1,header:l(E),url:"/yifu-social/method/tdispatchinfo/importListReduce",onOk:G,batchName:"socialfund-batch-dispath-reduce",errorHeader:l(D),errorData:$,customError:"",customErrorContent:"",download:"",ext:{orderId:y.orderNo}},{error:s((()=>[O])),_:1},8,["header","errorHeader","ext"])])}}}),[["__scopeId","data-v-c7614b9e"]]);export{q as default};