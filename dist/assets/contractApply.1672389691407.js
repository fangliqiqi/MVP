import{P as t}from"./ProTable.1672389691407.js";import{P as e}from"./index.16723896914072.js";import{B as a}from"./index.16723896914077.js";import{C as n}from"./header.1672389691407.js";import{_ as i,g as o,f as d,a as s,E as r}from"./index.1672389691407.js";import{g as l,d as c,a as p}from"./contract.1672389691407.js";import{d as m,f as h,$ as u,a2 as f,j as y,E as x,c as b,W as I,P as _,u as g,aD as v,aA as w,a3 as S,o as W,a as j,U as k,ay as T,az as C,i as D}from"./vue.1672389691407.js";import{i as O}from"./city.1672389691407.js";import{o as E,a as N}from"./events.1672389691407.js";import Y from"./showDeletes.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./xlsx.1672389691407.js";import"./excel.1672389691407.js";const z=t=>(T("data-v-1ee7bbb4"),t=t(),C(),t),B={"class":"system-dict-container"},M={"class":"el-dropdown-link"},P=k(" 模板下载 "),R=z((()=>j("a",{href:"/template/员工合同管理导入模板.xlsx",download:""}," 批量导入模板",-1))),U=z((()=>j("div",null,[
j("span",null,[
k("存在不符合要求的数据，请修改后，重新导入！"),
j("br"),
k("已为您下载反馈结果！")])],-1))),q=m({name:"合同申请"});var L=i(Object.assign(q,{setup(i){const m=h(null),k=h(null),T=h(null),C=v(),z=w(),{proxy:q}=D(),L=t=>{F.selectOptions=t,F.selectOptions.length>0?F.btn.find((t=>"批量删除"==t.label)).disabled=!1:F.btn.find((t=>"批量删除"==t.label)).disabled=!0},F=u({searchConfig:{labelWidth:110,option:{extBtn:"extBtns"}},columns:[{dataIndex:"type",title:"审核类型",hideInSearch:!1,minWidth:200,tooltip:!0},{dataIndex:"applyNo",title:"申请编号",hideInSearch:!0,minWidth:180},{dataIndex:"empName",title:"员工姓名",minWidth:160},{dataIndex:"empIdcard",title:"身份证号",minWidth:200},{dataIndex:"archivesLocation",title:"档案所在地",hideInSearch:!0,tooltip:!0,minWidth:200,formatter:t=>O({province:t.fileProvince,city:t.fileCity,town:t.fileTown})},{dataIndex:"empNatrue",title:"员工类型",hideInSearch:!0,minWidth:160},{dataIndex:"contractName",title:"合同类型",hideInSearch:!0,minWidth:200},{dataIndex:"situation",title:"签订类型",hideInSearch:!0,minWidth:200},{dataIndex:"subjectDepart",title:"项目名称",minWidth:200,tooltip:!0},{dataIndex:"deptNo",title:"项目编码",minWidth:160},{dataIndex:"applyNo",title:"申请编号",minWidth:180,hideInTable:!0},{dataIndex:"subjectUnit",title:"客户名称",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"contractParty",title:"合同甲方",hideInSearch:!0,minWidth:160,tooltip:!0},{dataIndex:"contractStart",title:"合同起始日期",hideInSearch:!0,minWidth:160,dateFormat:"YYYY-MM-DD"},{dataIndex:"contractEnd",title:"合同截止日期",hideInSearch:!0,minWidth:160,dateFormat:"YYYY-MM-DD"},{dataIndex:"contractType",title:"签订期限",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"auditStatus",title:"审批状态",minWidth:160,valueType:"select"},{dataIndex:"createTime",title:"创建时间",minWidth:180,searchIndex:"startEndTime",startTime:"createTimeStart",endTime:"createTimeEnd",valueType:"dateTimeRange"},{dataIndex:"option",title:"操作",key:"option",minWidth:200,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"合同申请",onClick:()=>{C.push({name:"contract-add",params:{}})},permission:["temployeecontractinfo_add"],icon:"icon-ic_edit_add"},{label:"批量申请",permission:["temployeecontractinfo_batch_import"],onClick:()=>{k.value&&k.value.openDialog()},type:"normal",icon:"icon-ic_edit_upload"},{label:"批量删除",permission:["temployeecontractinfo_del"],onClick:()=>{if(F.selectOptions.length>0){const t=`<p style="font-size:16px;font-weight:600">是否确定删除${F.selectOptions.length}条员工合同?<br/>\n\t\t\t\t<span style="color:red;font-size:14px;font-weight:400">删除后员工合同将从系统消失，请谨慎操作！</span></p>`;s.confirm(t,{type:"warning",dangerouslyUseHTMLString:!0}).then((()=>{const t=[];F.selectOptions.map((e=>{t.push(e.id)})),c(t).then((t=>{200==t.code&&t.data&&t.data.length>0?(T.value.openDialog(t.data),m.value.refresh()):200!=t.code||t.data?r.error(t.msg||"删除失败"):(r.success(t.msg||"删除成功"),m.value.refresh())}))}))}},type:"normal",icon:"icon-ic_edit_delete",disabled:!0}],cellBtns:[{text:"详情",prop:"detail",permission:["temployeecontractinfo_detail"]},{text:"编辑",prop:"edit",permission:["temployeecontractinfo_edit"],isGray:t=>0!=t.auditStatus,tooltip:"非待提交状态不可编辑"},{text:"删除",prop:"delete",permission:["temployeecontractinfo_del"],isGray:t=>0!=t.auditStatus,tooltip:"待审核、审核通过状态不可删除"}],selectOptions:[],params:{},dictKeys:["emp_natrue","contract_audit_status","employee_contract_type","check_type"]}),{columns:G,cellBtns:H,btn:K,searchConfig:$}=f(F),A=async t=>{try{const e=await l(t);if(e&&200==e.code&&e.data)return{current:e.data.current,total:e.data.total,data:e.data.records.map(((e,a)=>({...e,index:(t.current-1)*t.size+a+1})))}}catch(e){}return{current:1,total:0,data:[]}},J=()=>{m.value.refresh()},Q=async(t,e)=>{if("delete"===t){const t='<p style="font-size:16px;font-weight:600">是否确定删除?<br/>\n\t\t\t\t<span style="color:red;font-size:14px;font-weight:400">删除后员工合同将从系统消失，请谨慎操作！</span></p>';s.confirm(t,{type:"warning",dangerouslyUseHTMLString:!0}).then((async()=>{const t=await p(e.id);t&&200==t.code?(r.success("删除成功"),J()):r.error(t.msg||"删除失败")}))["catch"]((()=>{}))}else"edit"===t?C.push({name:"contract-edit",query:{id:e.id}}):"detail"===t&&C.push({name:"contract-detail",query:{id:e.id}})};return y((()=>{(async()=>{try{const t=await o(F.dictKeys);t&&F.columns.map((e=>{switch(e.dataIndex){case"empNatrue":e.valueEnum=t.emp_natrue;break;case"auditStatus":e.valueEnum=t.contract_audit_status;break;case"contractType":e.valueEnum=t.employee_contract_type;break;case"type":e.valueEnum=t.check_type}return e}))}catch(t){}})(),N(q,z.path,(()=>{J()}))})),x((()=>{E(q)})),(i,o)=>{const s=S("el-icon"),r=S("el-button"),l=S("el-dropdown-item"),c=S("el-dropdown-menu"),p=S("el-dropdown");return W(),b("div",B,[I(t,{ref_key:"proTableRef",ref:m,"row-key":"id",columns:g(G),request:A,btn:g(K),searchConfig:g($),multi:!0,onSelectionChange:L},{extBtns:_((()=>[I(p,{"class":"arch-btn","popper-class":"module-download"},{dropdown:_((()=>[I(c,null,{"default":_((()=>[I(l,null,{"default":_((()=>[R])),_:1})])),_:1})])),"default":_((()=>[j("span",M,[I(r,{size:"default"},{"default":_((()=>[P,I(s,{"class":"el-icon--right"},{"default":_((()=>[I(g(d))])),_:1})])),_:1})])])),_:1})])),option:_((t=>[I(e,{array:g(H),model:t,onOnClick:Q},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),I(a,{ref_key:"batchImportDialogRef",ref:k,header:g(n),url:"/yifu-archives/method/temployeecontractinfo/batchImport",errName:"合同批量申请",title:"批量申请",download:!0,onOk:J},{error:_((()=>[U])),_:1},8,["header"]),I(Y,{ref_key:"showDeletesRef",ref:T,onOk:J},null,512)])}}}),[["__scopeId","data-v-1ee7bbb4"]]);export{L as default};