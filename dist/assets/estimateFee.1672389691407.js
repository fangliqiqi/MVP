import{d as e,f as t,$ as a,E as i,j as n,c as l,W as o,P as r,u as s,aD as d,aA as m,o as c,i as u}from"./vue.1672389691407.js";import{P as p}from"./ProTable.1672389691407.js";import{P as h}from"./index.16723896914072.js";import{a as f,e as y}from"./fee.1672389691407.js";import{E as x}from"./index.16723896914076.js";import v from"./estimateFeeDetail.1672389691407.js";import Y from"./addEstimateFee.1672389691407.js";import{g,e as I,W as T,a as S,E as W}from"./index.1672389691407.js";import{av as j}from"./header.1672389691407.js";import{o as M,a as C}from"./events.1672389691407.js";import{c as b}from"./socialHandlePermission.16723896914072.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./vuedraggable.umd.1672389691407.js";const _={"class":"cardinal-config-container"},P=e({name:"预估费用"}),F=Object.assign(P,{setup(e){const P=t(null),F=t(null),k=t(null),w=t(null);d();const E=m(),{proxy:D}=u(),N=()=>{P.value&&P.value.refresh()},R=async(e,t)=>{"detail"===e&&w.value&&w.value.openDialog(t)},A=e=>{O.selectionChangeList=e},K=async e=>{try{e=Object.assign({},{type:0},e);const t=await b(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records};W.error(t.msg)}catch(t){}return{current:1,total:0,data:[]}},O=a({selectionChangeList:[],searchConfig:{labelWidth:120},columns:[{dataIndex:"empName",title:"员工姓名",minWidth:180,fixed:"left"},{dataIndex:"empIdcard",title:"身份证号",minWidth:200},{dataIndex:"unitName",title:"客户名称",minWidth:180,tooltip:!0},{dataIndex:"deptName",title:"项目名称",minWidth:180,tooltip:!0},{dataIndex:"deptNo",title:"项目编码",minWidth:180,tooltip:!0},{dataIndex:"empNatrue",title:"员工类型",minWidth:180},{dataIndex:"socialHouseholdName",title:"社保户",minWidth:200,valueType:"PageSelect",request:K,pageProps:{valueKey:"name",title:"name",search:"name",parmas:{type:0}},tooltip:!0},{dataIndex:"socialAddress",title:"社保缴纳地",minWidth:200,valueType:"addRess",tooltip:!0,params:{pro:"socialProvince",city:"socialCity",town:"socialTown"}},{dataIndex:"socialPayMonth",title:"社保缴纳月份",minWidth:160,valueType:"date",selectType:"month",valueFormat:"YYYYMM",format:"YYYY年MM月"},{dataIndex:"socialCreateMonth",title:"社保生成月份",minWidth:160,valueType:"date",selectType:"month",valueFormat:"YYYYMM",format:"YYYY年MM月"},{dataIndex:"socialSum",title:"社保费用",hideInSearch:!0,minWidth:200,formatter:e=>{var t,a;if(null==e.unitSocialSum&&null==e.personalSocialSum)return I;let i=null!=(t=e.unitSocialSum)?t:0,n=null!=(a=e.personalSocialSum)?a:0;return T((100*i+100*n)/100)+"元"}},{dataIndex:"providentHouseholdName",title:"公积金户",minWidth:200,valueType:"PageSelect",request:K,pageProps:{valueKey:"name",title:"name",search:"name",parmas:{type:1}},tooltip:!0},{dataIndex:"fundAddress",title:"公积金缴纳地",minWidth:200,valueType:"addRess",tooltip:!0,params:{pro:"fundProvince",city:"fundCity",town:"fundTown"}},{dataIndex:"providentPayMonth",title:"公积金缴纳月份",minWidth:160,valueType:"date",selectType:"month",valueFormat:"YYYYMM",format:"YYYY年MM月"},{dataIndex:"providentCreateMonth",title:"公积金生成月份",minWidth:160,valueType:"date",selectType:"month",valueFormat:"YYYYMM",format:"YYYY年MM月"},{dataIndex:"FundSum",title:"公积金费用",hideInSearch:!0,minWidth:160,formatter:e=>{var t,a;if(null==e.unitFundSum&&null==e.personalFundSum)return I;let i=null!=(t=e.unitFundSum)?t:0,n=null!=(a=e.personalFundSum)?a:0;return T((100*i+100*n)/100)+"元"}},{dataIndex:"sumAll",title:"费用合计",hideInSearch:!0,minWidth:180,formatter:e=>e.sumAll?T(e.sumAll)+"元":I},{dataIndex:"createTime",title:"数据生成时间",minWidth:180,valueType:"dateTimeRange",searchIndex:"createTime",startTime:"createTimeStart",endTime:"createTimeEnd"},{dataIndex:"dataPush",title:"同步状态",valueEnum:{0:"未同步",1:"已同步"}},{dataIndex:"option",title:"操作",key:"option",width:140,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"按缴纳月重新生成",onClick:()=>{F.value&&F.value.openDialog()},permission:["social_tforecastlibrary_create"],icon:"icon-ic_edit_add"},{label:"批量导出",type:"default",onClick:()=>{let e=Object.assign({},P.value.getParams(),O.params);delete e.size,delete e.current,k.value&&k.value.openDialog(((t,a)=>{const i={...e,exportFields:t.map((e=>e.dataIndex))},n=O.selectionChangeList.map((e=>e.id));n&&n.length&&(i.idList=n),delete i.createTime,y({},i).then((e=>{e.code&&200!==e.code&&S.error(e.msg),a(!0)}))}))},permission:["social_tforecastlibrary-export"],icon:"icon-ic_edit_export"}],cellBtns:[{text:"详情",prop:"detail",permission:["social_tforecastlibrary_get"]}],dictKeys:["emp_natrue"],DICTS:{}});i((()=>{M(D)})),n((()=>{C(D,E.path,(()=>{N()})),L()}));const L=async()=>{if(O.dictKeys&&O.dictKeys.length){const e=await g(O.dictKeys);e&&(O.DICTS=e,O.columns=O.columns.map((t=>{const a={...t};if("empNatrue"===t.dataIndex)a.valueEnum=e.emp_natrue;return a})))}},q=async e=>{try{e.createTime&&(e.createTime=null);const t=await f(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records}}catch(t){}return{current:1,total:0,data:[]}};return(e,t)=>(c(),l("div",_,[o(p,{ref_key:"proTableRef",ref:P,"row-key":"id",searchConfig:O.searchConfig,columns:O.columns,request:q,btn:O.btn,onSelectionChange:A,multi:""},{option:r((e=>[o(h,{array:O.cellBtns,model:e,onOnClick:R},null,8,["array","model"])])),_:1},8,["searchConfig","columns","btn"]),o(Y,{ref_key:"addEstimateFeeRef",ref:F,onOk:N},null,512),o(x,{ref_key:"exportExcelRef",ref:k,heads:s(j),title:"批量导出",useCode:"social_tforecastlibrary-export"},null,8,["heads"]),o(v,{ref_key:"estimateFeeDetailRef",ref:w},null,512)]))}});export{F as default};