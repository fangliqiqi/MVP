import{q as e,r as a}from"./staff.1672389691407.js";import{d as l,f as o,$ as r,c as m,W as d,P as s,aD as t,a3 as u,o as i,a as n,U as c}from"./vue.1672389691407.js";import{E as p,m as f,a as g}from"./index.1672389691407.js";const h={"class":"check-archives-dialog"},F={"class":"dialog-footer"},C=c("取 消"),b=c("确 定"),v=l({name:"checkArchivesDialog"}),_=Object.assign(v,{emits:["ok"],setup(l,{expose:c,emit:v}){const _=t(),w=o(null),y=r({isShowDialog:!1,ruleForm:{empIdCard:null,empName:null},info:null,loading:!1}),I=()=>{y.ruleForm.empIdCard=y.ruleForm.empIdCard.replace(/[^a-zA-Z0-9]/g,"")},V=r({empName:[{required:!0,message:"请输入人员姓名",trigger:"blur"}],empIdCard:[{required:!0,message:"请输入身份证号",trigger:"blur"}]}),x=()=>{w.value&&w.value.clearValidate(),y.isShowDialog=!1,y.loading=!1},k=()=>{y.loading=!0,e(y.ruleForm).then((e=>{var l;e&&200===e.code?(_.push({path:"/archives/staff/online/add",query:{empIdcard:y.ruleForm.empIdCard,empName:y.ruleForm.empName,_t:f(y.ruleForm.empIdCard+y.ruleForm.empName)}}),x()):e&&2===e.code?(l=e.data.id,g.confirm("该人员在离职库已存在，是否'恢复档案'？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const e=await a({id:l});e&&200===e.code?(p.success("恢复档案成功"),v("ok"),x()):p.error(e.msg||"恢复档案失败")}catch(e){p.error("恢复档案失败")}}))["catch"]((()=>{}))):p.error(e.msg||"数据校验不通过")}))["finally"]((()=>{y.loading=!1}))},D=()=>{w.value&&w.value.validate((e=>{e&&k()}))};return c({openDialog:async e=>{y.info=e,y.isShowDialog=!0}}),(e,a)=>{const l=u("el-input"),o=u("el-form-item"),r=u("el-col"),t=u("el-row"),c=u("el-form"),p=u("el-button"),f=u("el-dialog");return i(),m("div",h,[d(f,{title:"人员档案新增",modelValue:y.isShowDialog,"onUpdate:modelValue":a[2]||(a[2]=e=>y.isShowDialog=e),"close-on-click-modal":!1,width:"576px",onClose:x},{footer:s((()=>[n("span",F,[d(p,{onClick:x,size:"default"},{"default":s((()=>[C])),_:1}),d(p,{type:"primary",onClick:D,size:"default"},{"default":s((()=>[b])),_:1})])])),"default":s((()=>[d(c,{ref_key:"formRef",ref:w,model:y.ruleForm,rules:V,size:"default","label-width":"90px"},{"default":s((()=>[d(t,null,{"default":s((()=>[d(r,{"class":"mb20"},{"default":s((()=>[d(o,{label:"姓名",prop:"empName"},{"default":s((()=>[d(l,{modelValue:y.ruleForm.empName,"onUpdate:modelValue":a[0]||(a[0]=e=>y.ruleForm.empName=e),placeholder:"请输入人员姓名",maxlength:"20",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),d(r,{"class":"mb20"},{"default":s((()=>[d(o,{label:"身份证号",prop:"empIdCard"},{"default":s((()=>[d(l,{modelValue:y.ruleForm.empIdCard,"onUpdate:modelValue":a[1]||(a[1]=e=>y.ruleForm.empIdCard=e),onKeyup:I,placeholder:"请输入身份证号",maxlength:"20",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}});export{_ as default};