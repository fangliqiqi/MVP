import{d as e,f as t,$ as a,E as i,j as n,c as s,W as d,P as o,u as l,aD as r,aA as c,o as m,i as u}from"./vue.1672389691407.js";import{P as p}from"./ProTable.1672389691407.js";import{P as h}from"./index.16723896914072.js";import{l as f,m as x}from"./order.1672389691407.js";import{g as y,E as g}from"./index.1672389691407.js";import{aI as I}from"./header.1672389691407.js";import{E as T}from"./index.16723896914076.js";import v from"./socialConductDialog.1672389691407.js";import{c as b}from"./socialHandlePermission.16723896914072.js";import{o as j,a as C}from"./events.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./vuedraggable.umd.1672389691407.js";import"./index.16723896914077.js";import"./excel.1672389691407.js";const S={"class":"cardinal-config-container"},W=e({name:"社保办理"}),Y=Object.assign(W,{setup(e){const W=t(null),Y=t(null),D=t(null),_=r(),E=c(),{proxy:k}=u(),w=()=>{W.value&&W.value.refresh()},H=async(e,t)=>{if("handle"===e)_.push({name:"socialfund-social-conduct",params:{id:t.id}})},M=t(!1),P=a({searchConfig:{labelWidth:120},columns:[{dataIndex:"type",title:"派单类型",minWidth:180,tag:{0:{type:"success"},1:{type:"danger"}},fixed:"left"},{dataIndex:"applyNo",title:"申请编码",minWidth:220,tooltip:!0,hideInSearch:!0},{dataIndex:"empName",title:"员工姓名",minWidth:180,ellipsis:!0},{dataIndex:"empIdcard",title:"身份证号",minWidth:220,tooltip:!0},{dataIndex:"empType",title:"员工类型",hideInSearch:!0,minWidth:180},{dataIndex:"belongUnitName",title:"客户名称",hideInSearch:!0,minWidth:180,tooltip:!0},{dataIndex:"settleDomainName",title:"项目名称",minWidth:180,tooltip:!0},{dataIndex:"settleDomainCode",title:"项目编码",minWidth:180},{dataIndex:"socialHouseholdName",title:"社保户",minWidth:200,valueType:"PageSelect",request:async e=>{try{e=Object.assign({},{type:0},e);const t=await b(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records};g.error(t.msg)}catch(t){}return{current:1,total:0,data:[]}},pageProps:{valueKey:"name",title:"name",search:"name",parmas:{type:0}},tooltip:!0},{dataIndex:"socialAddress",title:"社保缴纳地",minWidth:180,valueType:"addRess",tooltip:!0,params:{pro:"socialProvince",city:"socialCity",town:"socialTown"}},{dataIndex:"socialHandleStatus",title:"办理状态",hideInTable:!0,minWidth:160},{dataIndex:"leaveDate",title:"离职日期",hideInSearch:!0,minWidth:180,dateFormat:"YYYY-MM-DD"},{dataIndex:"dispatchItem",title:"派单项",hideInSearch:!0,minWidth:180,multiple:!0,tooltip:!0},{dataIndex:"createName",title:"申请人",minWidth:180,multiple:!0},{dataIndex:"organName",title:"申请人所在部门",minWidth:180,hideInSearch:!0,multiple:!0,tooltip:!0},{dataIndex:"createTime",title:"申请时间",minWidth:160,valueType:"dateTimeRange",searchIndex:"createTime",startTime:"createTimeStart",endTime:"createTimeEnd",valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD",selectType:"daterange"},{dataIndex:"socialHandleStatus",title:"办理状态",hideInSearch:!0,minWidth:160},{dataIndex:"auditUserName",title:"审核人",minWidth:180},{dataIndex:"auditTime",title:"审核时间",valueType:"dateTimeRange",searchIndex:"startEndTime",startTime:"auditTimeStart",endTime:"auditTimeEnd",minWidth:160,valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD",selectType:"daterange"},{dataIndex:"option",title:"操作",key:"option",width:120,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],params:{},btn:[{label:"批量办理",onClick:()=>{if(!P.selectionChangeList||0===P.selectionChangeList.length)return void g.error("请先选择待办理的派单信息");const e=P.selectionChangeList,t=e[0].type;e.length>1&&e.find((e=>e.type!=t))?g.error("请选择全为派增或派减的数据!"):D.value&&D.value.openDialog(e,t)},disabled:()=>!P.selectionChangeList||0===P.selectionChangeList.length,permission:["wxhr:tdispatchinfo_batch_handle"],icon:"icon-ic_edit_add"},{label:"导出花名册",onClick:()=>{let e=Object.assign({},W.value.getParams(),P.params);delete e.size,delete e.current,delete e.createTime,delete e.startEndTime,M.value=!0;const t=P.selectionChangeList.map((e=>e.id)),a=t&&t.length?t.join(","):null;x({mId:e.menuInfo},{...e,idStr:a}).then((e=>{}))["finally"]((e=>{M.value=!1}))},loading:M,type:"default",permission:["wxhr:tdispatchinfo_doexportSocialRecordRoster"],icon:"icon-ic_edit_export"}],cellBtns:[{text:"办理",prop:"handle",permission:["wxhr:tdispatchinfo_handle"]}],dictKeys:["emp_natrue","send_order_type","social-conduct-status","fund-conduct-status","dispatch-audit-status"],DICTS:{},selectionChangeList:[]}),R=e=>{P.selectionChangeList=e};i((()=>{j(k)})),n((()=>{C(k,E.path,(()=>{w()})),L()}));const L=async()=>{if(P.dictKeys&&P.dictKeys.length){const e=await y(P.dictKeys);e&&(P.DICTS=e,P.columns=P.columns.map((t=>{const a={...t};switch(t.dataIndex){case"empType":a.valueEnum=e.emp_natrue;break;case"type":a.valueEnum=e.send_order_type;break;case"socialHandleStatus":t.hideInTable?a.valueEnum={0:"待办理",4:"办理中"}:a.valueEnum=e["social-conduct-status"];break;case"fundHandleStatus":a.valueEnum=e["fund-conduct-status"];break;case"status":a.valueEnum=e["dispatch-audit-status"]}return a})))}},N=async e=>{try{e.createTime&&(e.createTime=null);const t=await f(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records}}catch(t){}return{current:1,total:0,data:[]}};return(e,t)=>(m(),s("div",S,[d(p,{ref_key:"proTableRef",ref:W,"row-key":"id",columns:P.columns,request:N,btn:P.btn,searchConfig:P.searchConfig,onSelectionChange:R,multi:""},{option:o((e=>[d(h,{array:P.cellBtns,model:e,onOnClick:H},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),d(T,{ref_key:"exportExcelRef",ref:Y,heads:l(I),title:"导出花名册"},null,8,["heads"]),d(v,{ref_key:"socialConductDialogRef",ref:D,onOk:w},null,512)]))}});export{Y as default};