import"./index.16723896914073.js";import{s as e,_ as l,l as t,E as a}from"./index.1672389691407.js";import{d as n,f as u,$ as o,k as d,c as r,W as i,P as s,a3 as m,o as p,a as c,U as f,V as g,F as h,a5 as F,O as I,u as _,ay as D,az as v}from"./vue.1672389691407.js";const b=e=>(D("data-v-415af558"),e=e(),v(),e),N={"class":"downshift-archives-dialog"},w=b((()=>c("div",{"class":"line",style:{"margin-bottom":"16px"}},"划转前",-1))),y=b((()=>c("div",{"class":"line",style:{"margin-bottom":"40px"}},"划转后",-1))),S={"class":"tips"},V=b((()=>c("span",{style:{"vertical-align":"text-bottom"}},"已产生未结算的费用如要划转，请至EKP系统进行调整。",-1))),k={"class":"dialog-footer"},x=f("取 消"),U=f("确 定"),L=n({name:"changeSubjectDialog"});var C=l(Object.assign(L,{emits:["ok"],setup(l,{expose:n,emit:D}){const v=u(null);u(null);const b=o({isShowDialog:!1,loading:!1,leaveReasonDataSource:{},ruleForm:{empName:null,empIdcard:null,oldDept:null,oldSettle:null,newDept:null,unitId:null,unitNo:null,newSettle:null,deptId:null,deptNo:null,unsettleDeal:"0",changeStartMonth:null},allDeptList:[],allUintList:[]}),L=d((()=>null!==b.ruleForm.unitId&&void 0!==b.ruleForm.unitId?b.allDeptList.filter((e=>e.customerName==b.ruleForm.newDept)):[])),C=o({unitId:[{required:!0,message:"请选择单位名称",trigger:"change"}],deptId:[{required:!0,message:"请选择项目名称",trigger:"change"}]}),j=()=>{v.value&&(setTimeout((()=>{v.value.clearValidate()}),10),b.ruleForm={empName:null,empIdcard:null,oldDept:null,oldSettle:null,newDept:null,unitId:null,unitNo:null,newSettle:null,deptId:null,deptNo:null,unsettleDeal:"0",changeStartMonth:null}),b.isShowDialog=!1},z=e=>{b.ruleForm.deptId=null;const l=(b.allUintList||[]).find((l=>l.id===e));b.ruleForm.deptId=null,b.ruleForm.newDept=l.customerName,b.ruleForm.unitId=l.id,b.ruleForm.unitNo=l.customerCode},A=e=>{const l=(b.allDeptList||[]).find((l=>l.id===e));b.ruleForm.newSettle=l.departName,b.ruleForm.deptId=l.id,b.ruleForm.deptNo=l.departNo},M=()=>{v.value&&v.value.validate((l=>{l&&(b.loading=!0,b.ruleForm.unsettleDeal="0",async function(l){return e({url:"/yifu-archives/method/tempchangeinfo/empProArcChange",method:"post",data:l})}(b.ruleForm).then((e=>{200===e.code?(a.success("划转成功！"),D("ok"),j()):a.error(e.msg)}))["finally"]((()=>{b.loading=!1})))}))};return n({openDialog:async l=>{b.ruleForm={empName:l.empName,empIdcard:l.empIdcard,oldDept:l.unitName,oldSettle:l.deptName,newDept:null,unitId:null,unitNo:null,newSettle:null,deptId:null,deptNo:null,unsettleDeal:"0",changeStartMonth:null},b.isShowDialog=!0,async function(){return e({url:"/yifu-archives/method/tempchangeinfo/getAllDept",method:"get"})}().then((e=>{200===e.code&&(b.allDeptList=e.data)})),async function(){return e({url:"/yifu-archives/method/tempchangeinfo/getAllUint",method:"get"})}().then((e=>{200===e.code&&(b.allUintList=e.data)}))}}),(e,l)=>{const a=m("el-col"),n=m("el-form-item"),u=m("el-option"),o=m("el-select"),d=m("el-icon"),D=m("el-row"),P=m("el-form"),q=m("el-button"),E=m("el-dialog");return p(),r("div",N,[i(E,{title:"员工档案划转",modelValue:b.isShowDialog,"onUpdate:modelValue":l[2]||(l[2]=e=>b.isShowDialog=e),"close-on-click-modal":!1,width:"816px",onClose:j},{footer:s((()=>[c("span",k,[i(q,{onClick:j,size:"default"},{"default":s((()=>[x])),_:1}),i(q,{type:"primary",onClick:M,loading:b.loading,size:"default"},{"default":s((()=>[U])),_:1},8,["loading"])])])),"default":s((()=>[i(P,{ref_key:"formRef",ref:v,model:b.ruleForm,rules:C,size:"default","label-width":"135px"},{"default":s((()=>[i(D,null,{"default":s((()=>[i(a,{span:24},{"default":s((()=>[w])),_:1}),i(a,{span:12},{"default":s((()=>[i(n,{label:"姓 名"},{"default":s((()=>[f(g(b.ruleForm.empName),1)])),_:1})])),_:1}),i(a,{span:12},{"default":s((()=>[i(n,{label:"身份证号"},{"default":s((()=>[f(g(b.ruleForm.empIdcard),1)])),_:1})])),_:1}),i(a,{span:12},{"default":s((()=>[i(n,{label:"原单位名称"},{"default":s((()=>[f(g(b.ruleForm.oldDept),1)])),_:1})])),_:1}),i(a,{span:12},{"default":s((()=>[i(n,{label:"原项目名称"},{"default":s((()=>[f(g(b.ruleForm.oldSettle),1)])),_:1})])),_:1}),i(a,{span:24},{"default":s((()=>[y])),_:1}),i(a,{span:12},{"default":s((()=>[i(n,{label:"单位名称",prop:"unitId"},{"default":s((()=>[i(o,{placeholder:"请选择",modelValue:b.ruleForm.unitId,"onUpdate:modelValue":l[0]||(l[0]=e=>b.ruleForm.unitId=e),style:{width:"100%"},filterable:"",onChange:z},{"default":s((()=>[(p(!0),r(h,null,F(b.allUintList,(e=>(p(),I(u,{key:e.id,value:e.id,label:e.customerName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(a,{span:12},{"default":s((()=>[i(n,{label:"项目名称",prop:"deptId"},{"default":s((()=>[i(o,{placeholder:"请选择",modelValue:b.ruleForm.deptId,"onUpdate:modelValue":l[1]||(l[1]=e=>b.ruleForm.deptId=e),style:{width:"100%"},disabled:!b.ruleForm.unitId,filterable:"",onChange:A},{"default":s((()=>[(p(!0),r(h,null,F(_(L),(e=>(p(),I(u,{key:e.id,value:String(e.id),label:e.departName},null,8,["value","label"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),i(a,{span:24},{"default":s((()=>[c("div",S,[i(d,null,{"default":s((()=>[i(_(t))])),_:1}),V])])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-415af558"]]);export{C as default};