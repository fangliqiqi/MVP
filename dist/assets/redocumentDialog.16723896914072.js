import{r as e}from"./staff.1672389691407.js";import{k as a}from"./subject.1672389691407.js";import{_ as s,e as t,E as o}from"./index.1672389691407.js";import{P as l}from"./ProTable.1672389691407.js";import{d as i,f as n,$ as r,c as d,W as c,P as u,n as m,a3 as f,o as p,a as h,F as g,a5 as y,O as C,V as k,u as w,ay as j,az as v,U as _}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";const b=e=>(j("data-v-6594f670"),e=e(),v(),e),x={"class":"redocument-dialog"},I=["innerHTML"],D={"class":"info-value"},L=b((()=>h("span",null,"请选择复职项目",-1))),S=b((()=>h("div",null,"暂无数据",-1))),T={"class":"dialog-footer"},V=_("取 消"),N=_("确 定"),W=i({name:"redocument"});var $=s(Object.assign(W,{emits:["ok"],setup(s,{expose:i,emit:j}){const v=n(null),_=n(null),b=r({isShowDialog:!1,ruleForm:{},info:null,DICTS:{},dictKeys:["downshift_reason"],header:[{key:"empCode",label:"员工主码"},{key:"empName",label:"员工姓名"},{key:"empIdcard",label:"身份证号"}],searchConfig:{pagination:!1},selectionChangeList:[]}),W=e=>{b.selectionChangeList=e},$=r([{dataIndex:"unitName",title:"客户名称",minWidth:160,ellipsis:!0},{dataIndex:"deptNo",title:"项目编码",minWidth:140},{dataIndex:"deptName",title:"项目名称",minWidth:160,ellipsis:!0}]),z=async e=>{try{const e=await a({empId:b.info.id});if(e&&200==e.code&&e.data){const a=e.data||[];return{current:1,total:a.length,data:a}}}catch(s){}return{current:1,total:0,data:[]}},F=()=>{_.value&&_.value.clearValidate(),b.isShowDialog=!1},H=async()=>{const a={id:b.info.id};if(b.selectionChangeList&&b.selectionChangeList.length){const e=b.selectionChangeList.reduce(((e,a)=>e?`${e},${a.id}`:`${a.id}`),"");a.projectIds=e}try{const s=await e(a);s&&200===s.code?(o.success("项目复档成功"),j("ok"),F()):o.error(s.msg||"项目复档失败")}catch(s){o.error("项目复档失败")}};return i({openDialog:async e=>{b.info=e,b.ruleForm={id:e.id},b.isShowDialog=!0,m((()=>{v.value&&v.value.refresh()}))}}),(e,a)=>{const s=f("el-col"),o=f("el-row"),i=f("el-button"),n=f("el-dialog");return p(),d("div",x,[c(n,{title:"复档",modelValue:b.isShowDialog,"onUpdate:modelValue":a[0]||(a[0]=e=>b.isShowDialog=e),"close-on-click-modal":!1,width:"816px",onClose:F},{footer:u((()=>[h("span",T,[c(i,{onClick:F,size:"default"},{"default":u((()=>[V])),_:1}),c(i,{type:"primary",onClick:H,size:"default"},{"default":u((()=>[N])),_:1})])])),"default":u((()=>[c(o,null,{"default":u((()=>[(p(!0),d(g,null,y(b.header,(e=>(p(),C(s,{key:e.key,span:8,"class":"info"},{"default":u((()=>[h("span",{"class":"info-label",innerHTML:e.label},null,8,I),h("span",D,k(b.info&&b.info[e.key]||w(t)),1)])),_:2},1024)))),128))])),_:1}),c(l,{ref_key:"proRef",ref:v,"row-key":"id",columns:$,request:z,multi:!0,showHeader:!1,customEmpty:"",manualRequest:"",searchConfig:b.searchConfig,onSelectionChange:W},{protableTitle:u((()=>[L])),empty:u((()=>[S])),_:1},8,["columns","searchConfig"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-6594f670"]]);export{$ as default};