import{B as e}from"./index.16723896914077.js";import{g as a,E as l}from"./index.1672389691407.js";import{b as r}from"./order.1672389691407.js";import{a3 as o}from"./header.1672389691407.js";import{d as t,f as s,$ as d,k as u,j as i,c as m,W as n,P as c,u as p,a3 as g,o as h,a as f,O as y,T as k,F as b,a5 as F,U as S,V as _}from"./vue.1672389691407.js";import"./xlsx.1672389691407.js";import"./excel.1672389691407.js";import"./index.16723896914073.js";const V=S("办理成功"),T=S("办理失败"),v=S("全选"),x={"class":"dialog-footer"},j=S("取 消"),w=S("确 定"),D=f("div",null,[
f("div",{style:{color:"red","font-size":"24px","text-align":"center",margin:"10px 0 25px"}},"社保批量办理失败！"),
f("span",null,[
S("存在社保办理失败的派单信息！"),
f("br"),
S("已为您下载反馈结果！")])],-1),C=t({name:"socialConductDialog"}),R=Object.assign(C,{emits:["ok"],setup(t,{expose:C,emit:R}){const q=s(null),I=s(null),U=(e,a)=>a.map(((e,a)=>({line:e.lineNum||a,isError:"red"==e.color?"是":"否",error:e.message}))),A=d({isShowDialog:!1,type:null,ruleForm:{ids:null,handleStatus:"1",typeSub:"0"},options:{1:"养老",2:"医疗",3:"失业",4:"工伤",5:"生育",6:"大病"},data:null,dictKeys:["social-conduct-add-reason"],DICTS:{},loading:!1,checkAll:!1,isIndeterminate:!1}),O=u((()=>"1"==A.ruleForm.handleStatus?{handleStatus:[{required:!0,message:"请选择办理结果"}],socialType:[{required:!0,message:"请选择办理事项"}]}:"999"==A.ruleForm.remark?{handleStatus:[{required:!0,message:"请选择办理结果"}],socialType:[{required:!0,message:"请选择办理事项"}],remark:[{required:!0,message:"请选择失败类型"}],auditRemark:[{required:!0,message:"请选择办理意见"}]}:"2"==A.ruleForm.handleStatus?{handleStatus:[{required:!0,message:"请选择办理结果"}],socialType:[{required:!0,message:"请选择办理事项"}],remark:[{required:!0,message:"请选择失败类型"}]}:void 0)),z=e=>{A.checkAll=e,A.ruleForm.socialType=e?Object.keys(A.options):[],A.isIndeterminate=!1},E=()=>{A.isIndeterminate=A.ruleForm.socialType.length>0&&A.ruleForm.socialType.length<Object.keys(A.options).length,A.checkAll=A.ruleForm.socialType.length===Object.keys(A.options).length},K=()=>{q.value&&q.value.validate((e=>{if(e){A.loading=!0;const e=A.data.map((e=>e.id));let a=A.ruleForm.auditRemark?A.ruleForm.remark+"-"+A.ruleForm.auditRemark:A.ruleForm.remark;const o={typeSub:"0",handleStatus:A.ruleForm.handleStatus,handleRemark:"1"==A.ruleForm.handleStatus?A.ruleForm.auditRemark:a,remark:A.ruleForm.remark,socialType:A.ruleForm.socialType.join(",")};r(o,e).then((e=>{!e||200!=e.code||e.data&&0!==e.data.length?e.data?I.value&&I.value.openErrorDialog(e.data):l.error(e.msg||"批量办理失败"):(l.success("批量办理成功"),R("ok"))}),(e=>{l.error(e&&e.msg||"批量办理失败")}))["finally"]((e=>{A.loading=!1,N()}))}}))},H=e=>{A.loading?l.error("正在请求中，请勿关闭！！！"):(e(),q.value&&q.value.clearValidate(),A.isShowDialog=!1,A.loading=!1,A.ruleForm={})},N=()=>{A.loading?l.error("正在请求中，请勿关闭！！！"):(q.value&&q.value.clearValidate(),A.isShowDialog=!1,A.loading=!1,A.ruleForm={})};i((()=>{B()}));const B=async()=>{if(A.dictKeys&&A.dictKeys.length){const e=await a(A.dictKeys);e&&(A.DICTS=e)}};return C({openDialog:async(e,a)=>{A.data=e,A.type=a,1==a?A.ruleForm={socialType:["1","2","3","4","5","6"],handleStatus:"1",typeSub:"0"}:(A.ruleForm={handleStatus:"1",socialType:["1","2","3","4","5","6"],typeSub:"0"},A.checkAll=!0),A.DICTS&&Object.keys(A.DICTS).length||B(),A.isShowDialog=!0,setTimeout((()=>{q.value&&q.value.clearValidate()}),100)}}),(a,l)=>{const r=g("el-radio"),t=g("el-radio-group"),s=g("el-form-item"),d=g("el-checkbox"),u=g("el-checkbox-group"),i=g("el-col"),C=g("el-option"),R=g("el-select"),B=g("el-input"),L=g("el-row"),P=g("el-form"),W=g("el-button"),$=g("el-dialog");return h(),m("div",null,[n($,{title:"社保批量办理",modelValue:A.isShowDialog,"onUpdate:modelValue":l[5]||(l[5]=e=>A.isShowDialog=e),width:"600px",onClose:N,"before-close":H,"close-on-click-modal":!1},{footer:c((()=>[f("span",x,[n(W,{onClick:N,size:"default"},{"default":c((()=>[j])),_:1}),n(W,{type:"primary",onClick:K,size:"default",loading:A.loading},{"default":c((()=>[w])),_:1},8,["loading"])])])),"default":c((()=>[n(P,{ref_key:"formRef",ref:q,model:A.ruleForm,rules:p(O),size:"default","label-width":"90px","validate-on-rule-change":!1},{"default":c((()=>[n(L,null,{"default":c((()=>[n(i,{"class":"mb20"},{"default":c((()=>[n(s,{label:"办理结果",prop:"handleStatus"},{"default":c((()=>[n(t,{modelValue:A.ruleForm.handleStatus,"onUpdate:modelValue":l[0]||(l[0]=e=>A.ruleForm.handleStatus=e)},{"default":c((()=>[n(r,{label:"1"},{"default":c((()=>[V])),_:1}),n(r,{label:"2"},{"default":c((()=>[T])),_:1})])),_:1},8,["modelValue"])])),_:1}),n(s,{label:"办理事项",prop:"socialType"},{"default":c((()=>[0==A.type?(h(),y(d,{key:0,modelValue:A.checkAll,"onUpdate:modelValue":l[1]||(l[1]=e=>A.checkAll=e),indeterminate:A.isIndeterminate,onChange:z,style:{"margin-right":"30px"}},{"default":c((()=>[v])),_:1},8,["modelValue","indeterminate"])):k("",!0),n(u,{modelValue:A.ruleForm.socialType,"onUpdate:modelValue":l[2]||(l[2]=e=>A.ruleForm.socialType=e),disabled:1==A.type,onChange:E},{"default":c((()=>[(h(!0),m(b,null,F(A.options,((e,a)=>(h(),y(d,{key:a,label:a},{"default":c((()=>[S(_(e),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),2==A.ruleForm.handleStatus?(h(),y(i,{key:0,"class":"mb20"},{"default":c((()=>[n(s,{label:"失败类型",prop:"remark"},{"default":c((()=>[n(R,{modelValue:A.ruleForm.remark,"onUpdate:modelValue":l[3]||(l[3]=e=>A.ruleForm.remark=e),style:{width:"100%"}},{"default":c((()=>[(h(!0),m(b,null,F(A.DICTS["social-conduct-add-reason"],((e,a)=>(h(),y(C,{label:e,key:a,value:e},{"default":c((()=>[S(_(e),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})):k("",!0),n(i,{"class":"mb20"},{"default":c((()=>[n(s,{label:"办理意见",prop:"auditRemark"},{"default":c((()=>[n(B,{modelValue:A.ruleForm.auditRemark,"onUpdate:modelValue":l[4]||(l[4]=e=>A.ruleForm.auditRemark=e),placeholder:"请输入",rows:3,type:"textarea",clearable:"",maxLength:150,"show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"]),n(e,{title:"社保批量办理",ref_key:"bathHandleRef",ref:I,type:1,errName:"社保批量办理",batchName:"staff-batch-audit",errorHeader:p(o),errorData:U,customErrorContent:"",download:""},{error:c((()=>[D])),_:1},8,["errorHeader"])])}}});export{R as default};