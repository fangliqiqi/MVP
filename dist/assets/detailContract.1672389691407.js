import{d as a,f as e,$ as t,k as l,j as s,c as o,a as c,W as r,P as i,O as n,ay as u,az as p,aA as d,aD as m,a3 as b,o as f,F as v,a5 as y,U as _,V as h,u as k,T as D,i as Y}from"./vue.1672389691407.js";import{_ as g,E as j,g as N,c as S,P as A,h as w,e as L}from"./index.1672389691407.js";import{c as M,r as T}from"./contract.1672389691407.js";import{E as x}from"./index.16723896914074.js";import{g as C}from"./file.1672389691407.js";const I=a=>(u("data-v-8abdc018"),a=a(),p(),a),U={"class":"edit-staff-page"},q={"class":"content"},P={"class":"contract_left"},E=I((()=>c("div",{"class":"title"},[
c("span",null,"当前合同")],-1))),z={"class":"tooltip"},K={key:1},O=["href"],R={key:2},$=I((()=>c("div",{"class":"line"},null,-1))),B={"class":"check_right"},F=I((()=>c("div",{"class":"title"},[
c("span",null,"审核记录")],-1))),H={"class":"check_content"},V={"class":"remark"},W={"class":"remark"},G={"class":"operation-container"},J=_("关 闭"),Q=a({name:"editStaffPage"});var X=g(Object.assign(Q,{setup(a){const u=d(),p=m(),{proxy:g}=Y(),I=e(null),Q=t({formData:{},span:8,formArr:[{label:"合同编码",value:"contractNo",span:24},{label:"员工姓名",value:"empName"},{label:"项目名称",value:"subjectDepart",tooltip:!0},{label:"员工类型",value:"empNatrue",dict:"emp_natrue"},{label:"签订类型",value:"situation"},{label:"合同类型",value:"contractName"},{label:"业务细分",value:"contractSubName"},{label:"审核类型",value:"type",dict:"check_type"},{label:"原因说明",value:"reason",span:24,tooltip:!0},{label:"客户名称",value:"subjectUnit",tooltip:!0},{label:"合同甲方",value:"contractParty",tooltip:!0},{label:"签订期限",value:"contractType",dict:"employee_contract_type",tooltip:!0},{label:"起始日期",value:"contractStart",date:"YYYY-MM-DD"},{label:"截止日期",value:"contractEnd",date:"YYYY-MM-DD"},{label:"合同年限",value:"contractTerm"},{label:"合同岗位",value:"post",tooltip:!0},{label:"工时制",value:"workingHours",dict:"working_hours"},{label:"档案柜号",value:"fileCabinetNo",tooltip:!0},{label:"合同状态",value:"inUse",dict:"contract_status"},{label:"备注",value:"remark",span:24,tooltip:!0},{label:"附件",value:"attaList",file:!0,span:24}],formAbolish:[{label:"合同编码",value:"contractNo",span:24},{label:"员工姓名",value:"empName"},{label:"项目名称",value:"subjectDepart",tooltip:!0},{label:"员工类型",value:"empNatrue",dict:"emp_natrue"},{label:"签订类型",value:"situation"},{label:"合同类型",value:"contractName"},{label:"业务细分",value:"contractSubName"},{label:"审核类型",value:"type",dict:"check_type"},{label:"客户名称",value:"subjectUnit",tooltip:!0},{label:"合同甲方",value:"contractParty",tooltip:!0},{label:"签订期限",value:"contractType",dict:"employee_contract_type",tooltip:!0},{label:"起始日期",value:"contractStart",date:"YYYY-MM-DD"},{label:"截止日期",value:"contractEnd",date:"YYYY-MM-DD"},{label:"合同状态",value:"inUse",dict:"contract_status"},{label:"原因说明",value:"reason",span:24,tooltip:!0}],DICTS:[],dictKeys:["emp_natrue","working_hours","employee_contract_type","contract_status","check_type"],fileList:[],checkList:[],isAbolish:!1}),X=a=>{if(a.dict){const e=Q.DICTS[a.dict];if(e)return e[Q.formData[a.value]]}else{if(a.date)return Q.formData[a.value]?w(Q.formData[a.value]).format(a.date):"--";a.file?Q.formData[a.value]=L:Q.formData[a.value]=Q.formData[a.value]||L}return Q.formData[a.value]},Z=l((()=>{if(Q.formData&&"终止"==Q.formData.situation){const a=[{label:"离职日期",value:"leaveDate",date:"YYYY-MM-DD"},{label:"终止原因",value:"reduceReason",tooltip:!0}];return[...Q.formAbolish.slice(0,5),...a,...Q.formAbolish.slice(5,16)]}return Q.isAbolish?Q.formAbolish:Q.formArr})),aa=()=>{switch(u.name){case"contract-detail":p.push({path:"/contract/contractApply",query:{}});break;case"contractSearch-detail":p.push({path:"/contract/contractSearch",query:{}});break;case"onlineContract-detail":p.push({name:"online-detail",params:{id:Q.formData.empId}});break;case"subjectContract-detail":p.push({name:"subject-detail",params:{id:u.query.projectId}})}S(u,g)};return s((async()=>{(async()=>{try{const a=await N(Q.dictKeys);a&&(Q.DICTS=a)}catch(a){}})(),u.query.id?await(async a=>{try{const e=await M(a);200==e.code?(Q.formData=e.data,"作废"==e.data.situation||"终止"==e.data.situation?Q.isAbolish=!0:Q.isAbolish=!1):j.error(e.msg||"获取合同申请详情失败");const t=await C(a);t&&200==t.code?Q.fileList=t.data.map((a=>(a.name=a.attaName,a.uid=a.id,a.url=a.attaUrl,a))):(Q.fileList=[],j.error(e.msg||"获取合同申请附件失败"));const l=await T({linkId:a,linkType:1});l&&200==l.code?Q.checkList=l.data:(Q.checkList=[],j.error(e.msg||"获取合同申请审核记录失败"))}catch(e){}})(u.query.id):(j.error("不合法的路由地址"),aa())})),(a,e)=>{const t=b("el-tooltip"),l=b("el-form-item"),s=b("el-col"),u=b("el-row"),p=b("el-form"),d=b("el-timeline-item"),m=b("el-timeline"),Y=b("el-button");return f(),o("div",U,[c("div",q,[c("div",P,[r(p,{ref_key:"formRef",ref:I,size:"default","label-width":"110px"},{"default":i((()=>[E,r(u,{style:{"margin-top":"24px"}},{"default":i((()=>[(f(!0),o(v,null,y(k(Z),((a,e)=>(f(),n(s,{span:a.span||Q.span,key:e},{"default":i((()=>[r(l,{label:a.label},{"default":i((()=>[a.tooltip?(f(),n(t,{key:0,placement:"top","popper-class":`tooltip_${a.span||6}`},{content:i((()=>[_(h(X(a)),1)])),"default":i((()=>[c("span",z,h(X(a)),1)])),_:2},1032,["popper-class"])):a.file&&Q.fileList.length>0?(f(),o("div",K,[(f(!0),o(v,null,y(Q.fileList,(a=>(f(),o("a",{href:a.url,key:a.uid,target:"_blank",style:{display:"block"}},h(a.name),9,O)))),128))])):(f(),o("span",R,h(X(a)),1))])),_:2},1032,["label"])])),_:2},1032,["span"])))),128))])),_:1})])),_:1},512)]),$,c("div",B,[F,Q.checkList.length>0?(f(),n(m,{key:0,style:{padding:"20px"}},{"default":i((()=>[(f(!0),o(v,null,y(Q.checkList,((a,e)=>(f(),n(d,{key:e,color:"#58BD7D",size:"large",icon:k(A)},{"default":i((()=>[c("div",H,[c("p",null,h(a.rootName),1),r(l,{label:"操作人："},{"default":i((()=>[_(h(a.createName),1)])),_:2},1024),r(l,{label:"操作时间："},{"default":i((()=>[_(h(a.createTime),1)])),_:2},1024),a.auditStatus?(f(),n(l,{key:0,label:"审核意见："},{"default":i((()=>[r(t,{placement:"top","popper-class":"tooltip_6"},{content:i((()=>[_(h(a.auditStatus),1)])),"default":i((()=>[c("span",V,h(a.auditStatus),1)])),_:2},1024)])),_:2},1024)):D("",!0),a.remark?(f(),n(l,{key:1,label:"备注：","class":"remark_100"},{"default":i((()=>[r(t,{placement:"top","popper-class":"tooltip_6"},{content:i((()=>[_(h(a.remark),1)])),"default":i((()=>[c("span",W,h(a.remark),1)])),_:2},1024)])),_:2},1024)):D("",!0)])])),_:2},1032,["icon"])))),128))])),_:1})):(f(),n(x,{key:1}))])]),c("div",G,[r(Y,{onClick:aa,style:{height:"100%"}},{"default":i((()=>[J])),_:1})])])}}}),[["__scopeId","data-v-8abdc018"]]);export{X as default};