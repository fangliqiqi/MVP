import{d as a,f as e,k as t,$ as r,a2 as n,j as s,c as o,W as i,P as l,u as d,aD as c,aA as m,a3 as h,o as p,O as y}from"./vue.1672389691407.js";import{P as u}from"./ProTable.1672389691407.js";import{P as f}from"./index.16723896914072.js";import x from"./configPayProject.1672389691407.js";import{aj as I}from"./header.1672389691407.js";import{_ as M,h as Y,E as b,g}from"./index.1672389691407.js";import{k,l as S}from"./paysearch.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./vuedraggable.umd.1672389691407.js";const v={"class":"system-dict-container"},j=a({name:"员工报账查询"});var W=M(Object.assign(j,{setup(a){const M=e(null),j=e(null),W=c();m();const _=e(!1),P=a=>{},T=t((()=>{let a=[];for(let e=(new Date).getFullYear();e>=2010;e--)a.push({text:e+"年",value:[e+"01",e+"12"]});return a})),C=()=>{R.params.salaryMonth=[Y().format("YYYYMM"),Y().format("YYYYMM")]},O=a=>{R.selectOptions=a},R=r({searchConfig:{labelWidth:110,option:{extBtn:"extBtns"}},columns:[{dataIndex:"empName",title:"员工姓名",minWidth:160},{dataIndex:"empIdcard",title:"身份证号",minWidth:200},{dataIndex:"empPhone",title:"手机号码",minWidth:160,hideInSearch:!0},{dataIndex:"bankNo",title:"银行卡号",minWidth:200,hideInSearch:!0,tooltip:!0},{dataIndex:"bankName",title:"开户行总行",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"bankProvince",title:"开户行省",hideInSearch:!0,minWidth:150,valueType:"addRess",params:{pro:"bankProvince"}},{dataIndex:"bankCity",title:"开户行市",hideInSearch:!0,minWidth:140,valueType:"addRess",params:{city:"bankCity"}},{dataIndex:"bankSubName",title:"开户行支行",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"salaryMonth",title:"薪酬月份",hideInTable:!0,valueType:"custom",scopedSlots:{customRender:"salaryMonth"}},{dataIndex:"formType",title:"表单类型",hideInSearch:!0,minWidth:160},{dataIndex:"salaryMonth",title:"薪酬月份",hideInSearch:!0,minWidth:160},{dataIndex:"relaySalary",title:"应发薪酬",hideInSearch:!0,minWidth:160,formatter:a=>"3"==a.formType?a.relaySalaryUnit:a.relaySalary},{dataIndex:"salaryTax",title:"个税金额",hideInSearch:!0,minWidth:160,formatter:a=>Number(a.salaryTax)+Number(a.salaryTaxUnit)},{dataIndex:"option",title:"操作",key:"option",minWidth:140,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"批量导出",permission:["salary_tsalaryaccount-export"],onClick:()=>{_.value=!0;let a=Object.assign({},M.value.getParams());delete a.size,delete a.current;const e={...a,salaryMonthStart:R.params.salaryMonth[0],salaryMonthEnd:R.params.salaryMonth[1],exportFields:I.map((a=>a.dataIndex))},t=R.selectOptions.map((a=>a.id));t&&t.length&&(e.idList=t),k(e).then((a=>{200==a.code?b.success("导出成功"):b.error(a.msg||"导出失败")}))["catch"]((a=>{b.error(a.msg||"导出失败")}))["finally"]((()=>{_.value=!1}))},loading:_,icon:"icon-ic_edit_export"}],cellBtns:[{text:"详情",prop:"detail",permission:[]}],selectOptions:[],params:{salaryMonth:[Y().format("YYYYMM"),Y().format("YYYYMM")]},clearArr:!1,dictKeys:["form_type"]}),{columns:N,cellBtns:w,btn:B,searchConfig:E}=n(R),F=async a=>{try{const e={...a,salaryMonthStart:R.params.salaryMonth[0],salaryMonthEnd:R.params.salaryMonth[1]},t=await S(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records.map(((e,t)=>({...e,index:(a.current-1)*a.size+t+1})))}}catch(e){}return{current:1,total:0,data:[]}},U=()=>{M.value.refresh()},V=async(a,e)=>{"detail"===a&&W.push({name:"payservice-bill-detail",params:{id:e.salaryFormId,dataId:e.id}})};return s((()=>{(async()=>{try{const a=await g(R.dictKeys);a&&R.columns.map((e=>("formType"===e.dataIndex&&(e.valueEnum=a.form_type),e)))}catch(a){}})()})),(a,e)=>{const t=h("el-date-picker");return p(),o("div",v,[i(u,{ref_key:"proTableRef",ref:M,"row-key":"id",columns:d(N),request:F,btn:d(B),searchConfig:d(E),multi:!0,onSelectionChange:O,onOnReset:C},{salaryMonth:l((a=>[(p(),y(t,{modelValue:R.params.salaryMonth,"onUpdate:modelValue":e[0]||(e[0]=a=>R.params.salaryMonth=a),type:"monthrange",key:"arch_search_props_"+a.dateIndex+"_oIndex","start-placeholder":"开始月份","end-placeholder":"结束月份","value-format":"YYYYMM",format:"YYYYMM",style:{width:"100%"},onChange:P,"popper-class":"month-picker","unlink-panels":!0,clearable:!1,shortcuts:d(T)},null,8,["modelValue","shortcuts"]))])),option:l((a=>[i(f,{array:d(w),model:a,onOnClick:V},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),i(x,{ref_key:"configPayProjectRef",ref:j,onOk:U},null,512)])}}}),[["__scopeId","data-v-3f4820fa"]]);export{W as default};