import{d as e,f as t,$ as s,c as a,W as o,P as n,ax as i,o as l,a as r,V as c}from"./vue.1672389691407.js";import{P as d}from"./ProTable.1672389691407.js";import{P as m}from"./index.16723896914072.js";import u from"./addSocialHandlePermission.1672389691407.js";import{x as p}from"./header.1672389691407.js";import{e as h}from"./excel.1672389691407.js";import{h as f,E as g,a as y}from"./index.1672389691407.js";import{g as x,a as b,d as j,b as v}from"./socialHandlePermission.16723896914072.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./contractPermission.16723896914072.js";const C={"class":"cardinal-config-container"},T=e({name:"社保办理权限"}),P=Object.assign(T,{setup(e){const T=t(null);i();const P=t(null),_=()=>{T.value&&T.value.onSearch()},k=t(!1),H=s({searchConfig:{labelWidth:120},columns:[{dataIndex:"userName",title:"办理人",minWidth:200,tooltip:!0},{dataIndex:"userDeptName",title:"办理人所在部门",minWidth:180,tooltip:!0},{dataIndex:"socialHousehold",title:"社保户",minWidth:200,tooltip:!0,hideInTable:!1},{dataIndex:"status",title:"授权状态",minWidth:120,tooltip:!1,valueEnum:{0:"启用",1:"禁用"}},{dataIndex:"option",title:"操作",key:"option",width:200,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],params:{},btn:[{label:"新增",onClick:()=>{P.value&&P.value.openDialog()},permission:["social_tsocialfundhouseres_add"],icon:"icon-ic_edit_add"},{label:"批量导出",onClick:()=>{k.value=!0;let e=null;e=0!=H.selectionChangeList.length?Object.assign({},{houseNameType:0},H.params):Object.assign({},{houseNameType:0},H.params,T.value.getParams()),delete e.size,delete e.current,b(e).then((e=>{h(p,(e.data||[]).map((e=>(e.status=0==e.status?"启用":"禁用",e.houseNameType=0==e.houseNameType?"社保户":"公积金户",e))),`社保办理权限批量导出${f().format("YYYYMMDD-HHmmss")}`),g.success("导出成功")}))["finally"]((e=>{k.value=!1}))},loading:k,permission:[],type:"normal",icon:"icon-ic_edit_export"}],cellBtns:[{text:"删除",prop:"delete",permission:["social_tsocialfundhouseres_del"]},{text:"启用",prop:"enable",permission:[],isGray:e=>0==e.status},{text:"禁用",prop:"stop",permission:[],isGray:e=>1==e.status}],selectionChangeList:[],statusRes:0}),N=e=>{H.selectionChangeList=e;let t=null;if(H.selectionChangeList.length>0){const e=[];H.selectionChangeList.map((t=>{e.push(t.id)})),t={idList:e,...T.value.getParams()}}else t={...T.value.getParams()};H.params=t},w=async(e,t)=>{switch(e){case"delete":I(t);break;case"enable":t.status=0,S(t);break;case"stop":t.status=1,S(t)}},S=e=>{j(e).then((t=>{t&&200==t.code?(_(),g.success(t.msg||(0==e.status?"启用":"禁用")+"成功")):g.error(t.msg||(0==e.status?"启用":"禁用")+"失败")}),(e=>{}))["finally"]((()=>{H.loading=!1}))},I=e=>{y.confirm('<p style="font-size:16px;font-weight:600">是否确定删除?<br/>\n\t\t\t\t<span style="color:red;font-size:14px;font-weight:400">删除后，配置将从系统消失，请谨慎操作！</span></p>',{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((async()=>{try{const t=await v(e.id);t&&200===t.code?(g.success("删除成功"),_(),T.value.clearAllSelection()):g.error(t.msg||"删除失败")}catch(t){g.error(t&&t.msg||"删除失败")}}))["catch"]((()=>{}))},L=async e=>{try{e=Object.assign({},{houseNameType:0,authType:1},e);const t=await x(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records}}catch(t){}return{current:1,total:0,data:[]}};return(e,t)=>(l(),a("div",C,[o(d,{ref_key:"proTableRef",ref:T,"row-key":"id",columns:H.columns,request:L,btn:H.btn,searchConfig:H.searchConfig,onSelectionChange:N,multi:""},{houresName:n((e=>[r("span",null,c(1==e.houseNameType?e.fundHousehold:e.socialHousehold),1)])),option:n((e=>[o(m,{array:H.cellBtns,model:e,onOnClick:w},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),o(u,{ref_key:"addSocialHandlePermissionRef",ref:P,onOk:_},null,512)]))}});export{P as default};