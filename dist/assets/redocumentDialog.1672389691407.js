import{r as e}from"./staff.1672389691407.js";import{k as a}from"./subject.1672389691407.js";import{_ as o,e as s,E as l}from"./index.1672389691407.js";import{P as i}from"./ProTable.1672389691407.js";import{d as t,f as n,$ as d,c as r,W as c,P as u,n as m,a3 as f,o as p,a as g,F as h,a5 as y,O as C,V as k,u as w,ay as j,az as v,U as _}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";const b=e=>(j("data-v-28ce1de8"),e=e(),v(),e),x={"class":"redocument-dialog"},I=["innerHTML"],D={"class":"info-value"},L=b((()=>g("span",null,"请选择复职项目",-1))),S=b((()=>g("div",null,"暂无数据",-1))),T={"class":"dialog-footer"},V=_("取 消"),F=_("确 定"),N=t({name:"redocument"});var W=o(Object.assign(N,{emits:["ok"],setup(o,{expose:t,emit:j}){const v=n(null),_=n(null),b=d({isShowDialog:!1,loading:!1,ruleForm:{},info:null,DICTS:{},dictKeys:["downshift_reason"],header:[{key:"empCode",label:"员工主码"},{key:"empName",label:"员工姓名"},{key:"empIdcard",label:"身份证号"}],searchConfig:{pagination:!1},selectionChangeList:[]}),N=e=>{b.selectionChangeList=e},W=d([{dataIndex:"unitName",title:"客户名称",minWidth:160,ellipsis:!0},{dataIndex:"deptNo",title:"项目编码",minWidth:140},{dataIndex:"deptName",title:"项目名称",minWidth:160,ellipsis:!0}]),$=async e=>{try{const e=await a({empId:b.info.id});if(e&&200==e.code&&e.data){const a=e.data||[];return{current:1,total:a.length,data:a}}}catch(o){}return{current:1,total:0,data:[]}},z=()=>{b.ruleForm={},_.value&&_.value.clearValidate(),b.isShowDialog=!1,b.loading=!1},H=async()=>{const a={id:b.info.id};if(b.selectionChangeList&&b.selectionChangeList.length){const e=b.selectionChangeList.reduce(((e,a)=>e?`${e},${a.id}`:`${a.id}`),"");a.projectIds=e}try{b.loading=!0;const o=await e(a);o&&200===o.code?(l.success("项目复档成功"),j("ok"),z()):(l.error(o.msg||"项目复档失败"),b.loading=!1)}catch(o){l.error("项目复档失败"),b.loading=!1}};return t({openDialog:async e=>{b.info=e,b.ruleForm={id:e.id},b.isShowDialog=!0,m((()=>{v.value&&v.value.refresh()}))}}),(e,a)=>{const o=f("el-col"),l=f("el-row"),t=f("el-button"),n=f("el-dialog");return p(),r("div",x,[c(n,{title:"复档",modelValue:b.isShowDialog,"onUpdate:modelValue":a[0]||(a[0]=e=>b.isShowDialog=e),"close-on-click-modal":!1,width:"816px",onClose:z},{footer:u((()=>[g("span",T,[c(t,{onClick:z,size:"default"},{"default":u((()=>[V])),_:1}),c(t,{type:"primary",onClick:H,size:"default",loading:b.loading},{"default":u((()=>[F])),_:1},8,["loading"])])])),"default":u((()=>[c(l,null,{"default":u((()=>[(p(!0),r(h,null,y(b.header,(e=>(p(),C(o,{key:e.key,span:8,"class":"info"},{"default":u((()=>[g("span",{"class":"info-label",innerHTML:e.label},null,8,I),g("span",D,k(b.info&&b.info[e.key]||w(s)),1)])),_:2},1024)))),128))])),_:1}),c(i,{ref_key:"proRef",ref:v,"row-key":"id",columns:W,request:$,multi:!0,showHeader:!1,customEmpty:"",manualRequest:"",searchConfig:b.searchConfig,onSelectionChange:N},{protableTitle:u((()=>[L])),empty:u((()=>[S])),_:1},8,["columns","searchConfig"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-28ce1de8"]]);export{W as default};