import{P as e}from"./ProTable.1672389691407.js";import{P as a}from"./index.16723896914072.js";import{f as t,$ as n,j as i,E as r,a2 as s,c as o,W as l,P as d,aD as m,aA as c,a3 as p,o as u,V as h,T as g,i as T}from"./vue.1672389691407.js";import{o as y,a as f}from"./events.1672389691407.js";import{a as I,b as x}from"./index.167238969140714.js";import{z as F}from"./header.1672389691407.js";import{e as b}from"./excel.1672389691407.js";import{_ as k,E as v,h as j}from"./index.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";const S={"class":"archives-withdrawn-container"},C={key:0},W={key:1},P={key:2},N={key:3},O={key:0},_={key:1};var q=k({name:"项目管理",components:{ProTable:e,ProButtons:a},setup(){const e=m(),a=c(),o=t(null),{proxy:l}=T(),d=()=>{o.value&&o.value.refresh()},p=t(!1),u=async e=>{try{const a=Object.assign({},{deleteFlag:0},e),t=await I(a);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records};v.error(t.msg)}catch(a){}return{current:1,total:0,data:[]}},h=n({selectionChangeList:[],searchConfig:{labelWidth:112},columns:[{dataIndex:"departName",title:"项目名称",minWidth:200,valueType:"PageSelect",request:u,pageProps:{valueKey:"departName",title:"departName",search:"departName"},tooltip:!0},{dataIndex:"departNo",title:"项目编码",minWidth:140,ellipsis:!0},{dataIndex:"customerName",title:"客户名称",minWidth:160,tooltip:!0,hideInSearch:!0},{dataIndex:"customerNo",title:"客户编码",minWidth:140,tooltip:!0,hideInSearch:!0},{dataIndex:"bpoFlag",title:"是否为BPO项目",minWidth:160,hideInSearch:!0},{dataIndex:"mrSettleType",title:"结算方式",minWidth:110,valueEnum:{1:"预估",2:"实缴"},hideInSearch:!0},{dataIndex:"收入组成",title:"收入组成",multiple:!0,hideInTable:!0,hideInSearch:!0,valueEnum:{0:"管理费",1:"风险金"}},{dataIndex:"incomeForm",title:"收入组成",hideInSearch:!0,minWidth:180,valueType:"custom",scopedSlots:{customRender:"incommMain"}},{dataIndex:"stopFlag",title:"是否可用",minWidth:180,valueEnum:{0:"是",1:"否"},scopedSlots:{customRender:"stopFlag"}},{dataIndex:"invoiceTitleInsurance",title:"商险封面抬头",minWidth:180,multiple:!0,hideInTable:!0,hideInSearch:!0},{dataIndex:"invoiceTitleSalary",title:"薪资封面抬头",minWidth:180,multiple:!0,hideInTable:!0,hideInSearch:!0},{dataIndex:"option",title:"操作",key:"option",width:120,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"批量导出",onClick:()=>{let e=Object.assign({},h.params,o.value.getParams());delete e.size,delete e.current,p.value=!0,x(Object.assign({},e,{deleteFlag:0})).then((e=>{b(F,(e.data||[]).map((e=>(e.mrSettleType=1==e.mrSettleType?"预估":"实缴",e.stopFlag=0==e.stopFlag?"是":"否",0==e.managementTag&&0==e.riskFundTag?e.incomeForm="管理费、风险金":0==e.managementTag?e.incomeForm="管理费":0==e.riskFundTag?e.incomeForm="风险金":0!=e.managementTag&&0!=e.riskFundTag&&(e.incomeForm="-"),e))),`项目信息批量导出${j().format("YYYYMMDD-HHmmss")}`),v.success("导出成功")}))["finally"]((e=>{p.value=!1}))},loading:p,permission:["employee_export_employee_leave"],icon:"icon-ic_edit_export"}],cellBtns:[{text:"查看",prop:"detail",permission:["hro:archives-online-detail"]}],params:{}});return i((()=>{f(l,a.path,(()=>{d()}))})),r((()=>{y(l)})),{...s(h),request:async e=>{try{const a=Object.assign({},{deleteFlag:0},e),t=await I(a);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records}}catch(a){}return{current:1,total:0,data:[]}},onCellClick:async(a,t)=>{"detail"==a&&e.push({name:"projectmanage-detail",params:{id:t.id}})},proTableRef:o,refreshList:d,requestProName:u}}},[["render",function(e,a,t,n,i,r){const s=p("pro-buttons"),m=p("pro-table");return u(),o("div",S,[l(m,{ref:"proTableRef","row-key":"id",columns:e.columns,request:n.request,btn:e.btn,multi:!1,searchConfig:e.searchConfig},{option:d((a=>[l(s,{array:e.cellBtns,model:a,onOnClick:n.onCellClick},null,8,["array","model","onOnClick"])])),incommMain:d((e=>[0==e.managementTag?(u(),o("span",C,h(0==e.managementTag?"管理费":""),1)):g("",!0),0==e.managementTag&&0==e.riskFundTag?(u(),o("span",W,"、")):g("",!0),0==e.riskFundTag?(u(),o("span",P,h(0==e.riskFundTag?"风险金":""),1)):g("",!0),1==e.riskFundTag&&1==e.managementTag?(u(),o("span",N,"--")):g("",!0)])),stopFlag:d((e=>[0==e.stopFlag?(u(),o("span",O,"是")):g("",!0),1==e.stopFlag||2==e.stopFlag?(u(),o("span",_,"否")):g("",!0)])),_:1},8,["columns","request","btn","searchConfig"])])}]]);export{q as default};