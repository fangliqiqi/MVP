import{d as e,f as t,$ as a,E as i,j as n,c as d,W as s,P as r,u as o,aD as l,aA as c,o as m,i as u}from"./vue.1672389691407.js";import{P as p}from"./ProTable.1672389691407.js";import{P as h}from"./index.16723896914072.js";import{d as f,e as g}from"./order.1672389691407.js";import{g as x,E as y}from"./index.1672389691407.js";import{aD as I}from"./header.1672389691407.js";import{E as T}from"./index.16723896914076.js";import v from"./fundConductDialog.1672389691407.js";import{o as C,a as j}from"./events.1672389691407.js";import{c as b}from"./socialHandlePermission.16723896914072.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./vuedraggable.umd.1672389691407.js";import"./index.16723896914077.js";import"./excel.1672389691407.js";const D={"class":"cardinal-config-container"},Y=e({name:"公积金办理"}),_=Object.assign(Y,{setup(e){const Y=t(null),_=t(null),W=t(null),S=l(),k=c(),{proxy:E}=u(),w=()=>{Y.value&&Y.value.refresh()},M=async(e,t)=>{if("handle"===e)S.push({name:"socialfund-fund-conduct",params:{id:t.id}})},H=t(!1),P=a({searchConfig:{labelWidth:120},columns:[{dataIndex:"type",title:"派单类型",minWidth:180,tag:{0:{type:"success"},1:{type:"danger"}},fixed:"left"},{dataIndex:"applyNo",title:"申请编码",minWidth:220,tooltip:!0,hideInSearch:!0},{dataIndex:"empName",title:"员工姓名",minWidth:180,ellipsis:!0},{dataIndex:"empIdcard",title:"身份证号",minWidth:220,tooltip:!0},{dataIndex:"empType",title:"员工类型",hideInSearch:!0,minWidth:180},{dataIndex:"belongUnitName",title:"客户名称",hideInSearch:!0,minWidth:180,tooltip:!0},{dataIndex:"settleDomainName",title:"项目名称",minWidth:180,tooltip:!0},{dataIndex:"settleDomainCode",title:"项目编码",minWidth:180},{dataIndex:"providentHouseholdName",title:"公积金户",minWidth:200,valueType:"PageSelect",request:async e=>{try{e=Object.assign({},{type:0},e);const t=await b(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records};y.error(t.msg)}catch(t){}return{current:1,total:0,data:[]}},pageProps:{valueKey:"name",title:"name",search:"name",parmas:{type:1}},tooltip:!0},{dataIndex:"fundAddress",title:"公积金缴纳地",tooltip:!0,minWidth:180,valueType:"addRess",params:{pro:"fundProvince",city:"fundCity",town:"fundTown"}},{dataIndex:"leaveDate",title:"离职日期",hideInSearch:!0,minWidth:180,dateFormat:"YYYY-MM-DD"},{dataIndex:"createName",title:"申请人",minWidth:180,multiple:!0},{dataIndex:"organName",title:"申请人所在部门",minWidth:180,hideInSearch:!0,multiple:!0,tooltip:!0},{dataIndex:"createTime",title:"申请时间",valueType:"dateTimeRange",searchIndex:"createTime",startTime:"createTimeStart",endTime:"createTimeEnd",minWidth:160,valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD",selectType:"daterange"},{dataIndex:"fundHandleStatus",title:"办理状态",hideInSearch:!0,minWidth:160},{dataIndex:"auditUserName",title:"审核人",minWidth:180},{dataIndex:"auditTime",title:"审核时间",valueType:"dateTimeRange",searchIndex:"startEndTime",startTime:"auditTimeStart",endTime:"auditTimeEnd",minWidth:160,valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD",selectType:"daterange"},{dataIndex:"option",title:"操作",key:"option",width:120,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],params:{},btn:[{label:"批量办理",onClick:()=>{P.selectionChangeList&&0!==P.selectionChangeList.length?W.value&&W.value.openDialog(P.selectionChangeList):y.error("请先选择待审核的派单信息")},permission:["wxhr:tdispatchinfo_fund_batch_handle"],disabled:()=>!P.selectionChangeList||0===P.selectionChangeList.length,icon:"icon-ic_edit_add"},{label:"导出变更清册",onClick:()=>{let e=Object.assign({},Y.value.getParams(),P.params);delete e.size,delete e.current,delete e.createTime,delete e.startEndTime,H.value=!0;const t=P.selectionChangeList.map((e=>e.id)),a=t&&t.length?t.join(","):null,i={...e,idStr:a};g({},i).then((e=>{}))["finally"]((e=>{H.value=!1}))},loading:H,type:"default",permission:["wxhr:tdispatchinfo_doexportFundRecordChange"],icon:"icon-ic_edit_export"}],cellBtns:[{text:"办理",prop:"handle",permission:["wxhr:tdispatchinfo_fund_handle"]}],dictKeys:["emp_natrue","send_order_type","social-conduct-status","fund-conduct-status","dispatch-audit-status"],DICTS:{},selectionChangeList:[]}),L=e=>{P.selectionChangeList=e};i((()=>{C(E)})),n((()=>{j(E,k.path,(()=>{w()})),N()}));const N=async()=>{if(P.dictKeys&&P.dictKeys.length){const e=await x(P.dictKeys);e&&(P.DICTS=e,P.columns=P.columns.map((t=>{const a={...t};switch(t.dataIndex){case"empType":a.valueEnum=e.emp_natrue;break;case"type":a.valueEnum=e.send_order_type;break;case"socialHandleStatus":a.valueEnum=e["social-conduct-status"];break;case"fundHandleStatus":a.valueEnum=e["fund-conduct-status"];break;case"status":a.valueEnum=e["dispatch-audit-status"]}return a})))}},R=async e=>{try{e.createTime&&(e.createTime=null);const t=await f(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records}}catch(t){}return{current:1,total:0,data:[]}};return(e,t)=>(m(),d("div",D,[s(p,{ref_key:"proTableRef",ref:Y,"row-key":"id",columns:P.columns,request:R,btn:P.btn,searchConfig:P.searchConfig,onSelectionChange:L,multi:""},{option:r((e=>[s(h,{array:P.cellBtns,model:e,onOnClick:M},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),s(v,{ref_key:"fundConductDialogRef",ref:W,onOk:w},null,512),s(T,{ref_key:"exportExcelRef",ref:_,heads:o(I),title:"导出变更清册"},null,8,["heads"])]))}});export{_ as default};