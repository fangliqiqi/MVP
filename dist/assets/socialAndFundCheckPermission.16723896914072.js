import{d as e,f as t,$ as s,c as a,W as o,P as n,ax as i,o as l,a as r,V as d}from"./vue.1672389691407.js";import{P as c}from"./ProTable.1672389691407.js";import{P as u}from"./index.16723896914072.js";import m from"./addSocialAndFundCheckPermission.1672389691407.js";import{w as p}from"./header.1672389691407.js";import{e as h}from"./excel.1672389691407.js";import{h as f,E as g,a as y}from"./index.1672389691407.js";import{g as x,a as b,d as v,b as C}from"./socialAndFundCheckPermission.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./contractPermission.16723896914072.js";const T={"class":"cardinal-config-container"},j=r("div",{"class":"tipsText"},"社保、公积金同时派单时，以社保审核人为准，公积金审核人无待审核任务；仅单独派公积金时，流转到公积金审核人处",-1),k=e({name:"社保公积金审核权限"}),I=Object.assign(k,{setup(e){const k=t(null);i();const I=t(null),H=()=>{k.value&&k.value.onSearch()},P=t(!1),S=s({searchConfig:{labelWidth:120,option:{extBtn:"extBtns"}},columns:[{dataIndex:"userName",title:"审核人",minWidth:200,tooltip:!0},{dataIndex:"userDeptName",title:"审核人所在部门",minWidth:180,tooltip:!0},{dataIndex:"socialHousehold",title:"社保户",minWidth:200,tooltip:!0,hideInTable:!0},{dataIndex:"fundHousehold",title:"公积金户",minWidth:200,tooltip:!0,hideInTable:!0},{dataIndex:"houseNameType",title:"户类型",minWidth:120,tooltip:!1,hideInSearch:!0,valueEnum:{0:"社保户",1:"公积金户"}},{dataIndex:"socialAndFund",title:"户名",minWidth:200,tooltip:!0,hideInSearch:!0,valueType:"custom",scopedSlots:{customRender:"houresName"}},{dataIndex:"status",title:"授权状态",minWidth:120,tooltip:!1,valueEnum:{0:"启用",1:"禁用"}},{dataIndex:"option",title:"操作",key:"option",width:200,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],params:{},btn:[{label:"新增",onClick:()=>{I.value&&I.value.openDialog()},permission:["social_tsocialfundhouseres_add"],icon:"icon-ic_edit_add"},{label:"批量导出",onClick:()=>{P.value=!0;let e=null;e=0!=S.selectionChangeList.length?S.params:Object.assign({},S.params,k.value.getParams()),delete e.size,delete e.current,b(e).then((e=>{h(p,(e.data||[]).map((e=>(e.status=0==e.status?"启用":"禁用",e.socialAndFund=1==e.houseNameType?e.fundHousehold:e.socialHousehold,e.houseNameType=0==e.houseNameType?"社保户":"公积金户",e))),`社保公积金审核权限批量导出${f().format("YYYYMMDD-HHmmss")}`),g.success("导出成功")}))["finally"]((e=>{P.value=!1}))},loading:P,permission:[],type:"normal",icon:"icon-ic_edit_export"}],cellBtns:[{text:"删除",prop:"delete",permission:["social_tsocialfundhouseres_del"]},{text:"启用",prop:"enable",permission:[],isGray:e=>0==e.status},{text:"禁用",prop:"stop",permission:[],isGray:e=>1==e.status}],selectionChangeList:[],statusRes:0}),_=e=>{S.selectionChangeList=e;let t=null;if(S.selectionChangeList.length>0){const e=[];S.selectionChangeList.map((t=>{e.push(t.id)})),t={idList:e,...k.value.getParams()}}else t={...k.value.getParams()};S.params=t},N=async(e,t)=>{switch(e){case"delete":W(t);break;case"enable":t.status=0,w(t);break;case"stop":t.status=1,w(t)}},w=e=>{v(e).then((t=>{t&&200==t.code?(H(),g.success(t.msg||(0==e.status?"启用":"禁用")+"成功")):g.error(t.msg||(0==e.status?"启用":"禁用")+"失败")}),(e=>{}))["finally"]((()=>{S.loading=!1}))},W=e=>{y.confirm('<p style="font-size:16px;font-weight:600">是否确定删除?<br/>\n\t\t\t\t<span style="color:red;font-size:14px;font-weight:400">删除后，配置将从系统消失，请谨慎操作！</span></p>',{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((async()=>{try{const t=await C(e.id);t&&200===t.code?(g.success("删除成功"),H(),k.value.clearAllSelection()):g.error(t.msg||"删除失败")}catch(t){g.error(t&&t.msg||"删除失败")}}))["catch"]((()=>{}))},A=async e=>{try{e=Object.assign({},{authType:0},e);const t=await x(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records.map((e=>(e.socialAndFund=1==e.houseNameType?e.fundHousehold:e.socialHousehold,e)))}}catch(t){}return{current:1,total:0,data:[]}};return(e,t)=>(l(),a("div",T,[o(c,{ref_key:"proTableRef",ref:k,"row-key":"id",columns:S.columns,request:A,btn:S.btn,searchConfig:S.searchConfig,onSelectionChange:_,multi:""},{extBtns:n((()=>[j])),houresName:n((e=>[r("span",null,d(1==e.houseNameType?e.fundHousehold:e.socialHousehold),1)])),option:n((e=>[o(u,{array:S.cellBtns,model:e,onOnClick:N},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),o(m,{ref_key:"addSocialAndFundCheckPermissionRef",ref:I,onOk:H},null,512)]))}});export{I as default};