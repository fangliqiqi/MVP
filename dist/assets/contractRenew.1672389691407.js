import{P as e}from"./ProTable.1672389691407.js";import{P as t}from"./index.16723896914072.js";import{e as a}from"./excel.1672389691407.js";import{j as n}from"./header.1672389691407.js";import{_ as i,g as r,h as o,E as d}from"./index.1672389691407.js";import{g as c,i as s}from"./city.1672389691407.js";import{k as l,l as m}from"./contract.1672389691407.js";import{d as p,f as h,$ as u,a2 as f,j as y,c as I,W as x,P as g,u as _,aD as Y,o as T}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";const v={"class":"system-dict-container"},W=p({name:"续签待办"});var b=i(Object.assign(W,{setup(i){const p=h(null),W=Y(),b=u({searchConfig:{labelWidth:110,option:{extBtn:"extBtns"}},columns:[{dataIndex:"empCode",title:"员工编码",minWidth:180,hideInSearch:!0},{dataIndex:"empName",title:"员工姓名",minWidth:160},{dataIndex:"empIdcard",title:"身份证号",minWidth:200},{dataIndex:"contractStart",title:"合同起始日期",hideInSearch:!0,minWidth:160,dateFormat:"YYYY-MM-DD"},{dataIndex:"contractEnd",title:"合同截止日期",hideInSearch:!0,minWidth:160,dateFormat:"YYYY-MM-DD"},{dataIndex:"fileAddress",title:"档案所在地",minWidth:200,hideInSearch:!0,tooltip:!0,formatter:e=>s({province:e.fileProvince,city:e.fileCity,town:e.fileTown})},{dataIndex:"project",title:"项目名称",minWidth:200,tooltip:!0},{dataIndex:"projectNo",title:"项目编码",minWidth:160},{dataIndex:"empType",title:"员工类型",minWidth:160},{dataIndex:"contractType",title:"合同类型",minWidth:200},{dataIndex:"contractTerm",title:"签订期限",minWidth:200,hideInSearch:!0},{dataIndex:"archivesLocation",title:"档案所在地",minWidth:200,valueType:"addRess",hideInTable:!0,params:{pro:"fileProvince",city:"fileCity",town:"fileTown"}},{dataIndex:"daysDue",title:"距离到期天数",minWidth:180,tooltip:!0,hideInSearch:!0},{dataIndex:"dueFlag",title:"是否过期",minWidth:160,hideInSearch:!0},{dataIndex:"daysOver",title:"过期天数",minWidth:160,hideInSearch:!0},{dataIndex:"firstAlertTime",title:"首次提醒时间",hideInSearch:!0,minWidth:160,dateFormat:"YYYY-MM-DD"},{dataIndex:"alertPerson",title:"提醒人",minWidth:160},{dataIndex:"dueFlag",title:"是否过期",minWidth:160,hideInTable:!0},{dataIndex:"handleStatus",title:"处理状态",minWidth:160},{dataIndex:"option",title:"操作",key:"option",minWidth:140,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"批量导出",permission:["demo_tempcontractalert_export"],onClick:()=>{if(b.selectionChangeList.length>0){const e=[];b.selectionChangeList.map((t=>{e.push(t.id)})),b.params={ids:e.join(",")}}else b.params=p.value.getParams(),delete b.params.size,delete b.params.current;b.btn.find((e=>"批量导出"==e.label)).loading=!0,m(b.params).then((e=>{200==e.code?(a(n,e.data.map((e=>({empCode:e.empCode||"",empName:e.empName||"",empIdcard:e.empIdcard||"",contractStart:e.contractStart?o(e.contractStart).format("YYYY-MM-DD"):"",contractEnd:e.contractEnd?o(e.contractEnd).format("YYYY-MM-DD"):"",fileProvince:e.fileProvince?s({province:e.fileProvince},""):"",fileCity:e.fileCity?s({city:e.fileCity},""):"",fileTown:e.fileTown?s({town:e.fileTown},""):"",project:e.project||"",projectNo:e.projectNo||"",empType:b.dictValue.emp_natrue[e.empType]||"",contractType:e.contractType||"",contractTerm:b.dictValue.employee_contract_type[e.contractTerm]||"",daysDue:e.daysDue||"",dueFlag:b.dictValue.cintract_dueFlag[e.dueFlag]||"",daysOver:e.daysOver||"",firstAlertTime:e.firstAlertTime?o(e.firstAlertTime).format("YYYY-MM-DD"):"",alertPerson:e.alertPerson||""}))),`续签待办批量导出${o().format("YYYYMMDD")}`),d.success("导出成功")):d.error(e.msg)}))["catch"]((e=>{d.error("导出失败")}))["finally"]((()=>{b.btn.find((e=>"批量导出"==e.label)).loading=!1}))},icon:"icon-ic_edit_export",loading:!1}],cellBtns:[{text:"续签",prop:"sign",permission:["temployeecontractinfo_add"],isGray:e=>1==e.handleStatus,tooltip:"处理中状态不可操作"}],dictKeys:["emp_natrue","personnel_type","cintract_dueFlag","contract_handle_status","employee_contract_type"],dictValue:{},selectionChangeList:[],params:{},areaJson:null,areaProps:{label:"areaName",isLeaf:"isLeaf",children:"children"}}),{columns:j,cellBtns:C,btn:S,searchConfig:D,params:P,areaJson:M,areaProps:w}=f(b),k=e=>{b.selectionChangeList=e},F=async e=>{try{const t=Object.assign({},e,b.params);delete t.fileAddress;const a=await l(t);if(a&&200==a.code&&a.data)return{current:a.data.current,total:a.data.total,data:a.data.records.map(((t,a)=>({...t,index:(e.current-1)*e.size+a+1})))}}catch(t){}return{current:1,total:0,data:[]}},E=()=>{b.params={}},L=async(e,t)=>{"sign"===e&&W.push({name:"contract-renew",query:{id:t.contractId}})};return y((async()=>{(async()=>{try{const e=await r(b.dictKeys);b.dictValue=e,e&&b.columns.map((t=>{switch(t.dataIndex){case"empType":t.valueEnum=e.emp_natrue;break;case"contractType":const a=[];for(const t in e.personnel_type)a.push({key:e.personnel_type[t],value:e.personnel_type[t]});t.valueEnum=a;break;case"dueFlag":t.valueEnum=e.cintract_dueFlag;break;case"handleStatus":t.valueEnum=e.contract_handle_status;break;case"contractTerm":t.valueEnum=e.employee_contract_type}return t}))}catch(e){}})();const e=c();b.areaJson=e})),(a,n)=>(T(),I("div",v,[x(e,{ref_key:"proTableRef",ref:p,"row-key":"id",columns:_(j),request:F,btn:_(S),multi:!0,searchConfig:_(D),onSelectionChange:k,onOnReset:E},{option:g((e=>[x(t,{array:_(C),model:e,onOnClick:L},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"])]))}}),[["__scopeId","data-v-2c9dd98e"]]);export{b as default};