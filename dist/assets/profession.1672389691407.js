import{P as e}from"./ProTable.1672389691407.js";import{P as i}from"./index.16723896914072.js";import{B as a}from"./index.16723896914077.js";import{V as t,W as o}from"./header.1672389691407.js";import{e as n}from"./excel.1672389691407.js";import l from"./attachDetail.1672389691407.js";import s from"./addProfession.1672389691407.js";import{K as r,L as c,M as d,N as p,O as f}from"./attach.1672389691407.js";import{_ as m,M as h,N as u,E as y,f as g,h as b,a as I}from"./index.1672389691407.js";import{d as _,f as v,$ as q,a2 as x,j as T,c as k,W as L,P as C,u as j,a3 as W,o as w,a as N,U as O,V as S,ay as D,az as z}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./file.1672389691407.js";import"./staff.1672389691407.js";import"./attachUpload.1672389691407.js";const Y=e=>(D("data-v-25d5b596"),e=e(),z(),e),P={"class":"system-dict-container"},R={"class":"el-dropdown-link"},B=O(" 模板下载 "),U=Y((()=>N("a",{href:"/template/员工职业资格模板.xls",download:""}," 批量导入模板",-1))),M=_({name:"职业资格"});var $=m(Object.assign(M,{setup(m){const _=v(null),D=v(null),z=v(null),Y=v(null),M=e=>{$.selectOptions=e,e.length>0?$.btn[3].disabled=!1:$.btn[3].disabled=!0},$=q({searchConfig:{labelWidth:110,option:{extBtn:"extBtns"}},columns:[{dataIndex:"empName",title:"员工姓名",minWidth:180},{dataIndex:"empIdcard",title:"身份证号",minWidth:200},{dataIndex:"certificationNo",title:"证书编号",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"declareYear",title:"申报年度",hideInSearch:!0,minWidth:120,ellipsis:!0},{dataIndex:"assessmentUnit",title:"评定机构",hideInSearch:!0,minWidth:200,tooltip:!0},{dataIndex:"obtainType",title:"获取方式",hideInSearch:!0,minWidth:120,formatter:e=>h($.dictConfig.obtainTypeList,e.obtainType)||"--"},{dataIndex:"qualificationType",title:"资格类型",hideInSearch:!0,minWidth:200,ellipsis:!0,formatter:e=>h($.dictConfig.qualificationTypeList,e.qualificationType)||"--"},{dataIndex:"qualificationLevel",title:"资格等级",hideInSearch:!0,minWidth:120,formatter:e=>h($.dictConfig.qualificationLevelList,e.qualificationLevel)||"--"},{dataIndex:"heightIdentification",title:"是否最高资格",hideInSearch:!0,minWidth:120,scopedSlots:{customRender:"heightIdentification"}},{dataIndex:"createName",title:"创建人",minWidth:160},{dataIndex:"createTime",title:"创建时间",minWidth:180,searchIndex:"createTimes",valueType:"dateTimeRange"},{dataIndex:"option",title:"操作",key:"option",minWidth:200,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"新增",onClick:()=>{z.value.openDialog("",$.dictConfig)},permission:["archives_tempprofessionalqualification_add"],icon:"icon-ic_edit_add"},{label:"批量导入",permission:["archives-professionalqualification-batch-import"],onClick:()=>{Y.value&&Y.value.openDialog()},type:"normal",icon:"icon-ic_edit_upload"},{label:"批量导出",permission:["archives-professionalqualification-batch-export"],onClick:()=>{if($.selectOptions.length>0){const e=[];$.selectOptions.map((i=>{e.push(i.id)})),$.params={ids:e.join(",")}}else $.params=_.value.getParams(),delete $.params.size,delete $.params.current;$.btn.find((e=>"批量导出"==e.label)).loading=!0,c($.params).then((e=>{200==e.code?(n(o,e.data.map((e=>({empName:e.empName,empIdcard:e.empIdcard,certificationNo:e.certificationNo||"",declareYear:e.declareYear||"",assessmentUnit:e.assessmentUnit||"",obtainType:h($.dictConfig.obtainTypeList,e.obtainType)||"",qualificationType:h($.dictConfig.qualificationTypeList,e.qualificationType)||"",qualificationLevel:h($.dictConfig.qualificationLevelList,e.qualificationLevel)||"",heightIdentification:1==e.heightIdentification?"否":"是",remark:e.remark||""}))),`职业资格批量导出_${b().format("YYYYMMDD")}`),y.success("导出成功")):y.error(e.msg)}))["catch"]((e=>{y.error("导出失败")}))["finally"]((()=>{$.btn.find((e=>"批量导出"==e.label)).loading=!1}))},type:"normal",icon:"icon-ic_edit_export"},{label:"批量删除",permission:["archives_tempprofessionalqualification_del_batch"],onClick:()=>{$.selectOptions.length>0&&I.confirm(`是否确定删除${$.selectOptions.length}条职业资格？`,"提示",{type:"warning"}).then((()=>{const e=[];$.selectOptions.map((i=>{e.push(i.id)})),d(e).then((e=>{200==e.code&&e.data?(y.success("删除成功"),_.value.refresh()):y.error(e.msg||"删除失败")}))}))},type:"normal",icon:"icon-ic_edit_delete",disabled:!0}],cellBtns:[{text:"详情",prop:"detail",permission:["archives_tempprofessionalqualification_get"]},{text:"编辑",prop:"edit",permission:["archives_tempprofessionalqualification_edit"]},{text:"删除",prop:"delete",permission:["archives_tempprofessionalqualification_del"]}],detailConf:[{label:"员工姓名",key:"empName"},{label:"身份证号",key:"empIdcard"},{label:"证书编号",key:"certificationNo",tooltip:!0},{label:"申报年度",key:"declareYear"},{label:"评定机构",key:"assessmentUnit",tooltip:!0},{label:"获取方式",key:"obtainType"},{label:"资格类型",key:"qualificationType"},{label:"资格等级",key:"qualificationLevel"},{label:"是否最高资格",key:"heightIdentification",size:24},{label:"创建人",key:"createName"},{label:"创建时间",key:"createTime"},{label:"备注",key:"remark",tooltip:"true",size:24},{label:"附件内容",key:"",file:"true",size:24}],dictConfig:{obtainTypeList:[],qualificationTypeList:[],qualificationLevelList:[]},selectOptions:[],params:{}}),{columns:V,cellBtns:A,btn:E,searchConfig:K}=x($),F=async e=>{try{const i=await r(e);if(i&&200==i.code&&i.data)return{current:i.data.current,total:i.data.total,data:i.data.records.map(((i,a)=>({...i,index:(e.current-1)*e.size+a+1})))}}catch(i){}return{current:1,total:0,data:[]}},G=()=>{_.value.refresh()},H=async(e,i)=>{"delete"===e?I.confirm("是否确定删除？","提示",{type:"warning"}).then((async()=>{const e=await p(i.id);e&&200==e.code?(y.success("删除成功"),G()):y.error(e.msg||"删除失败")}))["catch"]((()=>{})):"edit"===e?z.value.openDialog(i,$.dictConfig):"detail"===e&&f(i.id).then((e=>{if(e&&200==e.code&&e.data){const a=e.data;a.obtainType=h($.dictConfig.obtainTypeList,i.obtainType)||"",a.qualificationType=h($.dictConfig.qualificationTypeList,i.qualificationType)||"",a.qualificationLevel=h($.dictConfig.qualificationLevelList,i.qualificationLevel)||"",a.heightIdentification=1==a.heightIdentification?"否":"是",D.value&&D.value.openDialog(a,$.detailConf,"职业资格详情",!0)}else y.error(e.msg||"获取职业资格详情失败")}))["catch"]((e=>{y.error("获取职业资格详情失败")}))};return T((()=>{u("obtain_type").then((e=>{e&&200==e.code&&e.data?$.dictConfig.obtainTypeList=e.data:y.error(e.msg||"获取资格获取方式字典失败")}))["catch"]((e=>{y.error(e.msg||"获取资格获取方式字典失败")})),u("qualification_type").then((e=>{e&&200==e.code&&e.data?$.dictConfig.qualificationTypeList=e.data:y.error(e.msg||"获取资格类型字典失败")}))["catch"]((e=>{y.error(e.msg||"获取资格类型字典失败")})),u("qualification_level").then((e=>{e&&200==e.code&&e.data?$.dictConfig.qualificationLevelList=e.data:y.error(e.msg||"获取资格证书字典失败")}))["catch"]((e=>{y.error(e.msg||"获取资格证书字典失败")}))})),(o,n)=>{const r=W("el-icon"),c=W("el-button"),d=W("el-dropdown-item"),p=W("el-dropdown-menu"),f=W("el-dropdown"),m=W("el-tag");return w(),k("div",P,[L(e,{ref_key:"proTableRef",ref:_,"row-key":"id",columns:j(V),request:F,btn:j(E),searchConfig:j(K),multi:!0,onSelectionChange:M},{extBtns:C((()=>[L(f,{"class":"arch-btn","popper-class":"module-download"},{dropdown:C((()=>[L(p,null,{"default":C((()=>[L(d,null,{"default":C((()=>[U])),_:1})])),_:1})])),"default":C((()=>[N("span",R,[L(c,{size:"default"},{"default":C((()=>[B,L(r,{"class":"el-icon--right"},{"default":C((()=>[L(j(g))])),_:1})])),_:1})])])),_:1})])),heightIdentification:C((e=>[L(m,{size:"small",type:1==e.heightIdentification?"info":""},{"default":C((()=>[O(S(1==e.heightIdentification?"否":"是"),1)])),_:2},1032,["type"])])),option:C((e=>[L(i,{array:j(A),model:e,onOnClick:H},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),L(l,{ref_key:"attachDetailRef",ref:D},null,512),L(s,{ref_key:"addProfessionRef",ref:z,onOk:G},null,512),L(a,{ref_key:"batchImportDialogRef",ref:Y,header:j(t),errName:"员工职业资格批量导入",download:!0,url:"/yifu-archives/method/tempprofessionalqualification/importListAdd",onOk:G},null,8,["header"])])}}}),[["__scopeId","data-v-25d5b596"]]);export{$ as default};