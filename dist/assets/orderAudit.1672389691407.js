import{d as e,f as t,$ as a,E as i,j as n,c as s,W as o,P as d,aD as r,aA as l,o as c,i as m}from"./vue.1672389691407.js";import{P as u}from"./ProTable.1672389691407.js";import{P as p}from"./index.16723896914072.js";import{j as h,k as y}from"./order.1672389691407.js";import{g as f,E as g}from"./index.1672389691407.js";import"./header.1672389691407.js";import"./index.16723896914076.js";import x from"./auditBatchDialog.1672389691407.js";import{o as I,a as v}from"./events.1672389691407.js";import{c as T}from"./socialHandlePermission.16723896914072.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./vuedraggable.umd.1672389691407.js";import"./index.16723896914077.js";import"./excel.1672389691407.js";const C={"class":"cardinal-config-container"},b=e({name:"派单审核"}),j=Object.assign(b,{setup(e){const b=t(null);t(null);const j=t(null),W=r(),S=l(),_=t(!1),{proxy:D}=m(),k=()=>{b.value&&b.value.refresh()},w=async(e,t)=>{if("audit"===e)W.push({name:"socialfund-order-audit",params:{id:t.id}})},P=async e=>{try{e=Object.assign({},{type:0},e);const t=await T(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records};g.error(t.msg)}catch(t){}return{current:1,total:0,data:[]}},Y=a({searchConfig:{labelWidth:120},columns:[{dataIndex:"type",title:"派单类型",minWidth:180,tag:{0:{type:"success"},1:{type:"danger"}},fixed:"left"},{dataIndex:"applyNo",title:"申请编码",minWidth:220,tooltip:!0,hideInSearch:!0},{dataIndex:"empName",title:"员工姓名",minWidth:180,ellipsis:!0},{dataIndex:"empIdcard",title:"身份证号",minWidth:220,tooltip:!0},{dataIndex:"empType",title:"员工类型",hideInSearch:!0,minWidth:180},{dataIndex:"belongUnitName",title:"客户名称",hideInSearch:!0,minWidth:180,tooltip:!0},{dataIndex:"settleDomainName",title:"项目名称",minWidth:180,tooltip:!0},{dataIndex:"settleDomainCode",title:"项目编码",minWidth:180},{dataIndex:"socialHouseholdName",title:"社保户",minWidth:200,valueType:"PageSelect",request:P,pageProps:{valueKey:"name",title:"name",search:"name",parmas:{type:0}},tooltip:!0},{dataIndex:"socialAddress",title:"社保缴纳地",hideInTable:!0,valueType:"addRess",params:{pro:"socialProvince",city:"socialCity",town:"socialTown"}},{dataIndex:"providentHouseholdName",title:"公积金户",minWidth:200,valueType:"PageSelect",request:P,pageProps:{valueKey:"name",title:"name",search:"name",parmas:{type:1}},tooltip:!0},{dataIndex:"funAddress",title:"公积金缴纳地",hideInTable:!0,valueType:"addRess",params:{pro:"fundProvince",city:"fundCity",town:"fundTown"}},{dataIndex:"leaveDate",title:"离职日期",hideInSearch:!0,minWidth:180,dateFormat:"YYYY-MM-DD"},{dataIndex:"dispatchItem",title:"派单项",hideInSearch:!0,minWidth:180,multiple:!0,tooltip:!0},{dataIndex:"createName",title:"申请人",minWidth:180,multiple:!0},{dataIndex:"organName",title:"申请人所在部门",minWidth:180,hideInSearch:!0,multiple:!0,tooltip:!0},{dataIndex:"createTime",title:"申请时间",minWidth:160,valueType:"dateTimeRange",searchIndex:"createTime",startTime:"createTimeStart",endTime:"createTimeEnd",valueFormat:"YYYY-MM-DD HH:mm:ss",format:"YYYY-MM-DD",selectType:"daterange"},{dataIndex:"option",title:"操作",key:"option",width:120,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],params:{},btn:[{label:"批量审核",onClick:()=>{Y.selectionChangeList&&0!==Y.selectionChangeList.length?j.value&&j.value.openDialog(Y.selectionChangeList):g.error("请先选择待审核的派单信息")},permission:["wxhr:tdispatchinfo_batch_audit"],disabled:()=>!Y.selectionChangeList||0===Y.selectionChangeList.length,icon:"icon-ic_edit_export"},{label:"批量导出",onClick:()=>{_.value=!0;let e=null;if(Y.selectionChangeList.length>0){const t=[];Y.selectionChangeList.map((e=>{t.push(e.id)})),e={idList:t}}else e={...b.value.getParams()},delete e.size,delete e.current,delete e.createTime;y({mId:e.menuInfo},e).then((e=>{200==e.code?g.success("导出成功"):g.error(e.msg||"导出失败")}))["catch"]((e=>{g.error(e.msg||"导出失败")}))["finally"]((()=>{_.value=!1}))},permission:["tdispatchinfo-export"],type:"normal",loading:_,icon:"icon-ic_edit_export"}],cellBtns:[{text:"审核",prop:"audit",permission:["wxhr:dispatch_auth"]}],dictKeys:["emp_natrue","send_order_type","social-conduct-status","fund-conduct-status","dispatch-audit-status"],DICTS:{},selectionChangeList:[]}),L=e=>{Y.selectionChangeList=e};i((()=>{I(D)})),n((()=>{v(D,S.path,(()=>{k()})),E()}));const E=async()=>{if(Y.dictKeys&&Y.dictKeys.length){const e=await f(Y.dictKeys);e&&(Y.DICTS=e,Y.columns=Y.columns.map((t=>{const a={...t};switch(t.dataIndex){case"empType":a.valueEnum=e.emp_natrue;break;case"type":a.valueEnum=e.send_order_type;break;case"socialHandleStatus":a.valueEnum=e["social-conduct-status"];break;case"fundHandleStatus":a.valueEnum=e["fund-conduct-status"];break;case"status":a.valueEnum=e["dispatch-audit-status"]}return a})))}},N=async e=>{try{e.createTime&&(e.createTime=null);const t=await h(e);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records}}catch(t){}return{current:1,total:0,data:[]}};return(e,t)=>(c(),s("div",C,[o(u,{ref_key:"proTableRef",ref:b,"row-key":"id",columns:Y.columns,request:N,btn:Y.btn,searchConfig:Y.searchConfig,onSelectionChange:L,multi:""},{option:d((e=>[o(p,{array:Y.cellBtns,model:e,onOnClick:w},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),o(x,{ref_key:"auditBatchDialogRef",ref:j,onOk:k},null,512)]))}});export{j as default};