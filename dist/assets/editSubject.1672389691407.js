import{d as e,f as l,$ as a,w as r,j as o,c as u,a as s,W as t,P as n,aA as d,aD as p,a3 as m,o as i,F as c,a5 as y,O as b,ay as f,az as _,U as F,i as h}from"./vue.1672389691407.js";import{_ as V,g,m as T,E as N,a as v,c as w}from"./index.1672389691407.js";import{g as I,a as k,u as j,b as S}from"./subject.1672389691407.js";import{e as D}from"./events.1672389691407.js";const C=e=>(f("data-v-e4a96616"),e=e(),_(),e),U={"class":"edit-staff-page"},P={"class":"content"},q=C((()=>s("div",{"class":"title"},[
s("span",null,"基础信息")],-1))),x=C((()=>s("div",{"class":"title"},[
s("span",null,"项目信息")],-1))),H={"class":"operation-container"},$=F("返 回"),M=F("保 存"),Y=e({name:"editSubject"});var z=V(Object.assign(Y,{setup(e){const{proxy:f}=h(),_=d(),F=p(),V=l(null),C=a({ruleForm:{empCode:null,empName:null,empIdcard:null,empNatrue:null,unitName:null,deptName:null,deptNo:null,businessTypeStr:null,businessPrimaryType:null,businessSecondType:null,businessThirdType:null,contractType:null,workingHours:null,post:null,enjoinDate:null,tryPeriod:null,bankName:null,bankSubName:null,bankNo:null},rules:{empNatrue:[{required:!0,message:"请选择员工类型"}],contractType:[{required:!0,message:"请选择合同类型"}],post:[{required:!0,message:"请输入就职岗位"}],workingHours:[],enjoinDate:[{required:!0,message:"请选择入职日期"}],tryPeriod:[{required:!0,message:"请选择入职日期"}]},span:6,loading:!1,DICTS:{},tryMonth:["一个月","两个月","三个月","四个月","五个月","六个月","七个月","八个月","九个月","十个月","十一个月","十二个月"]});r((e=>{2!=C.ruleForm.empNatrue&&1==C.ruleForm.contractType?C.rules.workingHours=[{required:!0,message:"请选择工时制"}]:(C.rules.workingHours=[],setTimeout((()=>{V.value.clearValidate(["workingHours"])}),30))}));const Y=e=>{C.rules.enjoinDate=[{required:2!=e,message:"请选择入职日期"}],C.rules.tryPeriod=[{required:2!=e,message:"请选择入职日期"}],V.value.clearValidate(["enjoinDate","tryPeriod"])};o((()=>{z(),"subject-edit"===_.name?(()=>{if(!_.params.id)return N.error("数据合法性校验不通过"),void O();k(_.params.id).then((e=>{var l,a,r;if(200===e.code){const o=e.data||{};C.ruleForm=o,C.ruleForm.businessTypeStr=`${null!=(l=C.ruleForm.businessPrimaryType)?l:"--"}/${null!=(a=C.ruleForm.businessSecondType)?a:"--"}/${null!=(r=C.ruleForm.businessThirdType)?r:"--"}`}else N.error(e.msg||"访问错误")}))})():(()=>{const e=_.query,l=T(e.empIdcard+e.empName+e.deptNo);if(e._t!==l)return N.error("数据合法性校验不通过"),void O();C.ruleForm.empName=e.empName,C.ruleForm.empIdcard=e.empIdcard,C.ruleForm.deptNo=e.deptNo,I({empIdcard:e.empIdcard,empNo:e.deptNo}).then((e=>{var l,a,r;200===e.code&&(C.ruleForm.empCode=e.data.empCode,C.ruleForm.unitName=e.data.customerName,C.ruleForm.deptName=e.data.itemInfo&&e.data.itemInfo.departName,C.ruleForm.businessPrimaryType=e.data.itemInfo&&e.data.itemInfo.businessPrimaryType,C.ruleForm.businessSecondType=e.data.itemInfo&&e.data.itemInfo.businessSecondType,C.ruleForm.businessThirdType=e.data.itemInfo&&e.data.itemInfo.businessThirdType,C.ruleForm.businessTypeStr=`${null!=(l=C.ruleForm.businessPrimaryType)?l:"--"}/${null!=(a=C.ruleForm.businessSecondType)?a:"--"}/${null!=(r=C.ruleForm.businessThirdType)?r:"--"}`)}))})()}));const z=async()=>{try{const e=await g(["emp_natrue","personnel_type","work_type","customer_business_parent","customer_business_type","customer_business_sub_type"]);e&&(C.DICTS=e)}catch(e){}},B=()=>{v.confirm("返回后，信息将不会保留，是否确定？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{O()}))["catch"]((()=>{}))},O=()=>{try{F.push({path:"/archives/subject",query:{}}),w(_,f),D(f,"/archives/subject")}catch(e){}},A=()=>{V.value&&V.value.validate((async e=>{if(e)if(C.loading=!0,C.ruleForm.id)try{const e=await j(C.ruleForm);e&&200===e.code?(N.success("项目档案编辑成功"),O()):(C.loading=!1,N.success(e.msg||"编辑失败"))}catch(l){N.error("编辑失败"),C.loading=!1}else try{const e=await S(C.ruleForm);e&&200===e.code?(N.success("项目档案添加成功"),O()):(C.loading=!1,N.success(e.msg||"新增失败"))}catch(l){N.error("新增失败"),C.loading=!1}}))};return(e,l)=>{const a=m("el-input"),r=m("el-form-item"),o=m("el-col"),d=m("el-row"),p=m("el-option"),f=m("el-select"),_=m("el-date-picker"),F=m("el-form"),h=m("el-button");return i(),u("div",U,[s("div",P,[t(F,{ref_key:"formRef",ref:V,model:C.ruleForm,rules:C.rules,size:"default","label-width":"110px","validate-on-rule-change":!1},{"default":n((()=>[q,t(d,{style:{"margin-top":"24px"}},{"default":n((()=>[t(o,{span:C.span},{"default":n((()=>[t(r,{label:"员工主码",prop:"empCode"},{"default":n((()=>[t(a,{modelValue:C.ruleForm.empCode,"onUpdate:modelValue":l[0]||(l[0]=e=>C.ruleForm.empCode=e),placeholder:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"姓名",prop:"empName"},{"default":n((()=>[t(a,{modelValue:C.ruleForm.empName,"onUpdate:modelValue":l[1]||(l[1]=e=>C.ruleForm.empName=e),placeholder:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"身份证号",prop:"empIdcard"},{"default":n((()=>[t(a,{modelValue:C.ruleForm.empIdcard,"onUpdate:modelValue":l[2]||(l[2]=e=>C.ruleForm.empIdcard=e),placeholder:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["span"])])),_:1}),x,t(d,{style:{"margin-top":"24px"}},{"default":n((()=>[t(o,{span:C.span},{"default":n((()=>[t(r,{label:"员工类型",prop:"empNatrue"},{"default":n((()=>[t(f,{modelValue:C.ruleForm.empNatrue,"onUpdate:modelValue":l[3]||(l[3]=e=>C.ruleForm.empNatrue=e),style:{width:"100%"},placeholder:"请选择",clearable:"",onChange:Y},{"default":n((()=>[(i(!0),u(c,null,y(C.DICTS.emp_natrue,((e,l)=>(i(),b(p,{key:l,value:l,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"客户名称",prop:"unitName"},{"default":n((()=>[t(a,{modelValue:C.ruleForm.unitName,"onUpdate:modelValue":l[4]||(l[4]=e=>C.ruleForm.unitName=e),placeholder:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"项目名称",prop:"deptName"},{"default":n((()=>[t(a,{modelValue:C.ruleForm.deptName,"onUpdate:modelValue":l[5]||(l[5]=e=>C.ruleForm.deptName=e),placeholder:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"项目编码",prop:"deptNo"},{"default":n((()=>[t(a,{modelValue:C.ruleForm.deptNo,"onUpdate:modelValue":l[6]||(l[6]=e=>C.ruleForm.deptNo=e),placeholder:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"业务类型",prop:"businessTypeStr"},{"default":n((()=>[t(a,{modelValue:C.ruleForm.businessTypeStr,"onUpdate:modelValue":l[7]||(l[7]=e=>C.ruleForm.businessTypeStr=e),placeholder:"",disabled:""},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"合同类型",prop:"contractType"},{"default":n((()=>[t(f,{modelValue:C.ruleForm.contractType,"onUpdate:modelValue":l[8]||(l[8]=e=>C.ruleForm.contractType=e),style:{width:"100%"},placeholder:"请选择",clearable:""},{"default":n((()=>[(i(!0),u(c,null,y(C.DICTS.personnel_type,((e,l)=>(i(),b(p,{key:l,value:l,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"工时制",prop:"workingHours"},{"default":n((()=>[t(f,{modelValue:C.ruleForm.workingHours,"onUpdate:modelValue":l[9]||(l[9]=e=>C.ruleForm.workingHours=e),style:{width:"100%"},placeholder:"请选择",clearable:""},{"default":n((()=>[(i(!0),u(c,null,y(C.DICTS.work_type,((e,l)=>(i(),b(p,{key:l,value:l,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"就职岗位",prop:"post"},{"default":n((()=>[t(a,{modelValue:C.ruleForm.post,"onUpdate:modelValue":l[10]||(l[10]=e=>C.ruleForm.post=e),style:{width:"100%"},placeholder:"请填写",maxlength:"20"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"入职日期",prop:"enjoinDate"},{"default":n((()=>[t(_,{modelValue:C.ruleForm.enjoinDate,"onUpdate:modelValue":l[11]||(l[11]=e=>C.ruleForm.enjoinDate=e),style:{width:"100%"},placeholder:"请选择","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1})])),_:1},8,["span"]),t(o,{span:C.span},{"default":n((()=>[t(r,{label:"试用期",prop:"tryPeriod"},{"default":n((()=>[t(f,{modelValue:C.ruleForm.tryPeriod,"onUpdate:modelValue":l[12]||(l[12]=e=>C.ruleForm.tryPeriod=e),style:{width:"100%"},placeholder:"请选择",clearable:""},{"default":n((()=>[(i(!0),u(c,null,y(C.tryMonth,((e,l)=>(i(),b(p,{key:l,value:e,label:e},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["span"])])),_:1})])),_:1},8,["model","rules"])]),s("div",H,[t(h,{onClick:B,style:{height:"100%"}},{"default":n((()=>[$])),_:1}),t(h,{type:"primary",loading:C.loading,onClick:A,style:{height:"100%"}},{"default":n((()=>[M])),_:1},8,["loading"])])])}}}),[["__scopeId","data-v-e4a96616"]]);export{z as default};