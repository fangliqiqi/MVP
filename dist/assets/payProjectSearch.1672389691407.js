import{P as e}from"./ProTable.1672389691407.js";import{P as a}from"./index.16723896914072.js";import t from"./configPayProject.1672389691407.js";import r from"./paySearch.16723896914072.js";import{_ as s,h as n,E as o,g as l}from"./index.1672389691407.js";import{d as i,f as d}from"./paysearch.1672389691407.js";import{d as m,f as c,k as p,$ as h,a2 as u,j as y,c as f,W as Y,P as M,u as x,aD as g,aA as _,a3 as v,o as I,O as j}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./vuedraggable.umd.1672389691407.js";import"./index.16723896914075.js";import"./file.1672389691407.js";import"./excel.1672389691407.js";import"./header.1672389691407.js";const T={"class":"system-dict-container"},k=m({name:"项目薪酬查询"});var b=s(Object.assign(k,{setup(s){const m=c(null),k=c(null),b=g();_();const S=c(!1),W=c(null),P=c(null),O=p((()=>{let e=[];for(let a=(new Date).getFullYear();a>=2010;a--)e.push({text:a+"年",value:[a+"01",a+"12"]});return e})),C=()=>{E.params.salaryMonth=[n().format("YYYYMM"),n().format("YYYYMM")]},D=e=>{E.selectOptions=e},E=h({searchConfig:{labelWidth:110,option:{extBtn:"extBtns"}},columns:[{dataIndex:"status",title:"薪酬状态",minWidth:160},{dataIndex:"sendMonth",title:"发放月份",minWidth:160,valueType:"date",selectType:"month",format:"YYYYMM",valueFormat:"YYYYMM"},{dataIndex:"salaryMonth",title:"薪酬月份",hideInTable:!0,valueType:"custom",scopedSlots:{customRender:"salaryMonth"}},{dataIndex:"deptName",title:"项目名称",minWidth:160,tooltip:!0},{dataIndex:"deptNo",title:"项目编码",minWidth:140},{dataIndex:"applyNo",title:"申请编码",minWidth:160},{dataIndex:"settlementAmount",title:"项目金额",hideInSearch:!0,minWidth:140},{dataIndex:"invoiceTitle",title:"封面抬头",minWidth:200,tooltip:!0},{dataIndex:"salaryMonth",title:"薪酬月份",hideInSearch:!0,minWidth:160},{dataIndex:"formType",title:"表单类型",hideInSearch:!0,minWidth:160},{width:180,dataIndex:"createTime",title:"创建时间",selectType:"daterange",format:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss",searchIndex:"startEndTime_1",startTime:"createTimeStart",endTime:"createTimeEnd",valueType:"dateTimeRange"},{dataIndex:"createName",title:"创建人",hideInSearch:!0,minWidth:160},{dataIndex:"option",title:"操作",key:"option",minWidth:180,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"批量导出",permission:["salary_tsalarystandard-export"],onClick:()=>{S.value=!0;let e=null;if(E.selectOptions.length>0){const a=[];E.selectOptions.map((e=>{a.push(e.id)})),e={ids:a.join(",")}}else e={salaryMonthStart:E.params.salaryMonth[0],salaryMonthEnd:E.params.salaryMonth[1],...m.value.getParams()},delete e.size,delete e.current,delete e.startEndTime_1;i(e).then((e=>{200==e.code?o.success("导出成功"):o.error(e.msg||"导出失败")}))["catch"]((e=>{o.error(e.msg||"导出失败")}))["finally"]((()=>{S.value=!1}))},loading:S,icon:"icon-ic_edit_export"},{label:"工资条查询",permission:[],onClick:()=>{P.value&&P.value.openDialog()},type:"normal",icon:"icon-ic_edit_refresh"}],cellBtns:[{text:"详情",prop:"detail",permission:[]},{text:"工资条配置",prop:"config",permission:["tsalarystandardset_add","tsalarystandardset_del"],isGray:e=>"0"!=e.formType&&"1"!=e.formType}],selectOptions:[],params:{salaryMonth:[n().format("YYYYMM"),n().format("YYYYMM")]},dictKeys:["salary_status","form_type"]}),{columns:R,cellBtns:w,btn:B,searchConfig:H}=u(E),N=async e=>{try{const a={...e,salaryMonthStart:E.params.salaryMonth[0],salaryMonthEnd:E.params.salaryMonth[1]},t=await d(a);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records.map(((a,t)=>({...a,index:(e.current-1)*e.size+t+1})))}}catch(a){}return{current:1,total:0,data:[]}},F=()=>{m.value.refresh()},V=async(e,a)=>{"detail"===e?b.push({name:"payservice-project-detail",params:{id:a.id}}):"config"===e&&k.value&&k.value.openDialog(a)};return y((()=>{(async()=>{try{const e=await l(E.dictKeys);e&&E.columns.map((a=>{switch(a.dataIndex){case"status":a.valueEnum=e.salary_status;break;case"formType":a.valueEnum=e.form_type}return a}))}catch(e){}})()})),(s,n)=>{const o=v("el-date-picker");return I(),f("div",T,[Y(e,{ref_key:"proTableRef",ref:m,"row-key":"id",columns:x(R),request:N,btn:x(B),searchConfig:x(H),multi:!0,onSelectionChange:D,onOnReset:C},{salaryMonth:M((e=>[(I(),j(o,{modelValue:E.params.salaryMonth,"onUpdate:modelValue":n[0]||(n[0]=e=>E.params.salaryMonth=e),ref_key:"dataPickerRef",ref:W,type:"monthrange",key:"arch_search_props_"+e.dateIndex+"_oIndex","start-placeholder":"开始月份","end-placeholder":"结束月份","value-format":"YYYYMM",format:"YYYYMM",style:{width:"100%"},"unlink-panels":!0,"popper-class":"month-picker",clearable:!1,shortcuts:x(O)},null,8,["modelValue","shortcuts"]))])),option:M((e=>[Y(a,{array:x(w),model:e,onOnClick:V},null,8,["array","model"])])),_:1},8,["columns","btn","searchConfig"]),Y(t,{ref_key:"configPayProjectRef",ref:k,onOk:F},null,512),Y(r,{ref_key:"paySearchRef",ref:P},null,512)])}}}),[["__scopeId","data-v-204309e4"]]);export{b as default};