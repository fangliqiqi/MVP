import{a as e,b as l}from"./contractPermission.16723896914072.js";import{P as a}from"./index.16723896914073.js";import{_ as r}from"./index.167238969140713.js";import{_ as o,l as s,E as n}from"./index.1672389691407.js";import{d as t,f as i,$ as u,c as d,W as m,P as c,a3 as f,o as p,a as g,u as y,ay as _,az as v,U as F}from"./vue.1672389691407.js";import"./city.1672389691407.js";const h={"class":"system-add-dic-container"},w={"class":"tips"},k=(e=>(_("data-v-a9c427de"),e=e(),v(),e))((()=>g("span",null," 档案所在地至少选择到市级 ",-1))),C={"class":"dialog-footer"},N=F("取 消"),P=F("确 定"),b=t({name:"addContractPermission"});var V=o(Object.assign(b,{emits:["ok"],setup(o,{expose:t,emit:_}){const v=i(null),F=i(null),b=i(null),V=u({isShowDialog:!1,id:null,loading:!1,title:"合同审核权限新增",address:null,options:[],ruleForm:{userId:null,userName:null,fileProvince:null,fileCity:null,fileTown:null,organName:null}}),I={userId:[{required:!0,message:"请选择员工",trigger:"change"}],organName:[{required:!0,message:"请选择所在部门",trigger:"blur"}],fileProvince:[{required:!0,message:"请选择档案所在地,至少到市",trigger:"change"}]},j=async l=>{try{l.fileStatus=0;const a=await e(l);if(a&&200==a.code&&a.data)return{current:a.data.current,total:a.data.total,data:a.data.records};n.error(a.msg)}catch(a){}return{current:1,total:0,data:[]}},x=e=>{V.ruleForm.organName=e.deptName,V.ruleForm.userName=e.nickname,V.options=[e]},S=e=>{e.city?(V.ruleForm.fileProvince=e.pro,V.ruleForm.fileCity=e.city,V.ruleForm.fileTown=e.town,V.address=e.town||e.city||e.pro):V.address=null},D=e=>{V.ruleForm.fileProvince=null,V.ruleForm.fileCity=null,V.ruleForm.fileTown=null,V.address=null},q=()=>{v.value&&v.value.resetFields(),V.ruleForm={userId:null,userName:null,fileProvince:null,fileCity:null,fileTown:null,deptName:null},V.isShowDialog=!1,V.address=null,V.loading=!1},z=()=>{q()},T=()=>{v.value&&v.value.validate((e=>{e&&(V.loading=!0,V.ruleForm.status=0,l(V.ruleForm).then((e=>{e&&200==e.code?(n.success("新增合同审核权限成功"),_("ok"),q()):n.error(e.msg||"新增合同审核权限失败")}),(()=>{n.error("新增合同审核权限失败")}))["finally"]((()=>{V.loading=!1})))}))};return t({openDialog:async e=>{V.isShowDialog=!0,V.loading=!1}}),(e,l)=>{const o=f("el-form-item"),n=f("el-col"),t=f("el-input"),i=f("el-icon"),u=f("el-row"),_=f("el-form"),U=f("el-button"),R=f("el-dialog");return p(),d("div",h,[m(R,{title:V.title,modelValue:V.isShowDialog,"onUpdate:modelValue":l[2]||(l[2]=e=>V.isShowDialog=e),"close-on-click-modal":!1,width:"576px",onClose:q},{footer:c((()=>[g("span",C,[m(U,{onClick:z,size:"default"},{"default":c((()=>[N])),_:1}),m(U,{type:"primary",onClick:T,loading:V.loading,size:"default"},{"default":c((()=>[P])),_:1},8,["loading"])])])),"default":c((()=>[m(_,{ref_key:"formRef",ref:v,model:V.ruleForm,rules:I,size:"default","label-width":"110px"},{"default":c((()=>[m(u,null,{"default":c((()=>[m(n,{span:24},{"default":c((()=>[m(o,{label:"员工姓名",prop:"userId"},{"default":c((()=>[m(a,{ref_key:"pageSelectRef",ref:F,modelValue:V.ruleForm.userId,"onUpdate:modelValue":l[0]||(l[0]=e=>V.ruleForm.userId=e),request:j,"value-key":"userId",title:"nickname",search:"nickname",placeholder:"请选择员工",options:V.options,onChange:x},null,8,["modelValue","options"])])),_:1})])),_:1}),m(n,{span:24},{"default":c((()=>[m(o,{label:"所在部门",prop:"organName"},{"default":c((()=>[m(t,{modelValue:V.ruleForm.organName,"onUpdate:modelValue":l[1]||(l[1]=e=>V.ruleForm.organName=e),placeholder:"所在部门",disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),m(n,{span:24},{"default":c((()=>[m(o,{label:"档案所在地",prop:"fileProvince"},{"default":c((()=>[m(r,{ref_key:"pageAreaRef",ref:b,address:V.address,onCurrentChange:S,onClear:D,style:{width:"100%"}},null,8,["address"]),g("div",w,[m(i,null,{"default":c((()=>[m(y(s))])),_:1}),k])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-a9c427de"]]);export{V as default};