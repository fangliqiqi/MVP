import{a as e}from"./contractPermission.16723896914072.js";import{s as a,E as t}from"./index.1672389691407.js";import{g as r}from"./fee.1672389691407.js";import{P as o}from"./index.16723896914073.js";import{d as l,f as s,$ as n,c as i,W as d,P as u,a3 as m,o as c,a as p,U as f}from"./vue.1672389691407.js";async function g(e){return a({url:"/yifu-archives/method/tcutsomerdatapermisson/page",method:"GET",params:e})}async function h(e){return a({url:"/yifu-archives/method/tcutsomerdatapermisson",method:"PUT",data:e})}async function y(e){return a({url:"/yifu-archives/method/tcutsomerdatapermisson/"+e,method:"DELETE"})}async function k(e){return a({url:"/yifu-archives/method/tcutsomerdatapermisson/getList",method:"POST",data:e})}const N={"class":"system-add-dic-container"},_={"class":"dialog-footer"},v=f("取 消"),F=f("确 定"),b=l({name:"addProjectPermission"}),O=Object.assign(b,{emits:["ok"],setup(l,{expose:f,emit:g}){const h=s(null),y=n({isShowDialog:!1,id:null,loading:!1,title:"项目权限新增",ruleForm:{type:1},userOptions:[],proOptions:[]}),k={nickname:[{required:!0,message:"请输入员工姓名",trigger:"change"}],deptName:[{required:!0,message:"所在部门不能为空",trigger:"change"}],id:[{required:!0,message:"请输入项目名称",trigger:"change"}]},b=async a=>{try{const r=await e(a);if(r&&200==r.code&&r.data)return{current:r.data.current,total:r.data.total,data:r.data.records};t.error(r.msg)}catch(r){}return{current:1,total:0,data:[]}},O=e=>{y.ruleForm.deptName=e.deptName,y.ruleForm.userId=e.userId,y.ruleForm.userLoginName=e.username,y.userOptions=[e]},V=e=>{y.ruleForm.settleDomainName=e.departName,y.ruleForm.settleDomainNo=e.departNo,y.proOptions=[e]},j=async e=>{try{const a=await r(Object.assign({},e,{flag:1}));if(a&&200==a.code&&a.data)return{current:a.data.current,total:a.data.total,data:a.data.records};t.error(a.msg)}catch(a){}return{current:1,total:0,data:[]}},D=()=>{h.value&&h.value.resetFields(),y.ruleForm={},y.isShowDialog=!1,y.id=null,y.loading=!1},S=()=>{D()},w=()=>{h.value&&h.value.validate((e=>{if(e){y.loading=!0;let{deptName:e,id:r,nickname:o,...l}=y.ruleForm,s={userNickName:o,userDeptName:e,settleDomainId:r};(async function(e){return a({url:"/yifu-archives/method/tcutsomerdatapermisson",method:"POST",data:e})})(Object.assign({},s,l)).then((e=>{e&&200==e.code?(t.success("新增项目权限成功"),g("ok"),D()):t.error(e.msg||"新增项目权限失败")}),(()=>{t.error("新增项目权限失败")}))["finally"]((()=>{y.loading=!1}))}}))};return f({openDialog:async e=>{y.isShowDialog=!0,y.loading=!1}}),(e,a)=>{const t=m("el-form-item"),r=m("el-col"),l=m("el-input"),s=m("el-row"),n=m("el-form"),f=m("el-button"),g=m("el-dialog");return c(),i("div",N,[d(g,{title:y.title,modelValue:y.isShowDialog,"onUpdate:modelValue":a[3]||(a[3]=e=>y.isShowDialog=e),"close-on-click-modal":!1,width:"576px",onClose:D},{footer:u((()=>[p("span",_,[d(f,{onClick:S,size:"default"},{"default":u((()=>[v])),_:1}),d(f,{type:"primary",onClick:w,loading:y.loading,size:"default"},{"default":u((()=>[F])),_:1},8,["loading"])])])),"default":u((()=>[d(n,{ref_key:"formRef",ref:h,model:y.ruleForm,rules:k,size:"default","label-width":"110px"},{"default":u((()=>[d(s,null,{"default":u((()=>[d(r,{span:24},{"default":u((()=>[d(t,{label:"员工姓名",prop:"nickname"},{"default":u((()=>[d(o,{ref:"pageSelectRef",modelValue:y.ruleForm.nickname,"onUpdate:modelValue":a[0]||(a[0]=e=>y.ruleForm.nickname=e),request:b,"value-key":"nickname",title:"nickname",search:"nickname",placeholder:"请选择员工",options:y.userOptions,onChange:O},null,8,["modelValue","options"])])),_:1})])),_:1}),d(r,{span:24},{"default":u((()=>[d(t,{label:"所在部门",prop:"deptName"},{"default":u((()=>[d(l,{modelValue:y.ruleForm.deptName,"onUpdate:modelValue":a[1]||(a[1]=e=>y.ruleForm.deptName=e),placeholder:"所在部门",disabled:""},null,8,["modelValue"])])),_:1})])),_:1}),d(r,{span:24},{"default":u((()=>[d(t,{label:"项目名称",prop:"id"},{"default":u((()=>[d(o,{ref:"pageSelectRef",modelValue:y.ruleForm.id,"onUpdate:modelValue":a[2]||(a[2]=e=>y.ruleForm.id=e),request:j,"value-key":"id",title:"departName",search:"departName",placeholder:"请选择项目",options:y.proOptions,onChange:V},null,8,["modelValue","options"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}}});var V=Object.freeze(Object.defineProperty({__proto__:null,"default":O},Symbol.toStringTag,{value:"Module"}));export{O as _,k as a,y as b,V as c,h as d,g};