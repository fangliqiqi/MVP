import{P as e}from"./ProTable.1672389691407.js";import{P as t}from"./index.16723896914072.js";import{c as a,a as n,g as i,d as r}from"./currentSalaryReportDilog.1672389691407.js";import{E as o}from"./index.16723896914076.js";import{f as s,$ as l,j as d,E as c,a2 as h,c as p,W as m,P as u,aD as y,aA as x,a3 as I,o as f,i as M}from"./vue.1672389691407.js";import{o as S,a as g}from"./events.1672389691407.js";import{ae as E}from"./header.1672389691407.js";import{_ as b,f as W,h as _,E as v,a as P}from"./index.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./vuedraggable.umd.1672389691407.js";const R={"class":"archives-online-container"};var j=b({name:"本期薪资申报",components:{ProTable:e,ProButtons:t,ArrowDown:W,currentSalaryReportDilog:a,ExportExcelDialog:o},setup(){const e=y(),t=x(),a=s(null),o=s(null),p=s(!1),{proxy:m}=M(),u=()=>{a.value&&a.value.onSearch()},I=l({searchConfig:{labelWidth:110,option:{extBtn:"extBtns"}},fn:null,columns:[{dataIndex:"invoiceTitle",title:"申报单位",hideInSearch:!1,minWidth:160,fixed:"left",tooltip:!0},{dataIndex:"declareMonth",title:"申报月份",valueType:"date",minWidth:160,hideInSearch:!1,selectType:"month",format:"YYYYMM",valueFormat:"YYYYMM",clearable:!1,isShowDefaultDate:{defaultValue:_(new Date).format("YYYYMM"),type:"declareMonth"}},{dataIndex:"empName",title:"姓名",minWidth:140,tooltip:!0,hideInSearch:!0},{dataIndex:"empIdcard",title:"身份证号码",minWidth:200,hideInSearch:!0},{dataIndex:"realSalary",title:"本期收入",minWidth:160,hideInSearch:!0},{dataIndex:"salaryTax",title:"本期应纳税额",minWidth:160,hideInSearch:!0},{dataIndex:"personalPensionMoney",title:"本期基本养老保险",minWidth:160,hideInSearch:!0},{dataIndex:"personalMedicalMoney",title:"本期基本医疗保险",minWidth:160,hideInSearch:!0},{dataIndex:"personalUnemploymentMoney",title:"本期失业保险",minWidth:160,hideInSearch:!0},{dataIndex:"personalProvidentFee",title:"本期住房公积金",minWidth:160,hideInSearch:!0},{dataIndex:"enterpriseAnnuity",title:"本期企业年金",minWidth:160,hideInSearch:!0},{dataIndex:"costReduction",title:"累计减除费用",minWidth:160,hideInSearch:!0},{dataIndex:"taxable",title:"累计应纳税所得额",minWidth:160,hideInSearch:!0},{dataIndex:"childEduinfoMoney",title:"累计子女教育",minWidth:160,hideInSearch:!0},{dataIndex:"continuingEducationExpenseMoney",title:"累计继续教育",minWidth:160,hideInSearch:!0},{dataIndex:"housingLoanInterestExpenseMoney",title:"累计住房贷款",minWidth:160,hideInSearch:!0},{dataIndex:"housingRentalinfoMoney",title:"累计住房租金",minWidth:160,hideInSearch:!0},{dataIndex:"supportElderlyExpenseMoney",title:"累计赡养老人",minWidth:160,hideInSearch:!0},{dataIndex:"sumBabyMoney",title:"累计3岁以下婴幼儿照护",minWidth:200,hideInSearch:!0},{dataIndex:"sumPrivatePension",title:"累计个人养老金",minWidth:200,hideInSearch:!0},{dataIndex:"isNewEmployee",title:"是否当月新增人员",minWidth:160,hideInSearch:!0,valueEnum:{0:"否",1:"是"}},{dataIndex:"createMonth",title:"入职年月",minWidth:160,hideInSearch:!0},{dataIndex:"empPhone",title:"手机号码",minWidth:160,hideInSearch:!0},{dataIndex:"option",title:"操作",key:"option",width:100,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"导出",onClick:()=>{I.params=a.value.getParams(),delete I.params.size,delete I.params.current,p.value=!0;const e=Object.assign({},I.params),t=Object.assign({},I.exportColums),i=[];for(const a in t){const e=t[a];i.push(e)}n({...e,exportFields:i}).then((e=>{v.success("导出成功")}))["catch"]()["finally"]((()=>{p.value=!1}))},type:"default",permission:["salary_tstatisticscurrentreport-export"],icon:"icon-ic_edit_export",loading:p},{label:"手动刷新",type:"default",onClick:()=>{o.value&&o.value.openDialog()},permission:["salary_tstatisticstaxsalary_refresh"]}],cellBtns:[{text:"删除",prop:"delete",permission:["salary_tstatisticscurrentreport_del"],tooltip:"当前状态不可删除"}],DICTS:{},dictKeys:["emp_natrue","emp_married","emp_national","emp_political","emp_registype","education","EMP_SOURCE","social_ecurity_state","commercial_satte","personnel_state","fund_status"],params:{},areaProps:{label:"areaName",isLeaf:"isLeaf",children:"children"},exportColums:["invoiceTitle","declareMonth","empName","empIdcard","realSalary","salaryTax","personalPensionMoney","personalMedicalMoney","personalUnemploymentMoney","personalProvidentFee","enterpriseAnnuity","costReduction","taxable","childEduinfoMoney","continuingEducationExpenseMoney","housingLoanInterestExpenseMoney","housingRentalinfoMoney","supportElderlyExpenseMoney","sumBabyMoney","sumPrivatePension","isNewEmployee","createMonth","empPhone"]}),f=e=>{P.confirm('<p style="font-size:16px;font-weight:600">是否确定删除?<br/>\n\t\t\t\t<span style="color:red;font-size:14px;font-weight:400">删除后，薪资申报信息将从系统消失，请谨慎操作！</span></p>',{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((async()=>{try{const t=await r(e.id);t&&200===t.code?(v.success("删除成功"),u()):v.error(t.msg||"删除失败")}catch(t){v.error(t&&t.msg||"删除失败")}}))["catch"]((()=>{}))};return d((()=>{g(m,t.path,(()=>{u()}))})),c((()=>{S(m)})),{...h(I),request:async e=>{try{let t={};if(e.declareMonth)t=e;else{const{declareMonth:a,...n}=e;t={...n,declareMonth:_(new Date).format("YYYYMM")}}const a=Object.assign({},t),n=await i(a);if(n&&200==n.code&&n.data)return{current:n.data.current,total:n.data.total,data:n.data.records}}catch(t){}return{current:1,total:0,data:[]}},onCellClick:async(t,a)=>{switch(t){case"detail":e.push({name:"decution-detail",params:{id:a.id}});break;case"delete":f(a)}},proTableRef:a,currentSalaryReportDilogRef:o,refreshList:u,APPLY_DELETE_IMPORT_HEADER:E,onReset:()=>{I.params={}},isShowExportLoading:p}}},[["render",function(e,t,a,n,i,r){const o=I("pro-buttons"),s=I("pro-table"),l=I("current-salary-report-Dilog");return f(),p("div",R,[m(s,{ref:"proTableRef","row-key":"id",columns:e.columns,request:n.request,btn:e.btn,multi:!1,searchConfig:e.searchConfig,onOnReset:n.onReset},{option:u((t=>[m(o,{array:e.cellBtns,model:t,onOnClick:n.onCellClick},null,8,["array","model","onOnClick"])])),_:1},8,["columns","request","btn","searchConfig","onOnReset"]),m(l,{ref:"currentSalaryReportDilogRef",onOk:n.refreshList},null,8,["onOk"])])}],["__scopeId","data-v-b133d598"]]);export{j as default};