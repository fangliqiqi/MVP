import{s as e,g as t,f as a,d as o}from"./specialdeduction.1672389691407.js";import{P as l}from"./ProTable.1672389691407.js";import{P as i}from"./index.16723896914072.js";import{B as n}from"./index.16723896914077.js";import r from"./batchDelete.16723896914072.js";import s from"./attachDetail.16723896914072.js";import{E as c}from"./index.16723896914076.js";import{i as d,f as p,$ as u,j as m,E as h,a2 as y,c as f,W as b,P as x,aA as k,a3 as g,o as _,a as D,U as v,ay as I,az as C}from"./vue.1672389691407.js";import{o as w,a as j}from"./events.1672389691407.js";import{_ as M,f as R,h as E,E as T,a as S}from"./index.1672389691407.js";import{al as P}from"./header.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./xlsx.1672389691407.js";import"./excel.1672389691407.js";import"./vuedraggable.umd.1672389691407.js";const O={name:"专享扣除数据",components:{ProTable:l,ProButtons:i,ArrowDown:R,BatchImportDialog:n,batchDelete:r,ExportExcelDialog:c,attachDetailVue:s},setup(){var l;const i=k(),n=null==(l=d())?void 0:l.appContext.config.globalProperties.$message,r=p(null),s=p(null),c=p(null),f=p(null),{proxy:b}=d(),x=()=>{r.value&&r.value.onSearch()},g=u({searchConfig:{labelWidth:110,option:{extBtn:"extBtns"}},columns:[{dataIndex:"name",title:"姓名",minWidth:140,tooltip:!0,fixed:"left"},{dataIndex:"jobNumber",title:"工号",hideInSearch:!0,minWidth:160},{dataIndex:"createMonth",title:"导入月份",valueType:"date",minWidth:160,selectType:"month",format:"YYYYMM",valueFormat:"YYYYMM"},{dataIndex:"idNumber",title:"身份证号",minWidth:200},{dataIndex:"preTaxDeduction",title:"税前扣除项目合计",minWidth:160,hideInSearch:!0},{dataIndex:"declareTitle",title:"申报单位",minWidth:160,tooltip:!0},{dataIndex:"costReduction",title:"减除费用",hideInSearch:!0,minWidth:160,tooltip:!0},{dataIndex:"option",title:"操作",key:"option",width:160,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"专项扣除导入",onClick:()=>{s.value&&s.value.openDialog()},type:"default",permission:["employee_batch_import"],icon:"icon-ic_edit_upload"},{label:"批量删除",type:"default",onClick:()=>{f.value&&f.value.openDialog()},permission:["employee_batch_import"],icon:"icon-ic_edit_delete"}],cellBtns:[{text:"详情",prop:"detail"},{text:"删除",prop:"delete",permission:["wxhr:tspecialdeducationsum_del"],tooltip:"当前状态不可删除",isGray:e=>{if(e.createMonth)return e.createMonth!=E().format("YYYYMM")}}],DICTS:{},detailConf:[{label:"创建时间",key:"createTime",tooltip:!0},{label:"所得期间起",key:"createStart",tooltip:!0},{label:"所得期间止",key:"createEnd",tooltip:!0},{label:"减除费用",key:"costReduction",tooltip:!0},{label:"导入月份",key:"createMonth",tooltip:!0},{label:"本期收入",key:"currentIncome",tooltip:!0},{label:"本期免税收入",key:"currentIncomeTaxFree",tooltip:!0},{label:"其他金额",key:"otherMoney",tooltip:!0},{label:"准予扣除的捐赠额",key:"donationAmount",tooltip:!0},{label:"企业（职业）年金",key:"enterpriseAnnuity",tooltip:!0},{label:"住房公积金",key:"fund",tooltip:!0},{label:"证照号码",key:"idNumber",tooltip:!0},{label:"基本医疗保险费",key:"insuranceMedical",tooltip:!0},{label:"基本养老保险费",key:"insurancePension",tooltip:!0},{label:"失业保险费",key:"insuranceUnemployment",tooltip:!0},{label:"累计子女教育",key:"sumChildEduMoney",tooltip:!0},{label:"累计继续教育",key:"sumContinuingEducationMoney",tooltip:!0},{label:"累计住房贷款利息",key:"sumHousingLoanMoney",tooltip:!0},{label:"累计住房租金",key:"sumHousingRentMoney",tooltip:!0},{label:"累计赡养老人",key:"sumSupportElderlyMoney",tooltip:!0},{label:"累计3岁以下婴幼儿照护",key:"sumBabyMoney",tooltip:!0},{label:"累计个人养老金",key:"sumPrivatePension",tooltip:!0},{label:"商业健康保险",key:"takingRisks",tooltip:!0},{label:"税延养老保险",key:"taxDeferredInsurance",tooltip:!0},{label:"减免税额",key:"taxSavings",tooltip:!0},{label:"已扣缴税额",key:"taxesWithheld",tooltip:!0},{label:"税前扣除项目合计",key:"preTaxDeduction",tooltip:!0},{label:"申报单位",key:"declareTitle",tooltip:!0}],dictKeys:["emp_natrue","emp_married","emp_national","emp_political","emp_registype","education","EMP_SOURCE","social_ecurity_state","commercial_satte","personnel_state","fund_status"],params:{},areaProps:{label:"areaName",isLeaf:"isLeaf",children:"children"}});return m((()=>{j(b,i.path,(()=>{x()}))})),h((()=>{w(b)})),{...y(g),request:async e=>{try{const a=Object.assign({},e),o=await t(a);if(o&&200==o.code&&o.data)return{current:o.data.current,total:o.data.total,data:o.data.records}}catch(a){}return{current:1,total:0,data:[]}},onCellClick:async(e,t)=>{switch(e){case"detail":a(t.id).then((e=>{200==e.code?c.value&&c.value.openDialog(e.data,"详情","",g.detailConf):T.error("未查询到当前详情数据")}))["catch"]((e=>{}))["finally"]((e=>{}));break;case"delete":(e=>{S.confirm('<p style="font-size:16px;font-weight:600">是否确定删除?<br/>\n\t\t\t\t<span style="color:red;font-size:14px;font-weight:400">删除后，配置将从系统消失，请谨慎操作！</span></p>',{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0}).then((async()=>{try{const t=await o(e.id);t&&200===t.code?(n.success("专项扣除删除成功"),x()):n.error(t.msg||"专项扣除删除失败")}catch(t){n.error(t&&t.msg||"专项扣除删除失败")}}))["catch"]((()=>{}))})(t)}},proTableRef:r,batchImportDialogRef:s,batchDeleteRef:f,refreshList:x,SPECIAL_DEDUCTION_HEADER:P,onReset:()=>{g.params={}},attachDetailRef:c,importSpecialDeduction:(t,a)=>e(a)}}},Y=e=>(I("data-v-cccc8690"),e=e(),C(),e),B={"class":"archives-online-container"},W={"class":"el-dropdown-link"},L=v(" 模板下载 "),A=Y((()=>D("a",{href:"/template/专项扣税模板.xlsx",download:""}," 专项扣除导入模板",-1))),N=Y((()=>D("div",null,[
D("div",{style:{color:"red","font-size":"24px","text-align":"center",margin:"10px 0 25px"}},"批量导入失败！"),
D("span",null,[
v("存在不符合要求的数据，请修改后，重新导入！"),
D("br"),
v("已为您下载反馈结果！")])],-1)));var U=M(O,[["render",function(e,t,a,o,l,i){const n=g("arrow-down"),r=g("el-icon"),s=g("el-button"),c=g("el-dropdown-item"),d=g("el-dropdown-menu"),p=g("el-dropdown"),u=g("pro-buttons"),m=g("pro-table"),h=g("batch-import-dialog"),y=g("batch-delete"),k=g("attach-detail-vue");return _(),f("div",B,[b(m,{ref:"proTableRef","row-key":"id",columns:e.columns,request:o.request,btn:e.btn,multi:!1,searchConfig:e.searchConfig,onOnReset:o.onReset},{extBtns:x((()=>[b(p,{"class":"arch-btn","popper-class":"module-download"},{dropdown:x((()=>[b(d,null,{"default":x((()=>[b(c,null,{"default":x((()=>[A])),_:1})])),_:1})])),"default":x((()=>[D("span",W,[b(s,{size:"default"},{"default":x((()=>[L,b(r,{"class":"el-icon--right"},{"default":x((()=>[b(n)])),_:1})])),_:1})])])),_:1})])),option:x((t=>[b(u,{array:e.cellBtns,model:t,onOnClick:o.onCellClick},null,8,["array","model","onOnClick"])])),_:1},8,["columns","request","btn","searchConfig","onOnReset"]),b(h,{ref:"batchImportDialogRef",type:1,header:o.SPECIAL_DEDUCTION_HEADER,upload:o.importSpecialDeduction,onOk:o.refreshList,download:""},{error:x((()=>[N])),_:1},8,["header","upload","onOk"]),b(y,{ref:"batchDeleteRef",onOk:o.refreshList},null,8,["onOk"]),b(k,{ref:"attachDetailRef"},null,512)])}],["__scopeId","data-v-cccc8690"]]);export{U as default};