import{u as e,d as t}from"./file.1672389691407.js";import{E as a}from"./index.1672389691407.js";import{k as s,O as i,P as r,u as l,G as o,a3 as u,o as d,W as n,U as m}from"./vue.1672389691407.js";const p=m("点击上传"),f={__name:"attachUpload",props:{fileList:{type:Array,"default":()=>[]},limit:{type:Number,"default":15},size:{type:Number,"default":5},type:{type:Number,required:!0},filePath:{type:String,"default":""},domain:{type:String,"default":""}},emits:["changefile","removefile"],setup(m,{emit:f}){const c=m,h=()=>!1,y=s((()=>c.fileList||[])),g=t=>{if(t.raw.size>1048576*c.size)return void a.error("文件大小不能超过5M！");const s=new FormData;s.append("file",t.raw),s.append("type",c.type),s.append("filePath",c.filePath),s.append("domain",c.domain),e(s).then((e=>{200==e.code?(y.value.push({name:e.data.name,url:e.data.url,uid:e.data.uid,status:"success"}),f("changefile",y),a.success("附件上传成功")):a.error(e.msg||"附件上传失败")}))["catch"]((e=>{a.error(e.msg||"附件上传失败")}))},v=e=>{"success"==e.status&&t(e.uid).then((e=>{200==e.code?(a.success("附件删除成功"),f("removefile",y)):a.error(e.msg||"附件删除失败")}))["catch"]((e=>{a.error("附件删除失败")}))},b=()=>{a.error(`文件数量最多上传${c.limit}个`)};return(e,t)=>{const a=u("el-button"),s=u("el-upload");return d(),i(s,{"class":"uploadList",style:{"max-width":"100%"},"file-list":l(y),"onUpdate:file-list":t[0]||(t[0]=e=>o(y)?y.value=e:null),"on-remove":v,"on-exceed":b,"before-upload":h,"on-change":g,limit:c.limit},{"default":r((()=>[n(a,null,{"default":r((()=>[p])),_:1})])),_:1},8,["file-list","limit"])}}};export{f as default};