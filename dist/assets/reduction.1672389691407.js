import{P as e}from"./ProTable.1672389691407.js";import{P as a}from"./index.16723896914072.js";import t from"./insureDetailDialog.1672389691407.js";import n from"./ProjectSelect.1672389691407.js";import r from"./InsureCompanySelect.1672389691407.js";import{e as i}from"./excel.1672389691407.js";import{aa as s}from"./header.1672389691407.js";import{_ as o,U as d,h as l,E as c}from"./index.1672389691407.js";import{m,n as p}from"./custserve.1672389691407.js";import{buyType as u}from"./dict.1672389691407.js";import{a as h}from"./index.167238969140714.js";import{f as y,$ as f,a2 as I,c as x,W as T,P as b,a3 as g,o as D,U as S,V as j,T as C}from"./vue.1672389691407.js";import"./index.16723896914073.js";import"./index.16723896914074.js";import"./city.1672389691407.js";import"./company.1672389691407.js";const N={"class":"custserve-container"},v={key:0,style:{color:"red"}};var Y=o({name:"已退保",components:{ProTable:e,ProButtons:a,insureDetailDialog:t,ProjectSelect:n,CompanySelect:r},setup(){const e=y(null),a=y(null),t=(e,a)=>e&&a?`${e}/${a}`:e?`${e}`:a?`${a}`:"",n=()=>{const a=Object.assign({},r.params,e.value.getParams());delete a.size,delete a.current,r.btn.find((e=>"导出减员名册"===e.label)).loading=!0,m(a).then((e=>{i(s,(e.data||[]).map((e=>(e.buyType=u[e.buyType],e.insuranceAddress=t(e.insuranceProvinceName,e.insuranceCityName),e.insuranceHandleAddress=t(e.insuranceHandleProvinceName,e.insuranceHandleCityName),e))),`商险已减员人员名册_${l().format("YYYYMMDDHHmmss")}`),c.success("导出成功")}))["finally"]((()=>{r.btn.find((e=>"导出减员名册"===e.label)).loading=!1}))},r=f({params:{deptNo:null,insuranceCompanyName:null},searchConfig:{labelWidth:"102px",option:{extBtn:"extBtns"}},columns:[{dataIndex:"buyType",title:"投保类型",width:120,valueEnum:{1:"新增",3:"批增",4:"替换"}},{dataIndex:"projectName",title:"项目",hideInSearch:!0,minWidth:120,ellipsis:!0},{dataIndex:"deptNo",title:"项目",minWidth:200,valueType:"PageSelect",hideInTable:!0,request:async e=>{try{const a=Object.assign({},{deleteFlag:0},e),t=await h(a);if(t&&200==t.code&&t.data)return{current:t.data.current,total:t.data.total,data:t.data.records};c.error(t.msg)}catch(a){}return{current:1,total:0,data:[]}},pageProps:{valueKey:"departNo",title:"departName",search:"departName",parmas:{}},tooltip:!0},{dataIndex:"empName",title:"姓名",width:100},{dataIndex:"empIdcardNo",title:"身份证号",width:170},{dataIndex:"insuranceCompanyName",title:"保险公司",minWidth:120,ellipsis:!0,hideInSearch:!0},{dataIndex:"insuranceCompanyName",title:"保险公司",hideInTable:!0,valueType:"custom",scopedSlots:{customRender:"CompanySelect"}},{dataIndex:"insuranceTypeName",title:"险种",minWidth:120,hideInSearch:!0,ellipsis:!0},{dataIndex:"policyDate",title:"保单起止时间",minWidth:220,hideInSearch:!0,scopedSlots:{customRender:"BeginEndTime"}},{dataIndex:"policyDate",title:"保单起止时间",hideInTable:!0,selectType:"daterange",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",searchIndex:"startEndTime",startTime:"policyStart",endTime:"policyEnd",valueType:"dateTimeRange"},{dataIndex:"buyStandard",title:"购买标准（元）",width:120,hideInSearch:!0},{dataIndex:"createName",title:"派单人",width:90,hideInSearch:!1,hideInTable:!1},{dataIndex:"refundCreateTime",title:"派单日期",width:120,hideInSearch:!0},{dataIndex:"createTime",title:"派单日期",hideInSearch:!1,hideInTable:!0,selectType:"daterange",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",searchIndex:"startEndTime_1",startTime:"startDate",endTime:"endDate",valueType:"dateTimeRange"},{dataIndex:"id",title:"id",hideInSearch:!0,width:120,ellipsis:!0,hideInSearch:!0},{dataIndex:"option",title:"操作",key:"option",width:70,hideInSearch:!0,fixed:"right",scopedSlots:{customRender:"option"}}],btn:[{label:"导出减员名册",onClick:n,permission:["insurance_custserve_reduction_export"],icon:"icon-ic_edit_export"}],cellBtns:[{text:"查看",prop:"detail",permission:["insurance_custserve_reduction_detail"]}]});return{...I(r),request:async e=>{const a=Object.assign({},r.params,e);try{const e=await p({size:a.size,current:a.current,mId:a.mId},a);if(e&&200==e.code&&e.data)return{current:e.data.current,total:e.data.total,data:e.data.records||[]}}catch(t){}return{current:1,total:0,data:[]}},onReset:()=>{r.params={deptNo:null,insuranceCompanyName:null}},onCellClick:async(e,t)=>{if("detail"===e)a.value&&a.value.openDialog(t)},proTableRef:e,insureDetailRef:a,handleReduceExport:n,formatRangeDateAndDiff:d}}},[["render",function(e,a,t,n,r,i){const s=g("pro-buttons"),o=g("project-select"),d=g("company-select"),l=g("pro-table"),c=g("insure-detail-dialog");return D(),x("div",N,[T(l,{ref:"proTableRef","row-key":"id",columns:e.columns,request:n.request,btn:e.btn,searchConfig:e.searchConfig,onOnReset:n.onReset},{option:b((a=>[T(s,{array:e.cellBtns,model:a,onOnClick:n.onCellClick},null,8,["array","model","onOnClick"])])),ProjectSelect:b((()=>[T(o,{modelValue:e.params.deptNo,"onUpdate:modelValue":a[0]||(a[0]=a=>e.params.deptNo=a),style:{width:"100%"}},null,8,["modelValue"])])),CompanySelect:b((()=>[T(d,{modelValue:e.params.insuranceCompanyName,"onUpdate:modelValue":a[1]||(a[1]=a=>e.params.insuranceCompanyName=a),style:{width:"100%"}},null,8,["modelValue"])])),BeginEndTime:b((e=>[S(j(n.formatRangeDateAndDiff(e.policyStart,e.policyEnd))+" ",1),e.buyMonth?(D(),x("span",v,j(`${e.buyMonth}个月`),1)):C("",!0)])),_:1},8,["columns","request","btn","searchConfig","onOnReset"]),T(c,{ref:"insureDetailRef"},null,512)])}],["__scopeId","data-v-0c4f8eb1"]]);export{Y as default};